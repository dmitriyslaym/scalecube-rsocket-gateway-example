{"code":"!function(e){function t(n){if(r[n])return r[n].exports;var s=r[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var s in e)t.d(n,s,function(t){return e[t]}.bind(null,s));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=21)}([function(e){\"use strict\";e.exports=function(e,t){for(var r=arguments.length,n=Array(2<r?r-2:0),s=2;s<r;s++)n[s-2]=arguments[s];if(function(e){if(void 0===e)throw new Error(\"invariant(...): Second argument must be a string.\")}(t),!e){var i;if(void 0===t)i=new Error(\"Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.\");else{var o=0;(i=new Error(t.replace(/%s/g,function(){return n[o++]+\"\"}))).name=\"Invariant Violation\"}throw i.framesToPop=1,i}}},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}function s(e){const t=l[e];return null==t?o(e):t}function i(e){const t=d[e];return null==t?768>=e?\"RESERVED (PROTOCOL)\":\"RESERVED (APPLICATION)\":t}function o(e){return\"0x\"+e.toString(16)}Object.defineProperty(t,\"__esModule\",{value:!0}),t.MAX_VERSION=t.MAX_TTL=t.MAX_STREAM_ID=t.MAX_RESUME_LENGTH=t.MAX_REQUEST_N=t.MAX_REQUEST_COUNT=t.MAX_MIME_LENGTH=t.MAX_METADATA_LENGTH=t.MAX_LIFETIME=t.MAX_KEEPALIVE=t.MAX_CODE=t.FRAME_TYPE_OFFFSET=t.FLAGS_MASK=t.ERROR_EXPLANATIONS=t.ERROR_CODES=t.FLAGS=t.FRAME_TYPE_NAMES=t.FRAME_TYPES=t.CONNECTION_STREAM_ID=void 0,t.isIgnore=function(e){return(e&f.IGNORE)===f.IGNORE},t.isMetadata=function(e){return(e&f.METADATA)===f.METADATA},t.isComplete=function(e){return(e&f.COMPLETE)===f.COMPLETE},t.isNext=function(e){return(e&f.NEXT)===f.NEXT},t.isRespond=function(e){return(e&f.RESPOND)===f.RESPOND},t.isResumeEnable=function(e){return(e&f.RESUME_ENABLE)===f.RESUME_ENABLE},t.isLease=function(e){return(e&f.LEASE)===f.LEASE},t.isResumePositionFrameType=function(e){return e===c.CANCEL||e===c.ERROR||e===c.PAYLOAD||e===c.REQUEST_CHANNEL||e===c.REQUEST_FNF||e===c.REQUEST_RESPONSE||e===c.REQUEST_STREAM||e===c.REQUEST_N},t.getFrameTypeName=s,t.createErrorFromFrame=function(e){const{code:t,message:r}=e,n=i(t),s=new Error((0,u.default)(\"RSocket error %s (%s): %s. See error `source` property for details.\",o(t),n,r));return s.source={code:t,explanation:n,message:r},s},t.getErrorCodeExplanation=i,t.printFrame=function(e){const t=Object.assign({},e);t.type=s(e.type)+` (${o(e.type)})`;const r=[];return(0,a.default)(f,(t,n)=>{(e.flags&t)===t&&r.push(n)}),r.length||r.push(\"NO FLAGS\"),t.flags=r.join(\" | \")+` (${o(e.flags)})`,e.type===c.ERROR&&(t.code=i(e.code)+` (${o(e.code)})`),JSON.stringify(t,null,2)};var a=n(r(22)),u=n(r(23));t.CONNECTION_STREAM_ID=0;const c=t.FRAME_TYPES={CANCEL:9,ERROR:11,EXT:63,KEEPALIVE:3,LEASE:2,METADATA_PUSH:12,PAYLOAD:10,REQUEST_CHANNEL:7,REQUEST_FNF:5,REQUEST_N:8,REQUEST_RESPONSE:4,REQUEST_STREAM:6,RESERVED:0,RESUME:13,RESUME_OK:14,SETUP:1},l=t.FRAME_TYPE_NAMES={};(0,a.default)(c,(e,t)=>{l[e]=t});const f=t.FLAGS={COMPLETE:64,FOLLOWS:128,IGNORE:512,LEASE:64,METADATA:256,NEXT:32,RESPOND:128,RESUME_ENABLE:128},h=t.ERROR_CODES={APPLICATION_ERROR:513,CANCELED:515,CONNECTION_CLOSE:258,CONNECTION_ERROR:257,INVALID:516,INVALID_SETUP:1,REJECTED:514,REJECTED_RESUME:4,REJECTED_SETUP:3,RESERVED:0,RESERVED_EXTENSION:4294967295,UNSUPPORTED_SETUP:2},d=t.ERROR_EXPLANATIONS={};(0,a.default)(h,(e,t)=>{d[e]=t});t.FLAGS_MASK=1023,t.FRAME_TYPE_OFFFSET=10,t.MAX_CODE=2147483647,t.MAX_KEEPALIVE=2147483647,t.MAX_LIFETIME=2147483647,t.MAX_METADATA_LENGTH=16777215,t.MAX_MIME_LENGTH=255,t.MAX_REQUEST_COUNT=2147483647,t.MAX_REQUEST_N=2147483647,t.MAX_RESUME_LENGTH=65535,t.MAX_STREAM_ID=2147483647,t.MAX_TTL=2147483647,t.MAX_VERSION=65535},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.every=t.Single=t.FlowableProcessor=t.Flowable=void 0;var s=n(r(14)),i=n(r(30)),o=n(r(31)),a=r(32);t.Flowable=s.default,t.FlowableProcessor=o.default,t.Single=i.default,t.every=a.every},function(e,t,r){\"use strict\";function n(){}function s(e){if(\"object\"!=typeof this)throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!=typeof e)throw new TypeError(\"Promise constructor's argument is not a function\");this._40=0,this._65=0,this._55=null,this._72=null,e===n||l(e,this)}function i(e,t){for(;3===e._65;)e=e._55;return s._37&&s._37(e),0===e._65?0===e._40?(e._40=1,void(e._72=t)):1===e._40?(e._40=2,void(e._72=[e._72,t])):void e._72.push(t):void function(e,t){f(function(){var r=1===e._65?t.onFulfilled:t.onRejected;if(null!==r){var n=function(e,t){try{return e(t)}catch(e){return h=e,d}}(r,e._55);n===d?a(t.promise,h):o(t.promise,n)}else 1===e._65?o(t.promise,e._55):a(t.promise,e._55)})}(e,t)}function o(e,t){if(t===e)return a(e,new TypeError(\"A promise cannot be resolved with itself.\"));if(t&&(\"object\"==typeof t||\"function\"==typeof t)){var r=function(e){try{return e.then}catch(e){return h=e,d}}(t);if(r===d)return a(e,h);if(r===e.then&&t instanceof s)return e._65=3,e._55=t,void u(e);if(\"function\"==typeof r)return void l(r.bind(t),e)}e._65=1,e._55=t,u(e)}function a(e,t){e._65=2,e._55=t,s._87&&s._87(e,t),u(e)}function u(e){if(1===e._40&&(i(e,e._72),e._72=null),2===e._40){for(var t=0;t<e._72.length;t++)i(e,e._72[t]);e._72=null}}function c(e,t,r){this.onFulfilled=\"function\"==typeof e?e:null,this.onRejected=\"function\"==typeof t?t:null,this.promise=r}function l(e,t){var r=!1,n=function(e,t,r){try{e(t,r)}catch(e){return h=e,d}}(e,function(e){r||(r=!0,o(t,e))},function(e){r||(r=!0,a(t,e))});r||n!==d||(r=!0,a(t,h))}var f=r(18),h=null,d={};e.exports=s,s._37=null,s._87=null,s._61=n,s.prototype.then=function(e,t){if(this.constructor!==s)return function(e,t,r){return new e.constructor(function(o,a){var u=new s(n);u.then(o,a),i(e,new c(t,r,u))})}(this,e,t);var r=new s(n);return i(this,new c(e,t,r)),r}},function(e){var t=function(){return this}();try{t=t||new Function(\"return this\")()}catch(e){\"object\"==typeof window&&(t=window)}e.exports=t},function(e,t,r){\"use strict\";function n(e){if(!e)return\"Lease was not received yet\";if(e.valid())return\"Missing leases\";const t=e.expired(),r=e.allowedRequests;return`Missing leases. Expired: ${t.toString()}, allowedRequests: ${r}`}var s=Math.max;Object.defineProperty(t,\"__esModule\",{value:!0}),t.ResponderLeaseHandler=t.RequesterLeaseHandler=t.Leases=t.Lease=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),o=r(2),a=r(1);class u{constructor(e,t,r){(0,i.default)(0<e,\"Lease time-to-live must be positive\"),(0,i.default)(0<t,\"Lease allowed requests must be positive\"),this.timeToLiveMillis=e,this.allowedRequests=t,this.startingAllowedRequests=t,this.expiry=Date.now()+e,this.metadata=r}expired(){return Date.now()>this.expiry}valid(){return 0<this.allowedRequests&&!this.expired()}_use(){if(this.expired())return!1;const e=this.allowedRequests,t=0<e;return t&&(this.allowedRequests=e-1),t}}t.Lease=u,t.Leases=class{constructor(){this._sender=(()=>o.Flowable.never()),this._receiver=(()=>{})}sender(e){return this._sender=e,this}receiver(e){return this._receiver=e,this}stats(e){return this._stats=e,this}},t.RequesterLeaseHandler=class{constructor(e){this._requestN=-1,e(new o.Flowable(e=>this._subscriber?void e.onError(new Error(\"only 1 subscriber is allowed\")):this.isDisposed()?void e.onComplete():(this._subscriber=e,void e.onSubscribe({cancel:()=>{this.dispose()},request:t=>{if(0>=t&&e.onError(new Error(`request demand must be positive: ${t}`)),!this.isDisposed()){const e=this._requestN;this._onRequestN(e),this._requestN=Math.min(Number.MAX_SAFE_INTEGER,s(0,e)+t)}}}))))}use(){const e=this._lease;return!!e&&e._use()}errorMessage(){return n(this._lease)}receive(e){if(!this.isDisposed()){const t=e.ttl,r=e.requestCount,n=e.metadata;this._onLease(new u(t,r,n))}}availability(){const e=this._lease;return e&&e.valid()?e.allowedRequests/e.startingAllowedRequests:0}dispose(){if(!this._isDisposed){this._isDisposed=!0;const e=this._subscriber;e&&e.onComplete()}}isDisposed(){return this._isDisposed}_onRequestN(e){const t=this._lease,r=this._subscriber;0>e&&t&&r&&r.onNext(t)}_onLease(e){const t=this._subscriber,r=this._requestN-1;0<=r&&t&&t.onNext(e),this._requestN=s(-1,r),this._lease=e}},t.ResponderLeaseHandler=class{constructor(e,t,r){this._leaseSender=e,this._stats=t,this._errorConsumer=r}use(){const e=this._lease,t=!!e&&e._use();return this._onStatsEvent(t),t}errorMessage(){return n(this._lease)}send(e){let t,r;return this._leaseSender(this._stats).subscribe({onComplete:()=>this._onStatsEvent(),onError:e=>{this._onStatsEvent();const t=this._errorConsumer;t&&t(e)},onNext:t=>{this._lease=t,e(t)},onSubscribe:e=>r?void e.cancel():(e.request(a.MAX_REQUEST_N),void(t=e))}),{dispose(){r||(r=!0,this._onStatsEvent(),t&&t.cancel())},isDisposed:()=>r}}_onStatsEvent(e){const t=this._stats;if(t){const r=void 0===e?\"Terminate\":e?\"Accept\":\"Reject\";t.onEvent(r)}}}},function(e,t,r){\"use strict\";var n=r(7);e.exports=n},function(e){\"use strict\";function t(e){return function(){return e}}var r=function(){};r.thatReturns=t,r.thatReturnsFalse=t(!1),r.thatReturnsTrue=t(!0),r.thatReturnsNull=t(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(e){return e},e.exports=r},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.createBuffer=void 0,t.readUInt24BE=function(e,t){return e.readUInt8(t)<<16|e.readUInt8(t+1)<<8|e.readUInt8(t+2)},t.writeUInt24BE=function(e,t,r){return r=e.writeUInt8(t>>>16,r),r=e.writeUInt8(255&t>>>8,r),e.writeUInt8(255&t,r)},t.readUInt64BE=function(e,t){const r=e.readUInt32BE(t),n=e.readUInt32BE(t+4);return r*i+n},t.writeUInt64BE=function(e,t,r){return r=e.writeUInt32BE(0|t/i,r),e.writeUInt32BE(t%i,r)},t.byteLength=function(e,t){return null==e?0:n.LiteBuffer.byteLength(e,t)},t.toBuffer=function(e){return e instanceof n.LiteBuffer?e:((0,s.default)(e instanceof ArrayBuffer,\"RSocketBufferUtils: Cannot construct buffer. Expected data to be an arraybuffer, got `%s`.\",e),n.LiteBuffer.from(e))};var n=r(13),s=function(e){return e&&e.__esModule?e:{default:e}}(r(0));const i=4294967296;t.createBuffer=\"function\"==typeof n.LiteBuffer.alloc?e=>n.LiteBuffer.alloc(e):e=>new n.LiteBuffer(e).fill(0)},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.IdentitySerializers=t.IdentitySerializer=t.JsonSerializers=t.JsonSerializer=void 0;var n=r(13),s=function(e){return e&&e.__esModule?e:{default:e}}(r(0));const i=t.JsonSerializer={deserialize:e=>{let t;if(null==e)return null;if(\"string\"==typeof e)t=e;else if(n.LiteBuffer.isBuffer(e))t=e.toString(\"utf8\");else{t=n.LiteBuffer.from(e).toString(\"utf8\")}return JSON.parse(t)},serialize:JSON.stringify},o=(t.JsonSerializers={data:i,metadata:i},t.IdentitySerializer={deserialize:e=>((0,s.default)(null==e||\"string\"==typeof e||n.LiteBuffer.isBuffer(e)||e instanceof Uint8Array,\"RSocketSerialization: Expected data to be a string, Buffer, or Uint8Array. Got `%s`.\",e),e),serialize:e=>e});t.IdentitySerializers={data:o,metadata:o}},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.Lease=t.Leases=t.JsonSerializers=t.JsonSerializer=t.IdentitySerializers=t.IdentitySerializer=t.UTF8Encoder=t.Utf8Encoders=t.BufferEncoder=t.BufferEncoders=t.writeUInt24BE=t.toBuffer=t.readUInt24BE=t.createBuffer=t.byteLength=t.serializeFrameWithLength=t.serializeFrame=t.deserializeFrames=t.deserializeFrameWithLength=t.deserializeFrame=t.printFrame=t.isResumeEnable=t.isRespond=t.isNext=t.isMetadata=t.isLease=t.isIgnore=t.isComplete=t.getErrorCodeExplanation=t.createErrorFromFrame=t.MAX_VERSION=t.MAX_STREAM_ID=t.MAX_RESUME_LENGTH=t.MAX_MIME_LENGTH=t.MAX_LIFETIME=t.MAX_KEEPALIVE=t.MAX_CODE=t.FRAME_TYPES=t.FRAME_TYPE_OFFFSET=t.FLAGS=t.FLAGS_MASK=t.ERROR_EXPLANATIONS=t.ERROR_CODES=t.CONNECTION_STREAM_ID=t.RSocketResumableTransport=t.RSocketServer=t.RSocketClient=void 0;var s=r(1);Object.defineProperty(t,\"CONNECTION_STREAM_ID\",{enumerable:!0,get:function(){return s.CONNECTION_STREAM_ID}}),Object.defineProperty(t,\"ERROR_CODES\",{enumerable:!0,get:function(){return s.ERROR_CODES}}),Object.defineProperty(t,\"ERROR_EXPLANATIONS\",{enumerable:!0,get:function(){return s.ERROR_EXPLANATIONS}}),Object.defineProperty(t,\"FLAGS_MASK\",{enumerable:!0,get:function(){return s.FLAGS_MASK}}),Object.defineProperty(t,\"FLAGS\",{enumerable:!0,get:function(){return s.FLAGS}}),Object.defineProperty(t,\"FRAME_TYPE_OFFFSET\",{enumerable:!0,get:function(){return s.FRAME_TYPE_OFFFSET}}),Object.defineProperty(t,\"FRAME_TYPES\",{enumerable:!0,get:function(){return s.FRAME_TYPES}}),Object.defineProperty(t,\"MAX_CODE\",{enumerable:!0,get:function(){return s.MAX_CODE}}),Object.defineProperty(t,\"MAX_KEEPALIVE\",{enumerable:!0,get:function(){return s.MAX_KEEPALIVE}}),Object.defineProperty(t,\"MAX_LIFETIME\",{enumerable:!0,get:function(){return s.MAX_LIFETIME}}),Object.defineProperty(t,\"MAX_MIME_LENGTH\",{enumerable:!0,get:function(){return s.MAX_MIME_LENGTH}}),Object.defineProperty(t,\"MAX_RESUME_LENGTH\",{enumerable:!0,get:function(){return s.MAX_RESUME_LENGTH}}),Object.defineProperty(t,\"MAX_STREAM_ID\",{enumerable:!0,get:function(){return s.MAX_STREAM_ID}}),Object.defineProperty(t,\"MAX_VERSION\",{enumerable:!0,get:function(){return s.MAX_VERSION}}),Object.defineProperty(t,\"createErrorFromFrame\",{enumerable:!0,get:function(){return s.createErrorFromFrame}}),Object.defineProperty(t,\"getErrorCodeExplanation\",{enumerable:!0,get:function(){return s.getErrorCodeExplanation}}),Object.defineProperty(t,\"isComplete\",{enumerable:!0,get:function(){return s.isComplete}}),Object.defineProperty(t,\"isIgnore\",{enumerable:!0,get:function(){return s.isIgnore}}),Object.defineProperty(t,\"isLease\",{enumerable:!0,get:function(){return s.isLease}}),Object.defineProperty(t,\"isMetadata\",{enumerable:!0,get:function(){return s.isMetadata}}),Object.defineProperty(t,\"isNext\",{enumerable:!0,get:function(){return s.isNext}}),Object.defineProperty(t,\"isRespond\",{enumerable:!0,get:function(){return s.isRespond}}),Object.defineProperty(t,\"isResumeEnable\",{enumerable:!0,get:function(){return s.isResumeEnable}}),Object.defineProperty(t,\"printFrame\",{enumerable:!0,get:function(){return s.printFrame}});var i=r(11);Object.defineProperty(t,\"deserializeFrame\",{enumerable:!0,get:function(){return i.deserializeFrame}}),Object.defineProperty(t,\"deserializeFrameWithLength\",{enumerable:!0,get:function(){return i.deserializeFrameWithLength}}),Object.defineProperty(t,\"deserializeFrames\",{enumerable:!0,get:function(){return i.deserializeFrames}}),Object.defineProperty(t,\"serializeFrame\",{enumerable:!0,get:function(){return i.serializeFrame}}),Object.defineProperty(t,\"serializeFrameWithLength\",{enumerable:!0,get:function(){return i.serializeFrameWithLength}});var o=r(8);Object.defineProperty(t,\"byteLength\",{enumerable:!0,get:function(){return o.byteLength}}),Object.defineProperty(t,\"createBuffer\",{enumerable:!0,get:function(){return o.createBuffer}}),Object.defineProperty(t,\"readUInt24BE\",{enumerable:!0,get:function(){return o.readUInt24BE}}),Object.defineProperty(t,\"toBuffer\",{enumerable:!0,get:function(){return o.toBuffer}}),Object.defineProperty(t,\"writeUInt24BE\",{enumerable:!0,get:function(){return o.writeUInt24BE}});var a=r(12);Object.defineProperty(t,\"BufferEncoders\",{enumerable:!0,get:function(){return a.BufferEncoders}}),Object.defineProperty(t,\"BufferEncoder\",{enumerable:!0,get:function(){return a.BufferEncoder}}),Object.defineProperty(t,\"Utf8Encoders\",{enumerable:!0,get:function(){return a.Utf8Encoders}}),Object.defineProperty(t,\"UTF8Encoder\",{enumerable:!0,get:function(){return a.UTF8Encoder}});var u=r(9);Object.defineProperty(t,\"IdentitySerializer\",{enumerable:!0,get:function(){return u.IdentitySerializer}}),Object.defineProperty(t,\"IdentitySerializers\",{enumerable:!0,get:function(){return u.IdentitySerializers}}),Object.defineProperty(t,\"JsonSerializer\",{enumerable:!0,get:function(){return u.JsonSerializer}}),Object.defineProperty(t,\"JsonSerializers\",{enumerable:!0,get:function(){return u.JsonSerializers}});var c=r(5);Object.defineProperty(t,\"Leases\",{enumerable:!0,get:function(){return c.Leases}}),Object.defineProperty(t,\"Lease\",{enumerable:!0,get:function(){return c.Lease}});var l=n(r(33)),f=n(r(35)),h=n(r(36));t.RSocketClient=l.default,t.RSocketServer=f.default,t.RSocketResumableTransport=h.default},function(e,t,r){\"use strict\";function n(e,t){t=t||f.Utf8Encoders;let r=0;const n=e.readInt32BE(r);r+=4,(0,c.default)(0<=n,\"RSocketBinaryFraming: Invalid frame, expected a positive stream id, got `%s.\",n);const s=e.readUInt16BE(r);r+=2;const i=s>>>l.FRAME_TYPE_OFFFSET,o=s&l.FLAGS_MASK;switch(i){case l.FRAME_TYPES.SETUP:return function(e,t,r,n){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid SETUP frame, expected stream id to be 0.\");const s=e.length;let i=d;const o=e.readUInt16BE(i);i+=2;const a=e.readUInt16BE(i);i+=2;const f=e.readInt32BE(i);i+=4,(0,c.default)(0<=f&&f<=l.MAX_KEEPALIVE,\"RSocketBinaryFraming: Invalid SETUP frame, expected keepAlive to be >= 0 and <= %s. Got `%s`.\",l.MAX_KEEPALIVE,f);const h=e.readInt32BE(i);i+=4,(0,c.default)(0<=h&&h<=l.MAX_LIFETIME,\"RSocketBinaryFraming: Invalid SETUP frame, expected lifetime to be >= 0 and <= %s. Got `%s`.\",l.MAX_LIFETIME,h);let E=null;if(r&l.FLAGS.RESUME_ENABLE){const t=e.readInt16BE(i);i+=2,(0,c.default)(0<=t&&t<=l.MAX_RESUME_LENGTH,\"RSocketBinaryFraming: Invalid SETUP frame, expected resumeToken length to be >= 0 and <= %s. Got `%s`.\",l.MAX_RESUME_LENGTH,t),E=n.resumeToken.decode(e,i,i+t),i+=t}const _=e.readUInt8(i);i+=1;const p=n.metadataMimeType.decode(e,i,i+_);i+=_;const m=e.readUInt8(i);i+=1;const b=n.dataMimeType.decode(e,i,i+m);i+=m;const S={data:null,dataMimeType:b,flags:r,keepAlive:f,length:s,lifetime:h,majorVersion:o,metadata:null,metadataMimeType:p,minorVersion:a,resumeToken:E,streamId:t,type:l.FRAME_TYPES.SETUP};return u(e,S,n,i),S}(e,n,o,t);case l.FRAME_TYPES.PAYLOAD:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid PAYLOAD frame, expected stream id to be > 0.\");const s=e.length,i={data:null,flags:r,length:s,metadata:null,streamId:t,type:l.FRAME_TYPES.PAYLOAD};return u(e,i,n,d),i}(e,n,o,t);case l.FRAME_TYPES.ERROR:return function(e,t,r,n){const s=e.length;let i=d;const o=e.readInt32BE(i);i+=4,(0,c.default)(0<=o&&o<=l.MAX_CODE,\"RSocketBinaryFraming: Invalid ERROR frame, expected code to be >= 0 and <= %s. Got `%s`.\",l.MAX_CODE,o);const a=e.length-i;let u=\"\";return 0<a&&(u=n.message.decode(e,i,i+a),i+=a),{code:o,flags:r,length:s,message:u,streamId:t,type:l.FRAME_TYPES.ERROR}}(e,n,o,t);case l.FRAME_TYPES.KEEPALIVE:return function(e,t,r,n){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid KEEPALIVE frame, expected stream id to be 0.\");const s=e.length;let i=d;const o=(0,h.readUInt64BE)(e,i);let a=null;return(i+=8)<e.length&&(a=n.data.decode(e,i,e.length)),{data:a,flags:r,lastReceivedPosition:o,length:s,streamId:t,type:l.FRAME_TYPES.KEEPALIVE}}(e,n,o,t);case l.FRAME_TYPES.REQUEST_FNF:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_FNF frame, expected stream id to be > 0.\");const s=e.length,i={data:null,flags:r,length:s,metadata:null,streamId:t,type:l.FRAME_TYPES.REQUEST_FNF};return u(e,i,n,d),i}(e,n,o,t);case l.FRAME_TYPES.REQUEST_RESPONSE:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_RESPONSE frame, expected stream id to be > 0.\");const s=e.length,i={data:null,flags:r,length:s,metadata:null,streamId:t,type:l.FRAME_TYPES.REQUEST_RESPONSE};return u(e,i,n,d),i}(e,n,o,t);case l.FRAME_TYPES.REQUEST_STREAM:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_STREAM frame, expected stream id to be > 0.\");const s=e.length;let i=d;const o=e.readInt32BE(i);i+=4,(0,c.default)(0<o,\"RSocketBinaryFraming: Invalid REQUEST_STREAM frame, expected requestN to be > 0, got `%s`.\",o);const a={data:null,flags:r,length:s,metadata:null,requestN:o,streamId:t,type:l.FRAME_TYPES.REQUEST_STREAM};return u(e,a,n,i),a}(e,n,o,t);case l.FRAME_TYPES.REQUEST_CHANNEL:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_CHANNEL frame, expected stream id to be > 0.\");const s=e.length;let i=d;const o=e.readInt32BE(i);i+=4,(0,c.default)(0<o,\"RSocketBinaryFraming: Invalid REQUEST_STREAM frame, expected requestN to be > 0, got `%s`.\",o);const a={data:null,flags:r,length:s,metadata:null,requestN:o,streamId:t,type:l.FRAME_TYPES.REQUEST_CHANNEL};return u(e,a,n,i),a}(e,n,o,t);case l.FRAME_TYPES.REQUEST_N:return function(e,t,r){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_N frame, expected stream id to be > 0.\");const n=e.length,s=e.readInt32BE(d);return(0,c.default)(0<s,\"RSocketBinaryFraming: Invalid REQUEST_STREAM frame, expected requestN to be > 0, got `%s`.\",s),{flags:r,length:n,requestN:s,streamId:t,type:l.FRAME_TYPES.REQUEST_N}}(e,n,o);case l.FRAME_TYPES.RESUME:return function(e,t,r,n){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid RESUME frame, expected stream id to be 0.\");const s=e.length;let i=d;const o=e.readUInt16BE(i);i+=2;const a=e.readUInt16BE(i);i+=2;const u=e.readInt16BE(i);i+=2,(0,c.default)(0<=u&&u<=l.MAX_RESUME_LENGTH,\"RSocketBinaryFraming: Invalid SETUP frame, expected resumeToken length to be >= 0 and <= %s. Got `%s`.\",l.MAX_RESUME_LENGTH,u);const f=n.resumeToken.decode(e,i,i+u);i+=u;const E=(0,h.readUInt64BE)(e,i);i+=8;const _=(0,h.readUInt64BE)(e,i);return i+=8,{clientPosition:_,flags:r,length:s,majorVersion:o,minorVersion:a,resumeToken:f,serverPosition:E,streamId:t,type:l.FRAME_TYPES.RESUME}}(e,n,o,t);case l.FRAME_TYPES.RESUME_OK:return function(e,t,r){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid RESUME frame, expected stream id to be 0.\");const n=e.length;return{clientPosition:(0,h.readUInt64BE)(e,d),flags:r,length:n,streamId:t,type:l.FRAME_TYPES.RESUME_OK}}(e,n,o);case l.FRAME_TYPES.CANCEL:return function(e,t,r){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid CANCEL frame, expected stream id to be > 0.\");const n=e.length;return{flags:r,length:n,streamId:t,type:l.FRAME_TYPES.CANCEL}}(e,n,o);case l.FRAME_TYPES.LEASE:return function(e,t,r,n){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid LEASE frame, expected stream id to be 0.\");const s=e.length;let i=d;const o=e.readUInt32BE(i);i+=4;const a=e.readUInt32BE(i);let u=null;return(i+=4)<e.length&&(u=n.metadata.decode(e,i,e.length)),{flags:r,length:s,metadata:u,requestCount:a,streamId:t,ttl:o,type:l.FRAME_TYPES.LEASE}}(e,n,o,t);default:(0,c.default)(!1,\"RSocketBinaryFraming: Unsupported frame type `%s`.\",(0,l.getFrameTypeName)(i))}}function s(e,t){switch(t=t||f.Utf8Encoders,e.type){case l.FRAME_TYPES.SETUP:return function(e,t){const r=null==e.resumeToken?0:t.resumeToken.byteLength(e.resumeToken),n=null==e.metadataMimeType?0:t.metadataMimeType.byteLength(e.metadataMimeType),s=null==e.dataMimeType?0:t.dataMimeType.byteLength(e.dataMimeType),u=o(e,t),c=(0,h.createBuffer)(d+_+(r?p+r:0)+n+s+u);let f=i(e,c);return f=c.writeUInt16BE(e.majorVersion,f),f=c.writeUInt16BE(e.minorVersion,f),f=c.writeUInt32BE(e.keepAlive,f),f=c.writeUInt32BE(e.lifetime,f),e.flags&l.FLAGS.RESUME_ENABLE&&(f=c.writeUInt16BE(r,f),null!=e.resumeToken&&(f=t.resumeToken.encode(e.resumeToken,c,f,f+r))),f=c.writeUInt8(n,f),null!=e.metadataMimeType&&(f=t.metadataMimeType.encode(e.metadataMimeType,c,f,f+n)),f=c.writeUInt8(s,f),null!=e.dataMimeType&&(f=t.dataMimeType.encode(e.dataMimeType,c,f,f+s)),a(e,c,t,f),c}(e,t);case l.FRAME_TYPES.PAYLOAD:return function(e,t){const r=o(e,t),n=(0,h.createBuffer)(d+r),s=i(e,n);return a(e,n,t,s),n}(e,t);case l.FRAME_TYPES.ERROR:return function(e,t){const r=null==e.message?0:t.message.byteLength(e.message),n=(0,h.createBuffer)(d+m+r);let s=i(e,n);return s=n.writeUInt32BE(e.code,s),null!=e.message&&t.message.encode(e.message,n,s,s+r),n}(e,t);case l.FRAME_TYPES.KEEPALIVE:return function(e,t){const r=null==e.data?0:t.data.byteLength(e.data),n=(0,h.createBuffer)(d+b+r);let s=i(e,n);return s=(0,h.writeUInt64BE)(n,e.lastReceivedPosition,s),null!=e.data&&t.data.encode(e.data,n,s,s+r),n}(e,t);case l.FRAME_TYPES.REQUEST_FNF:case l.FRAME_TYPES.REQUEST_RESPONSE:return function(e,t){const r=o(e,t),n=(0,h.createBuffer)(d+r),s=i(e,n);return a(e,n,t,s),n}(e,t);case l.FRAME_TYPES.REQUEST_STREAM:case l.FRAME_TYPES.REQUEST_CHANNEL:return function(e,t){const r=o(e,t),n=(0,h.createBuffer)(d+g+r);let s=i(e,n);return s=n.writeUInt32BE(e.requestN,s),a(e,n,t,s),n}(e,t);case l.FRAME_TYPES.REQUEST_N:return function(e){const t=(0,h.createBuffer)(d+y),r=i(e,t);return t.writeUInt32BE(e.requestN,r),t}(e);case l.FRAME_TYPES.RESUME:return function(e,t){const r=t.resumeToken.byteLength(e.resumeToken),n=(0,h.createBuffer)(d+R+r);let s=i(e,n);return s=n.writeUInt16BE(e.majorVersion,s),s=n.writeUInt16BE(e.minorVersion,s),s=n.writeUInt16BE(r,s),s=t.resumeToken.encode(e.resumeToken,n,s,s+r),s=(0,h.writeUInt64BE)(n,e.serverPosition,s),(0,h.writeUInt64BE)(n,e.clientPosition,s),n}(e,t);case l.FRAME_TYPES.RESUME_OK:return function(e){const t=(0,h.createBuffer)(d+v),r=i(e,t);return(0,h.writeUInt64BE)(t,e.clientPosition,r),t}(e);case l.FRAME_TYPES.CANCEL:return function(e){const t=(0,h.createBuffer)(d);return i(e,t),t}(e);case l.FRAME_TYPES.LEASE:return function(e,t){const r=null==e.metadata?0:t.metadata.byteLength(e.metadata),n=(0,h.createBuffer)(d+S+r);let s=i(e,n);return s=n.writeUInt32BE(e.ttl,s),s=n.writeUInt32BE(e.requestCount,s),null!=e.metadata&&t.metadata.encode(e.metadata,n,s,s+r),n}(e,t);default:(0,c.default)(!1,\"RSocketBinaryFraming: Unsupported frame type `%s`.\",(0,l.getFrameTypeName)(e.type))}}function i(e,t){const r=t.writeInt32BE(e.streamId,0);return t.writeUInt16BE(e.type<<l.FRAME_TYPE_OFFFSET|e.flags&l.FLAGS_MASK,r)}function o(e,t){let r=0;return null!=e.data&&(r+=t.data.byteLength(e.data)),(0,l.isMetadata)(e.flags)&&(r+=E,null!=e.metadata&&(r+=t.metadata.byteLength(e.metadata))),r}function a(e,t,r,n){if((0,l.isMetadata)(e.flags))if(null!=e.metadata){const s=r.metadata.byteLength(e.metadata);n=(0,h.writeUInt24BE)(t,s,n),n=r.metadata.encode(e.metadata,t,n,n+s)}else n=(0,h.writeUInt24BE)(t,0,n);null!=e.data&&r.data.encode(e.data,t,n,t.length)}function u(e,t,r,n){if((0,l.isMetadata)(t.flags)){const s=(0,h.readUInt24BE)(e,n);n+=E,0<s&&(t.metadata=r.metadata.decode(e,n,n+s),n+=s)}n<e.length&&(t.data=r.data.decode(e,n,e.length))}Object.defineProperty(t,\"__esModule\",{value:!0}),t.deserializeFrameWithLength=function(e,t){const r=(0,h.readUInt24BE)(e,0);return n(e.slice(E,E+r),t)},t.deserializeFrames=function(e,t){const r=[];let s=0;for(;s+E<e.length;){const i=(0,h.readUInt24BE)(e,s),o=s+E,a=o+i;if(a>e.length)break;const u=n(e.slice(o,a),t);r.push(u),s=a}return[r,e.slice(s,e.length)]},t.serializeFrameWithLength=function(e,t){const r=s(e,t),n=(0,h.createBuffer)(r.length+E);return(0,h.writeUInt24BE)(n,r.length,0),r.copy(n,E,0,r.length),n},t.deserializeFrame=n,t.serializeFrame=s,t.sizeOfFrame=function(e,t){switch(t=t||f.Utf8Encoders,e.type){case l.FRAME_TYPES.SETUP:return function(e,t){const r=null==e.resumeToken?0:t.resumeToken.byteLength(e.resumeToken),n=null==e.metadataMimeType?0:t.metadataMimeType.byteLength(e.metadataMimeType),s=null==e.dataMimeType?0:t.dataMimeType.byteLength(e.dataMimeType),i=o(e,t);return d+_+(r?p+r:0)+n+s+i}(e,t);case l.FRAME_TYPES.PAYLOAD:return function(e,t){const r=o(e,t);return d+r}(e,t);case l.FRAME_TYPES.ERROR:return function(e,t){const r=null==e.message?0:t.message.byteLength(e.message);return d+m+r}(e,t);case l.FRAME_TYPES.KEEPALIVE:return function(e,t){const r=null==e.data?0:t.data.byteLength(e.data);return d+b+r}(e,t);case l.FRAME_TYPES.REQUEST_FNF:case l.FRAME_TYPES.REQUEST_RESPONSE:return function(e,t){const r=o(e,t);return d+r}(e,t);case l.FRAME_TYPES.REQUEST_STREAM:case l.FRAME_TYPES.REQUEST_CHANNEL:return function(e,t){const r=o(e,t);return d+g+r}(e,t);case l.FRAME_TYPES.REQUEST_N:return d+y;case l.FRAME_TYPES.RESUME:return function(e,t){const r=t.resumeToken.byteLength(e.resumeToken);return d+R+r}(e,t);case l.FRAME_TYPES.RESUME_OK:return d+v;case l.FRAME_TYPES.CANCEL:return d;case l.FRAME_TYPES.LEASE:return function(e,t){const r=null==e.metadata?0:t.metadata.byteLength(e.metadata);return d+S+r}(e,t);default:(0,c.default)(!1,\"RSocketBinaryFraming: Unsupported frame type `%s`.\",(0,l.getFrameTypeName)(e.type))}};var c=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),l=r(1),f=r(12),h=r(8);const d=6,E=3,_=14,p=2,m=4,b=8,S=8,g=4,y=4,R=22,v=8},function(e,t,r){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0}),t.BufferEncoders=t.Utf8Encoders=t.BufferEncoder=t.UTF8Encoder=void 0;var n=r(8),s=function(e){return e&&e.__esModule?e:{default:e}}(r(0));const i=t.UTF8Encoder={byteLength:e=>(0,n.byteLength)(e,\"utf8\"),decode:(e,t,r)=>e.toString(\"utf8\",t,r),encode:(e,t,r,n)=>((0,s.default)(\"string\"==typeof e,\"RSocketEncoding: Expected value to be a string, got `%s`.\",e),t.write(e,r,n-r,\"utf8\"),n)},o=t.BufferEncoder={byteLength:t=>((0,s.default)(e.isBuffer(t),\"RSocketEncoding: Expected value to be a buffer, got `%s`.\",t),t.length),decode:(e,t,r)=>e.slice(t,r),encode:(t,r,n,i)=>((0,s.default)(e.isBuffer(t),\"RSocketEncoding: Expected value to be a buffer, got `%s`.\",t),t.copy(r,n,0,t.length),i)};t.Utf8Encoders={data:i,dataMimeType:i,message:i,metadata:i,metadataMimeType:i,resumeToken:i},t.BufferEncoders={data:o,dataMimeType:i,message:i,metadata:o,metadataMimeType:i,resumeToken:o}}).call(this,r(24).Buffer)},function(e,t,r){\"use strict\";var n=String.fromCharCode,s=Math.min;(function(e){function r(e){if(e>S)throw new RangeError('The value \"'+e+'\" is invalid for option \"size\"');const t=new Uint8Array(e);return t.__proto__=i.prototype,t}function i(e,t,r){if(\"number\"==typeof e){if(\"string\"==typeof t)throw new TypeError('The \"string\" argument must be of type string. Received type number');return c(e)}return o(e,t,r)}function o(e,t,r){if(ArrayBuffer.isView(e))return l(e);if(null==e)throw TypeError(\"The first argument must be one of type, Buffer, ArrayBuffer, Array, or Array-like Object. Received type \"+typeof e);if(b(e,ArrayBuffer)||e&&b(e.buffer,ArrayBuffer))return function(e,t,r){let n;return(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=i.prototype,n}(e,t,r);if(\"number\"==typeof e)throw new TypeError('The \"value\" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return i.from(n,t,r);const s=f(e);if(s)return s;throw new TypeError(\"The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type \"+typeof e)}function a(e){if(\"number\"!=typeof e)throw new TypeError('\"size\" argument must be of type number');if(0>e)throw new RangeError('The value \"'+e+'\" is invalid for option \"size\"')}function u(e){return a(e),r(e)}function c(e){return a(e),r(0>e?0:0|h(e))}function l(e){const t=0>e.length?0:0|h(e.length),n=r(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function f(e){if(i.isBuffer(e)){const t=0|h(e.length),n=r(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}return void 0===e.length?\"Buffer\"===e.type&&Array.isArray(e.data)?l(e.data):void 0:\"number\"!=typeof e.length||function(e){return e!=e}(e.length)?r(0):l(e)}function h(e){if(e>=S)throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+S.toString(16)+\" bytes\");return 0|e}function d(e){const t=e.length;if(t<=y)return n.apply(String,e);let r=\"\",s=0;for(;s<t;)r+=n.apply(String,e.slice(s,s+=y));return r}function E(e,t,r){if(0!=e%1||0>e)throw new RangeError(\"offset is not uint\");if(e+t>r)throw new RangeError(\"Trying to access beyond buffer length\")}function _(e,t,r,n,s,o){if(!i.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(t>s||t<o)throw new RangeError('\"value\" argument is out of bounds');if(r+n>e.length)throw new RangeError(\"Index out of range\")}function p(e,t=1/0){let r,n=t;const s=e.length;let i=null;const o=[];for(let t=0;t<s;++t){if(55295<(r=e.charCodeAt(t))&&57344>r){if(!i){if(56319<r){-1<(n-=3)&&o.push(239,191,189);continue}if(t+1===s){-1<(n-=3)&&o.push(239,191,189);continue}i=r;continue}if(56320>r){-1<(n-=3)&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(n-=3)&&o.push(239,191,189);if(i=null,128>r){if(0>(n-=1))break;o.push(r)}else if(2048>r){if(0>(n-=2))break;o.push(192|r>>6,128|63&r)}else if(65536>r){if(0>(n-=3))break;o.push(224|r>>12,128|63&r>>6,128|63&r)}else{if(!(1114112>r))throw new Error(\"Invalid code point\");if(0>(n-=4))break;o.push(240|r>>18,128|63&r>>12,128|63&r>>6,128|63&r)}}return o}function m(e,t,r){r=s(e.length,r);const n=[];for(let s=t;s<r;){const t=e[s];let i=null,o=239<t?4:223<t?3:191<t?2:1;if(s+o<=r){let r,n,a,u;1==o?128>t&&(i=t):2==o?128==(192&(r=e[s+1]))&&(127<(u=(31&t)<<6|63&r)&&(i=u)):3==o?(r=e[s+1],n=e[s+2],128==(192&r)&&128==(192&n)&&(2047<(u=(15&t)<<12|(63&r)<<6|63&n)&&(55296>u||57343<u)&&(i=u))):4==o&&(r=e[s+1],n=e[s+2],a=e[s+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(65535<(u=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a)&&1114112>u&&(i=u)))}null===i?(i=65533,o=1):65535<i&&(i-=65536,n.push(55296|1023&i>>>10),i=56320|1023&i),n.push(i),s+=o}return d(n)}function b(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}Object.defineProperty(t,\"__esModule\",{value:!0}),t.Buffer=i;const S=2147483647,g=void 0!==e&&e.hasOwnProperty(\"Buffer\");t.LiteBuffer=g?e.Buffer:i;i.from=function(e,t,r){return o(e,t,r)},i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,i.alloc=function(e,t,r){return u(e)},i.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==i.prototype},i.isEncoding=function(e){switch((e+\"\").toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},i.prototype._isBuffer=!0,i.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},i.prototype.write=function(e,t,r,n){switch(n){case\"utf8\":return function(e,t,r,n){return function(e,t,r,n){let s=0;for(;s<n&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}(p(t,e.length-r),e,r,n)}(this,e,t,r);default:throw new TypeError(\"Unknown encoding: \"+n)}};const y=4096;i.prototype.slice=function(e,t){const r=this.length;0>(e=~~e)?0>(e+=r)&&(e=0):e>r&&(e=r),0>(t=void 0===t?r:~~t)?0>(t+=r)&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return n.__proto__=i.prototype,n},i.prototype.readUInt8=function(e,t){return e>>>=0,t||E(e,1,this.length),this[e]},i.prototype.readUInt16BE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readInt8=function(e,t){return e>>>=0,t||E(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16BE=function(e,t){e>>>=0,t||E(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,1,255,0),this[t]=255&e,t+1},i.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},i.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},i.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},i.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||_(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},i.prototype.toString=function(){return 0===this.length?\"\":function(e,t,r){let n=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return\"\";if((void 0===r||r>this.length)&&(r=this.length),0>=r)return\"\";if((r>>>=0)<=(t>>>=0))return\"\";for(e||(e=\"utf8\");;)switch(e){case\"utf8\":case\"utf-8\":return m(this,t,r);default:if(n)throw new TypeError(\"Unsupported encoding: \"+e);e=(e+\"\").toLowerCase(),n=!0}}.apply(this,arguments)},i.byteLength=function(e,t){if(i.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||b(e,ArrayBuffer))return e.byteLength;if(\"string\"!=typeof e)throw new TypeError('The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;for(let r=!1;;)switch(t){case\"utf8\":case\"utf-8\":return p(e).length;default:if(r)return n?-1:p(e).length;t=(\"\"+t).toLowerCase(),r=!0}throw new Error(\"Unexpected path in function\")},i.prototype.copy=function(e,t,r,n){if(!i.isBuffer(e))throw new TypeError(\"argument should be a Buffer\");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),0<n&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError(\"targetStart out of bounds\");if(0>r||r>=this.length)throw new RangeError(\"Index out of range\");if(0>n)throw new RangeError(\"sourceEnd out of bounds\");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const s=n-r;if(this===e&&\"function\"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(let n=s-1;0<=n;--n)e[n+t]=this[n+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return s}}).call(this,r(4))},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var s=n(r(28)),i=n(r(29)),o=n(r(0)),a=n(r(6)),u=n(r(7));class c{static just(...e){return new c(t=>{let r=!1,n=0;t.onSubscribe({cancel:()=>{r=!0},request:s=>{for(;!r&&0<s&&n<e.length;)t.onNext(e[n++]),s--;r||n!=e.length||t.onComplete()}})})}static error(e){return new c(t=>{t.onSubscribe({cancel:()=>{},request:()=>{t.onError(e)}})})}static never(){return new c(e=>{e.onSubscribe({cancel:u.default,request:u.default})})}constructor(e,t=Number.MAX_SAFE_INTEGER){this._max=t,this._source=e}subscribe(e){let t=\"function\"==typeof e?this._wrapCallback(e):e;const r=new l(t,this._max);this._source(r)}lift(e){return new c(t=>this._source(e(t)))}map(e){return this.lift(t=>new s.default(t,e))}take(e){return this.lift(t=>new i.default(t,e))}_wrapCallback(e){const t=this._max;return{onNext:e,onSubscribe(e){e.request(t)}}}}t.default=c;class l{constructor(e,t){this._cancel=(()=>{this._active&&(this._active=!1,this._subscription&&this._subscription.cancel())}),this._request=(e=>{(0,o.default)(Number.isInteger(e)&&1<=e&&e<=this._max,\"Flowable: Expected request value to be an integer with a value greater than 0 and less than or equal to %s, got `%s`.\",this._max,e),this._active&&(e===this._max?this._pending=this._max:(this._pending+=e,this._pending>=this._max&&(this._pending=this._max)),this._subscription&&this._subscription.request(e))}),this._active=!1,this._max=t,this._pending=0,this._started=!1,this._subscriber=e||{},this._subscription=null}onComplete(){if(this._active){this._active=!1,this._started=!0;try{this._subscriber.onComplete&&this._subscriber.onComplete()}catch(e){this._subscriber.onError&&this._subscriber.onError(e)}}else(0,a.default)(!1,\"Flowable: Invalid call to onComplete(): %s.\",this._started?\"onComplete/onError was already called\":\"onSubscribe has not been called\")}onError(e){return this._started&&!this._active?void(0,a.default)(!1,\"Flowable: Invalid call to onError(): %s.\",this._active?\"onComplete/onError was already called\":\"onSubscribe has not been called\"):(this._active=!1,this._started=!0,void(this._subscriber.onError&&this._subscriber.onError(e)))}onNext(e){if(this._active)if(0!==this._pending){this._pending!==this._max&&this._pending--;try{this._subscriber.onNext&&this._subscriber.onNext(e)}catch(e){this._subscription&&this._subscription.cancel(),this.onError(e)}}else(0,a.default)(!1,\"Flowable: Invalid call to onNext(), all request()ed values have been published.\");else(0,a.default)(!1,\"Flowable: Invalid call to onNext(): %s.\",this._active?\"onComplete/onError was already called\":\"onSubscribe has not been called\")}onSubscribe(e){if(this._started)(0,a.default)(!1,\"Flowable: Invalid call to onSubscribe(): already called.\");else{this._active=!0,this._started=!0,this._subscription=e;try{this._subscriber.onSubscribe&&this._subscriber.onSubscribe({cancel:this._cancel,request:this._request})}catch(e){this.onError(e)}}}}},function(e){\"use strict\";e.exports=function(e){if(null!=e)return e;throw new Error(\"Got unexpected null or undefined\")}},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.createServerMachine=function(e,t,r,n,s){return new l(\"SERVER\",e,t,r,void 0,n,s)},t.createClientMachine=function(e,t,r,n,s,i){return new l(\"CLIENT\",e,t,r,n,s,i)};var s=r(2),i=n(r(7)),o=(n(r(0)),n(r(6))),a=r(1),u=r(9);r(5);class c{constructor(e){this._responder=e||{}}setResponder(e){this._responder=e||{}}fireAndForget(e){if(this._responder.fireAndForget)try{this._responder.fireAndForget(e)}catch(e){console.error(\"fireAndForget threw an exception\",e)}}requestResponse(e){let t;if(this._responder.requestResponse)try{return this._responder.requestResponse(e)}catch(e){console.error(\"requestResponse threw an exception\",e),t=e}return s.Single.error(t||new Error(\"not implemented\"))}requestStream(e){let t;if(this._responder.requestStream)try{return this._responder.requestStream(e)}catch(e){console.error(\"requestStream threw an exception\",e),t=e}return s.Flowable.error(t||new Error(\"not implemented\"))}requestChannel(e){let t;if(this._responder.requestChannel)try{return this._responder.requestChannel(e)}catch(e){console.error(\"requestChannel threw an exception\",e),t=e}return s.Flowable.error(t||new Error(\"not implemented\"))}metadataPush(e){let t;if(this._responder.metadataPush)try{return this._responder.metadataPush(e)}catch(e){console.error(\"metadataPush threw an exception\",e),t=e}return s.Single.error(t||new Error(\"not implemented\"))}}class l{constructor(e,t,r,n,s,i,o){this._connectionAvailability=1,this._handleTransportClose=(()=>{this._handleError(new Error(\"RSocket: The connection was closed.\"))}),this._handleError=(e=>{this._receivers.forEach(t=>{t.onError(e)}),this._receivers.clear(),this._subscriptions.forEach(e=>{e.cancel()}),this._subscriptions.clear(),this._connectionAvailability=0,this._dispose(this._requesterLeaseHandler,this._responderLeaseSenderDisposable)}),this._handleFrame=(e=>{const{streamId:t}=e;t===a.CONNECTION_STREAM_ID?this._handleConnectionFrame(e):this._handleStreamFrame(t,e)}),this._connection=t,this._requesterLeaseHandler=i,this._responderLeaseHandler=o,this._nextStreamId=\"CLIENT\"===e?1:2,this._receivers=new Map,this._subscriptions=new Map,this._serializers=n||u.IdentitySerializers,this._requestHandler=new c(s),r({onComplete:this._handleTransportClose,onError:this._handleError,onNext:this._handleFrame,onSubscribe:e=>e.request(Number.MAX_SAFE_INTEGER)});const l=this._responderLeaseHandler;l&&(this._responderLeaseSenderDisposable=l.send(this._leaseFrameSender())),this._connection.connectionStatus().subscribe({onNext:e=>{\"CLOSED\"===e.kind?this._handleTransportClose():\"ERROR\"===e.kind&&this._handleError(e.error)},onSubscribe:e=>e.request(Number.MAX_SAFE_INTEGER)})}setRequestHandler(e){this._requestHandler.setResponder(e)}close(){this._connection.close()}connectionStatus(){return this._connection.connectionStatus()}availability(){const e=this._requesterLeaseHandler,t=e?e.availability():1;return Math.min(this._connectionAvailability,t)}fireAndForget(e){if(!this._useLeaseOrError(this._requesterLeaseHandler)){const t=this._getNextStreamId(this._receivers),r=this._serializers.data.serialize(e.data),n=this._serializers.metadata.serialize(e.metadata),s={data:r,flags:void 0===e.metadata?0:a.FLAGS.METADATA,metadata:n,streamId:t,type:a.FRAME_TYPES.REQUEST_FNF};this._connection.sendOne(s)}}requestResponse(e){const t=this._useLeaseOrError(this._requesterLeaseHandler);if(t)return s.Single.error(new Error(t));const r=this._getNextStreamId(this._receivers);return new s.Single(t=>{this._receivers.set(r,{onComplete:i.default,onError:e=>t.onError(e),onNext:e=>t.onComplete(e)});const n=this._serializers.data.serialize(e.data),s=this._serializers.metadata.serialize(e.metadata),o={data:n,flags:void 0===e.metadata?0:a.FLAGS.METADATA,metadata:s,streamId:r,type:a.FRAME_TYPES.REQUEST_RESPONSE};this._connection.sendOne(o),t.onSubscribe(()=>{this._receivers.delete(r);const e={flags:0,streamId:r,type:a.FRAME_TYPES.CANCEL};this._connection.sendOne(e)})})}requestStream(e){const t=this._useLeaseOrError(this._requesterLeaseHandler);if(t)return s.Flowable.error(new Error(t));const r=this._getNextStreamId(this._receivers);return new s.Flowable(t=>{this._receivers.set(r,t);let n=!1;t.onSubscribe({cancel:()=>{if(this._receivers.delete(r),n){const e={flags:0,streamId:r,type:a.FRAME_TYPES.CANCEL};this._connection.sendOne(e)}},request:t=>{if(t>a.MAX_REQUEST_N&&(t=a.MAX_REQUEST_N),n){const e={flags:0,requestN:t,streamId:r,type:a.FRAME_TYPES.REQUEST_N};this._connection.sendOne(e)}else{n=!0;const s=this._serializers.data.serialize(e.data),i=this._serializers.metadata.serialize(e.metadata),o={data:s,flags:void 0===e.metadata?0:a.FLAGS.METADATA,metadata:i,requestN:t,streamId:r,type:a.FRAME_TYPES.REQUEST_STREAM};this._connection.sendOne(o)}}})},a.MAX_REQUEST_N)}requestChannel(e){const t=this._useLeaseOrError(this._requesterLeaseHandler);if(t)return s.Flowable.error(new Error(t));const r=this._getNextStreamId(this._receivers);let n=!1;return new s.Flowable(t=>{try{this._receivers.set(r,t);let s=!1;t.onSubscribe({cancel:()=>{if(this._receivers.delete(r),s){const e={flags:0,streamId:r,type:a.FRAME_TYPES.CANCEL};this._connection.sendOne(e)}},request:t=>{if(t>a.MAX_REQUEST_N&&(t=a.MAX_REQUEST_N),s){const e={flags:0,requestN:t,streamId:r,type:a.FRAME_TYPES.REQUEST_N};this._connection.sendOne(e)}else n?(0,o.default)(!1,\"RSocketClient: re-entrant call to request n before initial channel established.\"):(n=!0,e.subscribe({onComplete:()=>{this._sendStreamComplete(r)},onError:e=>{this._sendStreamError(r,e.message)},onNext:e=>{const n=this._serializers.data.serialize(e.data),i=this._serializers.metadata.serialize(e.metadata);if(s){const t={data:n,flags:a.FLAGS.NEXT|(void 0===e.metadata?0:a.FLAGS.METADATA),metadata:i,streamId:r,type:a.FRAME_TYPES.PAYLOAD};this._connection.sendOne(t)}else{s=!0;const o={data:n,flags:void 0===e.metadata?0:a.FLAGS.METADATA,metadata:i,requestN:t,streamId:r,type:a.FRAME_TYPES.REQUEST_CHANNEL};this._connection.sendOne(o)}},onSubscribe:e=>{this._subscriptions.set(r,e),e.request(1)}}))}})}catch(e){console.warn(\"Exception while subscribing to channel flowable:\"+e)}},a.MAX_REQUEST_N)}metadataPush(){throw new Error(\"metadataPush() is not implemented\")}_getNextStreamId(e){const t=this._nextStreamId;do{this._nextStreamId=this._nextStreamId+2&a.MAX_STREAM_ID}while(0===this._nextStreamId||e.has(t));return t}_useLeaseOrError(e){if(e&&!e.use())return e.errorMessage()}_leaseFrameSender(){return e=>this._connection.sendOne({flags:0,metadata:e.metadata,requestCount:e.allowedRequests,streamId:a.CONNECTION_STREAM_ID,ttl:e.timeToLiveMillis,type:a.FRAME_TYPES.LEASE})}_dispose(...e){e.forEach(e=>{e&&e.dispose()})}_isRequest(e){return e===a.FRAME_TYPES.REQUEST_FNF||e===a.FRAME_TYPES.REQUEST_RESPONSE||e===a.FRAME_TYPES.REQUEST_STREAM||e===a.FRAME_TYPES.REQUEST_CHANNEL}_handleConnectionError(e){this._handleError(e),this._connection.close()}_handleConnectionFrame(e){switch(e.type){case a.FRAME_TYPES.ERROR:const t=(0,a.createErrorFromFrame)(e);this._handleConnectionError(t);break;case a.FRAME_TYPES.EXT:break;case a.FRAME_TYPES.KEEPALIVE:(0,a.isRespond)(e.flags)&&this._connection.sendOne(Object.assign({},e,{flags:e.flags^a.FLAGS.RESPOND,lastReceivedPosition:0}));break;case a.FRAME_TYPES.LEASE:const r=this._requesterLeaseHandler;r&&r.receive(e);break;case a.FRAME_TYPES.METADATA_PUSH:case a.FRAME_TYPES.REQUEST_CHANNEL:case a.FRAME_TYPES.REQUEST_FNF:case a.FRAME_TYPES.REQUEST_RESPONSE:case a.FRAME_TYPES.REQUEST_STREAM:case a.FRAME_TYPES.RESERVED:break;case a.FRAME_TYPES.RESUME:case a.FRAME_TYPES.RESUME_OK:}}_handleStreamFrame(e,t){if(this._isRequest(t.type)){const t=this._useLeaseOrError(this._responderLeaseHandler);if(t)return void this._sendStreamError(e,t)}switch(t.type){case a.FRAME_TYPES.CANCEL:this._handleCancel(e,t);break;case a.FRAME_TYPES.REQUEST_N:this._handleRequestN(e,t);break;case a.FRAME_TYPES.REQUEST_FNF:this._handleFireAndForget(e,t);break;case a.FRAME_TYPES.REQUEST_RESPONSE:this._handleRequestResponse(e,t);break;case a.FRAME_TYPES.REQUEST_STREAM:this._handleRequestStream(e,t);break;case a.FRAME_TYPES.REQUEST_CHANNEL:this._handleRequestChannel(e,t);break;case a.FRAME_TYPES.ERROR:const r=(0,a.createErrorFromFrame)(t);this._handleStreamError(e,r);break;case a.FRAME_TYPES.PAYLOAD:const n=this._receivers.get(e);if(null!=n){if((0,a.isNext)(t.flags)){const e={data:this._serializers.data.deserialize(t.data),metadata:this._serializers.metadata.deserialize(t.metadata)};n.onNext(e)}(0,a.isComplete)(t.flags)&&(this._receivers.delete(e),n.onComplete())}}}_handleCancel(e){const t=this._subscriptions.get(e);t&&(t.cancel(),this._subscriptions.delete(e))}_handleRequestN(e,t){const r=this._subscriptions.get(e);r&&r.request(t.requestN)}_handleFireAndForget(e,t){const r=this._deserializePayload(t);this._requestHandler.fireAndForget(r)}_handleRequestResponse(e,t){const r=this._deserializePayload(t);this._requestHandler.requestResponse(r).subscribe({onComplete:t=>{this._sendStreamPayload(e,t,!0)},onError:t=>this._sendStreamError(e,t.message),onSubscribe:t=>{const r={cancel:t,request:i.default};this._subscriptions.set(e,r)}})}_handleRequestStream(e,t){const r=this._deserializePayload(t);this._requestHandler.requestStream(r).subscribe({onComplete:()=>this._sendStreamComplete(e),onError:t=>this._sendStreamError(e,t.message),onNext:t=>this._sendStreamPayload(e,t),onSubscribe:r=>{this._subscriptions.set(e,r),r.request(t.requestN)}})}_handleRequestChannel(e,t){if(!this._subscriptions.get(e)){const r=new s.Flowable(r=>{let n=!0;r.onSubscribe({cancel:()=>{this._receivers.delete(e);const t={flags:0,streamId:e,type:a.FRAME_TYPES.CANCEL};this._connection.sendOne(t)},request:s=>{if(s>a.MAX_REQUEST_N&&(s=a.MAX_REQUEST_N),n&&s--,0<s){const t={flags:0,requestN:s,streamId:e,type:a.FRAME_TYPES.REQUEST_N};this._connection.sendOne(t)}n&&0<=s&&(n=!1,r.onNext(t))}})},a.MAX_REQUEST_N),n=new s.FlowableProcessor(r,e=>this._deserializePayload(e));this._receivers.set(e,n),this._requestHandler.requestChannel(n).subscribe({onComplete:()=>this._sendStreamComplete(e),onError:t=>this._sendStreamError(e,t.message),onNext:t=>this._sendStreamPayload(e,t),onSubscribe:r=>{this._subscriptions.set(e,r),r.request(t.requestN)}})}}_sendStreamComplete(e){this._subscriptions.delete(e),this._connection.sendOne({data:null,flags:a.FLAGS.COMPLETE,metadata:null,streamId:e,type:a.FRAME_TYPES.PAYLOAD})}_sendStreamError(e,t){this._subscriptions.delete(e),this._connection.sendOne({code:a.ERROR_CODES.APPLICATION_ERROR,flags:0,message:t,streamId:e,type:a.FRAME_TYPES.ERROR})}_sendStreamPayload(e,t,r=!1){let n=a.FLAGS.NEXT;r&&(n|=a.FLAGS.COMPLETE,this._subscriptions.delete(e));const s=this._serializers.data.serialize(t.data),i=this._serializers.metadata.serialize(t.metadata);this._connection.sendOne({data:s,flags:n,metadata:i,streamId:e,type:a.FRAME_TYPES.PAYLOAD})}_deserializePayload(e){return function(e,t){return{data:e.data.deserialize(t.data),metadata:e.metadata.deserialize(t.metadata)}}(this._serializers,e)}_handleStreamError(e,t){const r=this._receivers.get(e);null!=r&&(this._receivers.delete(e),r.onError(t))}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(37);Object.keys(n).forEach(function(e){\"default\"===e||\"__esModule\"===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var s=r(38);Object.keys(s).forEach(function(e){\"default\"===e||\"__esModule\"===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})})},function(e,t,r){\"use strict\";(function(t){function r(e){o.length||(i(),!0),o[o.length]=e}function n(){for(;a<o.length;){var e=a;if(++a,o[e].call(),a>u){for(var t=0,r=o.length-a;t<r;t++)o[t]=o[t+a];o.length-=a,a=0}}o.length=0,a=0,!1}function s(e){return function(){function t(){clearTimeout(r),clearInterval(n),e()}var r=setTimeout(t,0),n=setInterval(t,50)}}e.exports=r;var i,o=[],a=0,u=1024,c=void 0===t?self:t,l=c.MutationObserver||c.WebKitMutationObserver;i=\"function\"==typeof l?function(e){var t=1,r=new l(e),n=document.createTextNode(\"\");return r.observe(n,{characterData:!0}),function(){t=-t,n.data=t}}(n):s(n),r.requestFlush=i,r.makeRequestCallFromTimer=s}).call(this,r(4))},function(e,t,r){\"use strict\";var n=r(10),s=function(e){return e&&\"object\"==typeof e&&\"default\"in e?e.default:e}(r(39)),i=r(2),o=r(53),a=function(e,t,r){r.onSubscribe(),e.requestResponse(t).then(function(e){r.onComplete({data:e})}).catch(function(e){r.onError(e)})},u=function(e,t,r){r.onSubscribe(),e.requestStream(t).subscribe(function(e){r.onNext({data:e})},function(e){return r.onError(e)},function(){return r.onComplete()})},c=function(e,t){o.check.isDefined(t)&&o.check.assertFunction(t,function(e,t){return\"invalid custom \"+e+\", receive \"+t+\" instead of Function\"}(e,typeof t))},l=function(){function e(e){this.started=!1;var t=e.port;this.port=t||3e3,this.transport=new s({port:this.port});var r=e.requestResponse,n=e.requestStream;c(\"requestResponse\",r),c(\"requestStream\",n),this.requestResponse=r,this.requestStream=n}return e.prototype.start=function(e){var t=this;if(this.started)this.warn(\"Gateway is already started\");else{var r=e.serviceCall;(function(e){o.check.assertObject(e,\"service call must be an object\");var t=e.requestResponse,r=e.requestStream;o.check.assertFunction(t,\"requestResponse must be a function\"),o.check.assertFunction(r,\"requestStream must be a function\")})(r),this.server=new n.RSocketServer({serializers:n.JsonSerializers,getRequestHandler:function(){return{requestResponse:function(e){return function(e,t,r){var n=e.data;return void 0===r&&(r=a),new i.Single(r.bind(null,t,n))}(e,r,t.requestResponse)},requestStream:function(e){return function(e,t,r){var n=e.data;return void 0===r&&(r=u),new i.Flowable(r.bind(null,t,n))}(e,r,t.requestStream)}}},transport:this.transport}),this.server.start(),this.started=!0}},e.prototype.stop=function(){return this.started?(this.server.stop(),void(this.started=!1)):void this.warn(\"Gateway is already stopped\")},e.prototype.warn=function(e){console.warn(e)},e}();e.exports=l},function(e,t,r){\"use strict\";(function(e){r.d(t,\"a\",function(){return n});const n=()=>{const t={};e.postMessage=((e,r,n)=>{(t.message||[]).forEach(t=>{t({ports:n,data:e,type:\"message\"})})});const r=addEventListener;addEventListener=((e,n)=>{if(\"message\"===e){const r=[...t[e]||[],n];t[e]=r}else r(e,n)})}}).call(this,r(4))},function(e,t,r){\"use strict\";r.r(t);var n=r(19);r.n(n);console.log({Gateway:n.Gateway})},function(e){\"use strict\";var t=Object.prototype.hasOwnProperty;e.exports=function(e,r,n){for(var s in e)t.call(e,s)&&r.call(n,e[s],s,e)}},function(e){\"use strict\";e.exports=function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var s=0;return e.replace(/%s/g,function(){return r[s++]})}},function(e,t,r){\"use strict\";var n=Math.floor,s=Math.pow,i=String.fromCharCode,o=Math.min;(function(e){function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(a()<t)throw new RangeError(\"Invalid typed array length\");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if(\"number\"==typeof e){if(\"string\"==typeof t)throw new Error(\"If encoding is specified then the first argument must be a string\");return h(this,e)}return l(this,e,t,r)}function l(e,t,r,n){if(\"number\"==typeof t)throw new TypeError('\"value\" argument must not be a number');return\"undefined\"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,0>r||t.byteLength<r)throw new RangeError(\"'offset' is out of bounds\");if(t.byteLength<r+(n||0))throw new RangeError(\"'length' is out of bounds\");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=d(e,t),e}(e,t,r,n):\"string\"==typeof t?function(e,t,r){if((\"string\"!=typeof r||\"\"===r)&&(r=\"utf8\"),!c.isEncoding(r))throw new TypeError('\"encoding\" must be a valid string encoding');var n=0|_(t,r),s=(e=u(e,n)).write(t,r);return s!==n&&(e=e.slice(0,s)),e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|E(t.length);return 0===(e=u(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if(\"undefined\"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||\"length\"in t)return\"number\"!=typeof t.length||function(e){return e!=e}\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */(t.length)?u(e,0):d(e,t);if(\"Buffer\"===t.type&&G(t.data))return d(e,t.data)}throw new TypeError(\"First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.\")}(e,t)}function f(e){if(\"number\"!=typeof e)throw new TypeError('\"size\" argument must be a number');if(0>e)throw new RangeError('\"size\" argument must not be negative')}function h(e,t){if(f(t),e=u(e,0>t?0:0|E(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function d(e,t){var r=0>t.length?0:0|E(t.length);e=u(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function E(e){if(e>=a())throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+a().toString(16)+\" bytes\");return 0|e}function _(e,t){if(c.isBuffer(e))return e.length;if(\"undefined\"!=typeof ArrayBuffer&&\"function\"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;\"string\"!=typeof e&&(e=\"\"+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case\"ascii\":case\"latin1\":case\"binary\":return r;case\"utf8\":case\"utf-8\":case void 0:return j(e).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return 2*r;case\"hex\":return r>>>1;case\"base64\":return q(e).length;default:if(n)return j(e).length;t=(\"\"+t).toLowerCase(),n=!0}}function p(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,s){if(0===e.length)return-1;if(\"string\"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:-2147483648>r&&(r=-2147483648),r=+r,isNaN(r)&&(r=s?0:e.length-1),0>r&&(r=e.length+r),r>=e.length){if(s)return-1;r=e.length-1}else if(0>r){if(!s)return-1;r=0}if(\"string\"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,s);if(\"number\"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&\"function\"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,s);throw new TypeError(\"val must be string, number or Buffer\")}function b(e,t,r,n,s){function i(e,t){return 1==a?e[t]:e.readUInt16BE(t*a)}var o,a=1,u=e.length,c=t.length;if(void 0!==n&&(\"ucs2\"===(n=(n+\"\").toLowerCase())||\"ucs-2\"===n||\"utf16le\"===n||\"utf-16le\"===n)){if(2>e.length||2>t.length)return-1;a=2,u/=2,c/=2,r/=2}if(s){var l=-1;for(o=r;o<u;o++)if(i(e,o)!==i(t,-1==l?0:o-l))-1!=l&&(o-=o-l),l=-1;else if(-1==l&&(l=o),o-l+1===c)return l*a}else for(r+c>u&&(r=u-c),o=r;0<=o;o--){for(var f=!0,h=0;h<c;h++)if(i(e,o+h)!==i(t,h)){f=!1;break}if(f)return o}return-1}function S(e,t,r,n){r=+r||0;var s=e.length-r;n?(n=+n)>s&&(n=s):n=s;var i=t.length;if(0!=i%2)throw new TypeError(\"Invalid hex string\");n>i/2&&(n=i/2);for(var o,a=0;a<n;++a){if(o=parseInt(t.substr(2*a,2),16),isNaN(o))return a;e[r+a]=o}return a}function g(e,t,r,n){return D(j(t,e.length-r),e,r,n)}function y(e,t,r,n){return D(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function R(e,t,r,n){return y(e,t,r,n)}function v(e,t,r,n){return D(q(t),e,r,n)}function T(e,t,r,n){return D(function(e,t){for(var r,n,s,i=[],o=0;o<e.length&&!(0>(t-=2));++o)r=e.charCodeAt(o),n=r>>8,s=r%256,i.push(s),i.push(n);return i}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?z.fromByteArray(e):z.fromByteArray(e.slice(t,r))}function w(e,t,r){r=o(e.length,r);for(var n=[],s=t;s<r;){var i,a,u,c,l=e[s],f=null,h=239<l?4:223<l?3:191<l?2:1;if(s+h<=r)1==h?128>l&&(f=l):2==h?128==(192&(i=e[s+1]))&&(127<(c=(31&l)<<6|63&i)&&(f=c)):3==h?(i=e[s+1],a=e[s+2],128==(192&i)&&128==(192&a)&&(2047<(c=(15&l)<<12|(63&i)<<6|63&a)&&(55296>c||57343<c)&&(f=c))):4==h&&(i=e[s+1],a=e[s+2],u=e[s+3],128==(192&i)&&128==(192&a)&&128==(192&u)&&(65535<(c=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&u)&&1114112>c&&(f=c)));null===f?(f=65533,h=1):65535<f&&(f-=65536,n.push(55296|1023&f>>>10),f=56320|1023&f),n.push(f),s+=h}return M(n)}function M(e){var t=e.length;if(t<=Q)return i.apply(String,e);for(var r=\"\",n=0;n<t;)r+=i.apply(String,e.slice(n,n+=Q));return r}function O(e,t,r){var n=\"\";r=o(e.length,r);for(var s=t;s<r;++s)n+=i(127&e[s]);return n}function N(e,t,r){var n=\"\";r=o(e.length,r);for(var s=t;s<r;++s)n+=i(e[s]);return n}function P(e,t,r){var n=e.length;(!t||0>t)&&(t=0),(!r||0>r||r>n)&&(r=n);for(var s=\"\",i=t;i<r;++i)s+=Y(e[i]);return s}function F(e,t,r){for(var n=e.slice(t,r),s=\"\",o=0;o<n.length;o+=2)s+=i(n[o]+256*n[o+1]);return s}function I(e,t,r){if(0!=e%1||0>e)throw new RangeError(\"offset is not uint\");if(e+t>r)throw new RangeError(\"Trying to access beyond buffer length\")}function L(e,t,r,n,s,i){if(!c.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(t>s||t<i)throw new RangeError('\"value\" argument is out of bounds');if(r+n>e.length)throw new RangeError(\"Index out of range\")}function C(e,t,r,n){0>t&&(t=65535+t+1);for(var s=0,i=o(e.length-r,2);s<i;++s)e[r+s]=(t&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function U(e,t,r,n){0>t&&(t=4294967295+t+1);for(var s=0,i=o(e.length-r,4);s<i;++s)e[r+s]=255&t>>>8*(n?s:3-s)}function B(e,t,r,n){if(r+n>e.length)throw new RangeError(\"Index out of range\");if(0>r)throw new RangeError(\"Index out of range\")}function k(e,t,r,n,s){return s||B(e,0,r,4),X.write(e,t,r,n,23,4),r+4}function x(e,t,r,n,s){return s||B(e,0,r,8),X.write(e,t,r,n,52,8),r+8}function Y(e){return 16>e?\"0\"+e.toString(16):e.toString(16)}function j(e,t){t=t||1/0;for(var r,n=e.length,s=null,i=[],o=0;o<n;++o){if(55295<(r=e.charCodeAt(o))&&57344>r){if(!s){if(56319<r){-1<(t-=3)&&i.push(239,191,189);continue}if(o+1===n){-1<(t-=3)&&i.push(239,191,189);continue}s=r;continue}if(56320>r){-1<(t-=3)&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&-1<(t-=3)&&i.push(239,191,189);if(s=null,128>r){if(0>(t-=1))break;i.push(r)}else if(2048>r){if(0>(t-=2))break;i.push(192|r>>6,128|63&r)}else if(65536>r){if(0>(t-=3))break;i.push(224|r>>12,128|63&r>>6,128|63&r)}else{if(!(1114112>r))throw new Error(\"Invalid code point\");if(0>(t-=4))break;i.push(240|r>>18,128|63&r>>12,128|63&r>>6,128|63&r)}}return i}function q(e){return z.toByteArray(function(e){if(2>(e=function(e){return e.trim?e.trim():e.replace(/^\\s+|\\s+$/g,\"\")}(e).replace(H,\"\")).length)return\"\";for(;0!=e.length%4;)e+=\"=\";return e}(e))}function D(e,t,r,n){for(var s=0;s<n&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}var z=r(25),X=r(26),G=r(27);t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0===e.TYPED_ARRAY_SUPPORT?function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&\"function\"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}():e.TYPED_ARRAY_SUPPORT,t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return l(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,\"undefined\"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,n){return f(t),0>=t?u(e,t):void 0===r?u(e,t):\"string\"==typeof n?u(e,t).fill(r,n):u(e,t).fill(r)}(null,e,t,r)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError(\"Arguments must be Buffers\");if(e===t)return 0;for(var r=e.length,n=t.length,s=0,i=o(r,n);s<i;++s)if(e[s]!==t[s]){r=e[s],n=t[s];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch((e+\"\").toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},c.concat=function(e,t){if(!G(e))throw new TypeError('\"list\" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),s=0;for(r=0;r<e.length;++r){var i=e[r];if(!c.isBuffer(i))throw new TypeError('\"list\" argument must be an Array of Buffers');i.copy(n,s),s+=i.length}return n},c.byteLength=_,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError(\"Buffer size must be a multiple of 16-bits\");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError(\"Buffer size must be a multiple of 32-bits\");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError(\"Buffer size must be a multiple of 64-bits\");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0==e?\"\":0===arguments.length?w(this,0,e):function(e,t,r){var n=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return\"\";if((void 0===r||r>this.length)&&(r=this.length),0>=r)return\"\";if((r>>>=0)<=(t>>>=0))return\"\";for(e||(e=\"utf8\");;)switch(e){case\"hex\":return P(this,t,r);case\"utf8\":case\"utf-8\":return w(this,t,r);case\"ascii\":return O(this,t,r);case\"latin1\":case\"binary\":return N(this,t,r);case\"base64\":return A(this,t,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return F(this,t,r);default:if(n)throw new TypeError(\"Unknown encoding: \"+e);e=(e+\"\").toLowerCase(),n=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e=\"\",r=t.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString(\"hex\",0,r).match(/.{2}/g).join(\" \"),this.length>r&&(e+=\" ... \")),\"<Buffer \"+e+\">\"},c.prototype.compare=function(e,t,r,n,s){if(!c.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),0>t||r>e.length||0>n||s>this.length)throw new RangeError(\"out of range index\");if(n>=s&&t>=r)return 0;if(n>=s)return-1;if(t>=r)return 1;if(this===e)return 0;for(var i=(s>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),u=o(i,a),l=this.slice(n,s),f=e.slice(t,r),h=0;h<u;++h)if(l[h]!==f[h]){i=l[h],a=f[h];break}return i<a?-1:a<i?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n=\"utf8\",r=this.length,t=0;else if(void 0===r&&\"string\"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\");t|=0,isFinite(r)?(r|=0,void 0===n&&(n=\"utf8\")):(n=r,r=void 0)}var s=this.length-t;if((void 0===r||r>s)&&(r=s),0<e.length&&(0>r||0>t)||t>this.length)throw new RangeError(\"Attempt to write outside buffer bounds\");n||(n=\"utf8\");for(var i=!1;;)switch(n){case\"hex\":return S(this,e,t,r);case\"utf8\":case\"utf-8\":return g(this,e,t,r);case\"ascii\":return y(this,e,t,r);case\"latin1\":case\"binary\":return R(this,e,t,r);case\"base64\":return v(this,e,t,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return T(this,e,t,r);default:if(i)throw new TypeError(\"Unknown encoding: \"+n);n=(\"\"+n).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;c.prototype.slice=function(e,t){var r,n=this.length;if(0>(e=~~e)?0>(e+=n)&&(e=0):e>n&&(e=n),0>(t=void 0===t?n:~~t)?0>(t+=n)&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var s=t-e;r=new c(s,void 0);for(var i=0;i<s;++i)r[i]=this[i+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],s=1,i=0;++i<t&&(s*=256);)n+=this[e+i]*s;return n},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e+--t],s=1;0<t&&(s*=256);)n+=this[e+--t]*s;return n},c.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=s(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=t,i=1,o=this[e+--n];0<n&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=s(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),X.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),X.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),X.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),X.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||L(this,e,t,r,s(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=255&e/i;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||L(this,e,t,r,s(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;0<=--i&&(o*=256);)this[t+i]=255&e/o;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=n(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=s(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=0,a=1,u=0;for(this[t]=255&e;++o<r&&(a*=256);)0>e&&0==u&&0!==this[t+o-1]&&(u=1),this[t+o]=255&(e/a>>0)-u;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=s(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=r-1,a=1,u=0;for(this[t+o]=255&e;0<=--o&&(a*=256);)0>e&&0==u&&0!==this[t+o+1]&&(u=1),this[t+o]=255&(e/a>>0)-u;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=n(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return x(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return x(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),0<n&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError(\"targetStart out of bounds\");if(0>r||r>=this.length)throw new RangeError(\"sourceStart out of bounds\");if(0>n)throw new RangeError(\"sourceEnd out of bounds\");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var s,i=n-r;if(this===e&&r<t&&t<n)for(s=i-1;0<=s;--s)e[s+t]=this[s+r];else if(1e3>i||!c.TYPED_ARRAY_SUPPORT)for(s=0;s<i;++s)e[s+t]=this[s+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},c.prototype.fill=function(e,t,r,n){if(\"string\"==typeof e){if(\"string\"==typeof t?(n=t,t=0,r=this.length):\"string\"==typeof r&&(n=r,r=this.length),1===e.length){var s=e.charCodeAt(0);256>s&&(e=s)}if(void 0!==n&&\"string\"!=typeof n)throw new TypeError(\"encoding must be a string\");if(\"string\"==typeof n&&!c.isEncoding(n))throw new TypeError(\"Unknown encoding: \"+n)}else\"number\"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<r)throw new RangeError(\"Out of range index\");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),\"number\"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var o=c.isBuffer(e)?e:j(new c(e,n).toString()),a=o.length;for(i=0;i<r-t;++i)this[i+t]=o[i%a]}return this};var H=/[^+\\/0-9A-Za-z-_]/g}).call(this,r(4))},function(e,t){\"use strict\";function r(e){var t=e.length;if(0<t%4)throw new Error(\"Invalid string. Length must be a multiple of 4\");var r=e.indexOf(\"=\");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function n(e){return i[63&e>>18]+i[63&e>>12]+i[63&e>>6]+i[63&e]}function s(e,t,r){for(var s,i=[],o=t;o<r;o+=3)s=(16711680&e[o]<<16)+(65280&e[o+1]<<8)+(255&e[o+2]),i.push(n(s));return i.join(\"\")}t.byteLength=function(e){var t=r(e),n=t[0],s=t[1];return 3*(n+s)/4-s},t.toByteArray=function(e){var t,n,s=r(e),i=s[0],u=s[1],c=new a(function(e,t,r){return 3*(t+r)/4-r}(0,i,u)),l=0,f=0<u?i-4:i;for(n=0;n<f;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],c[l++]=255&t>>16,c[l++]=255&t>>8,c[l++]=255&t;return 2===u&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,c[l++]=255&t),1===u&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,c[l++]=255&t>>8,c[l++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,o=[],a=16383,u=0,c=r-n;u<c;u+=a)o.push(s(e,u,u+a>c?c:u+a));return 1==n?(t=e[r-1],o.push(i[t>>2]+i[63&t<<4]+\"==\")):2==n&&(t=(e[r-2]<<8)+e[r-1],o.push(i[t>>10]+i[63&t>>4]+i[63&t<<2]+\"=\")),o.join(\"\")};for(var i=[],o=[],a=\"undefined\"==typeof Uint8Array?Array:Uint8Array,u=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",c=0,l=u.length;c<l;++c)i[c]=u[c],o[u.charCodeAt(c)]=c;o[45]=62,o[95]=63},function(e,t){var r=Math.pow;t.read=function(e,t,n,s,i){var o,a,u=8*i-s-1,c=(1<<u)-1,l=c>>1,f=-7,h=n?i-1:0,d=n?-1:1,E=e[t+h];for(h+=d,o=E&(1<<-f)-1,E>>=-f,f+=u;0<f;o=256*o+e[t+h],h+=d,f-=8);for(a=o&(1<<-f)-1,o>>=-f,f+=s;0<f;a=256*a+e[t+h],h+=d,f-=8);if(0===o)o=1-l;else{if(o===c)return a?NaN:1/0*(E?-1:1);a+=r(2,s),o-=l}return(E?-1:1)*a*r(2,o-s)},t.write=function(e,t,n,s,i,o){var a,u,c,l=8*o-i-1,f=(1<<l)-1,h=f>>1,d=23===i?5.960464477539062e-8:0,E=s?0:o-1,_=s?1:-1,p=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=f):(a=Math.floor(Math.log(t)/Math.LN2),1>t*(c=r(2,-a))&&(a--,c*=2),2<=(t+=1<=a+h?d/c:d*r(2,1-h))*c&&(a++,c/=2),a+h>=f?(u=0,a=f):1<=a+h?(u=(t*c-1)*r(2,i),a+=h):(u=t*r(2,h-1)*r(2,i),a=0));8<=i;e[n+E]=255&u,E+=_,u/=256,i-=8);for(a=a<<i|u,l+=i;0<l;e[n+E]=255&a,E+=_,a/=256,l-=8);e[n+E-_]|=128*p}},function(e){var t={}.toString;e.exports=Array.isArray||function(e){return\"[object Array]\"==t.call(e)}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(15));t.default=class{constructor(e,t){this._fn=t,this._subscriber=e,this._subscription=null}onComplete(){this._subscriber.onComplete()}onError(e){this._subscriber.onError(e)}onNext(e){try{this._subscriber.onNext(this._fn(e))}catch(e){(0,n.default)(this._subscription).cancel(),this._subscriber.onError(e)}}onSubscribe(e){this._subscription=e,this._subscriber.onSubscribe(e)}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(15));t.default=class{constructor(e,t){this._subscriber=e,this._subscription=null,this._toTake=t}onComplete(){this._subscriber.onComplete()}onError(e){this._subscriber.onError(e)}onNext(e){try{this._subscriber.onNext(e),0==--this._toTake&&this._cancelAndComplete()}catch(e){(0,n.default)(this._subscription).cancel(),this._subscriber.onError(e)}}onSubscribe(e){this._subscription=e,this._subscriber.onSubscribe(e),0>=this._toTake&&this._cancelAndComplete()}_cancelAndComplete(){(0,n.default)(this._subscription).cancel(),this._subscriber.onComplete()}}},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var s=n(r(6)),i=n(r(7));class o{static of(e){return new o(t=>{t.onSubscribe(),t.onComplete(e)})}static error(e){return new o(t=>{t.onSubscribe(),t.onError(e)})}constructor(e){this._source=e}subscribe(e){const t=new a(e);try{this._source(t)}catch(e){t.onError(e)}}flatMap(e){return new o(t=>{let r;const n=()=>{r&&r(),r=null};this._source({onComplete:n=>{e(n).subscribe({onComplete:e=>{t.onComplete(e)},onError:e=>t.onError(e),onSubscribe:e=>{r=e}})},onError:e=>t.onError(e),onSubscribe:e=>{r=e,t.onSubscribe(n)}})})}map(e){return new o(t=>this._source({onComplete:r=>t.onComplete(e(r)),onError:e=>t.onError(e),onSubscribe:e=>t.onSubscribe(e)}))}then(e,t){this.subscribe({onComplete:e||i.default,onError:t||i.default})}}t.default=o;class a{constructor(e){this._active=!1,this._started=!1,this._subscriber=e||{}}onComplete(e){if(this._active){this._active=!1,this._started=!0;try{this._subscriber.onComplete&&this._subscriber.onComplete(e)}catch(e){this._subscriber.onError&&this._subscriber.onError(e)}}else(0,s.default)(!1,\"Single: Invalid call to onComplete(): %s.\",this._started?\"onComplete/onError was already called\":\"onSubscribe has not been called\")}onError(e){return this._started&&!this._active?void(0,s.default)(!1,\"Single: Invalid call to onError(): %s.\",this._active?\"onComplete/onError was already called\":\"onSubscribe has not been called\"):(this._active=!1,this._started=!0,void(this._subscriber.onError&&this._subscriber.onError(e)))}onSubscribe(e){if(this._started)(0,s.default)(!1,\"Single: Invalid call to onSubscribe(): already called.\");else{this._active=!0,this._started=!0;try{this._subscriber.onSubscribe&&this._subscriber.onSubscribe(()=>{this._active&&(this._active=!1,e&&e())})}catch(e){this.onError(e)}}}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(6));t.default=class{constructor(e,t){this._source=e,this._transformer=t,this._done=!1,this._mappers=[]}onSubscribe(e){this._subscription=e}onNext(e){if(!this._sink)return void(0,n.default)(\"Warning, premature onNext for processor, dropping value\");let t=e;this._transformer&&(t=this._transformer(e));const r=this._mappers.reduce((e,t)=>t(e),t);this._sink.onNext(r)}onError(e){this._error=e,this._sink?this._sink.onError(e):(0,n.default)(\"Warning, premature onError for processor, marking complete/errored\")}onComplete(){this._done=!0,this._sink?this._sink.onComplete():(0,n.default)(\"Warning, premature onError for processor, marking complete\")}subscribe(e){this._source.subscribe&&this._source.subscribe(this),this._sink=e,this._sink.onSubscribe(this),this._error?this._sink.onError(this._error):this._done&&this._sink.onComplete()}map(e){return this._mappers.push(e),this}request(e){this._subscription&&this._subscription.request(e)}cancel(){this._subscription&&this._subscription.cancel()}}},function(e,t,r){\"use strict\";var n=Number.MAX_SAFE_INTEGER;Object.defineProperty(t,\"__esModule\",{value:!0}),t.every=function(e){return new s.default(t=>{let r=null,s=0;t.onSubscribe({cancel:()=>{null!=r&&(clearInterval(r),r=null)},request:i=>{i<n?s+=i:s=n,null!=r||(r=setInterval(()=>{0<s&&(s!==n&&s--,t.onNext(Date.now()))},e))}})})};var s=function(e){return e&&e.__esModule?e:{default:e}}(r(14))},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(2),s=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1),o=r(34),a=r(16),u=r(5);t.default=class{constructor(e){this._cancel=null,this._config=e,this._connection=null,this._socket=null}close(){this._config.transport.close()}connect(){return(0,s.default)(!this._connection,\"RSocketClient: Unexpected call to connect(), already connected.\"),this._connection=new n.Single(e=>{const t=this._config.transport;let r;t.connectionStatus().subscribe({onNext:n=>{\"CONNECTED\"===n.kind?(r&&r.cancel(),e.onComplete(new c(this._config,t))):\"ERROR\"===n.kind?(r&&r.cancel(),e.onError(n.error)):\"CLOSED\"===n.kind&&(r&&r.cancel(),e.onError(new Error(\"RSocketClient: Connection closed.\")))},onSubscribe:t=>{e.onSubscribe(()=>t.cancel()),(r=t).request(Number.MAX_SAFE_INTEGER)}}),t.connect()}),this._connection}};class c{constructor(e,t){let r,s;const o=e.leases;if(o){const e=o();r=new u.RequesterLeaseHandler(e._receiver),s=new u.ResponderLeaseHandler(e._sender,e._stats)}this._machine=(0,a.createClientMachine)(t,e=>t.receive().subscribe(e),e.serializers,e.responder,r,s),t.sendOne(this._buildSetupFrame(e));const{keepAlive:c}=e.setup,l=e.navigator;3e4<c&&l&&l.userAgent&&(l.userAgent.includes(\"Trident\")||l.userAgent.includes(\"Edg\"))&&console.warn(\"rsocket-js: Due to a browser bug, Internet Explorer and Edge users may experience WebSocket instability with keepAlive values longer than 30 seconds.\");const f=(0,n.every)(c).map(()=>({data:null,flags:i.FLAGS.RESPOND,lastReceivedPosition:0,streamId:i.CONNECTION_STREAM_ID,type:i.FRAME_TYPES.KEEPALIVE}));t.send(f)}fireAndForget(e){this._machine.fireAndForget(e)}requestResponse(e){return this._machine.requestResponse(e)}requestStream(e){return this._machine.requestStream(e)}requestChannel(e){return this._machine.requestChannel(e)}metadataPush(e){return this._machine.metadataPush(e)}close(){this._machine.close()}connectionStatus(){return this._machine.connectionStatus()}availability(){return this._machine.availability()}_buildSetupFrame(e){const{dataMimeType:t,keepAlive:r,lifetime:n,metadata:s,metadataMimeType:a,data:u}=e.setup;let c=0;return void 0!==s&&(c|=i.FLAGS.METADATA),{data:u,dataMimeType:t,flags:c|(e.leases?i.FLAGS.LEASE:0),keepAlive:r,lifetime:n,majorVersion:o.MAJOR_VERSION,metadata:s,metadataMimeType:a,minorVersion:o.MINOR_VERSION,resumeToken:null,streamId:i.CONNECTION_STREAM_ID,type:i.FRAME_TYPES.SETUP}}}},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});t.MAJOR_VERSION=1,t.MINOR_VERSION=0},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});r(2);var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),s=r(1),i=r(9),o=r(16),a=r(5);t.default=class{constructor(e){this._handleTransportComplete=(()=>{this._handleTransportError(new Error(\"RSocketServer: Connection closed unexpectedly.\"))}),this._handleTransportError=(()=>{this._connections.forEach(e=>{e.close()})}),this._handleTransportConnection=(e=>{const t=new u;let r;e.receive().subscribe(t.swap({onError:e=>console.error(e),onNext:r=>{switch(r.type){case s.FRAME_TYPES.RESUME:e.sendOne({code:s.ERROR_CODES.REJECTED_RESUME,flags:0,message:\"RSocketServer: RESUME not supported.\",streamId:s.CONNECTION_STREAM_ID,type:s.FRAME_TYPES.ERROR}),e.close();break;case s.FRAME_TYPES.SETUP:if(this._setupLeaseError(r)){e.sendOne({code:s.ERROR_CODES.INVALID_SETUP,flags:0,message:\"RSocketServer: LEASE not supported.\",streamId:s.CONNECTION_STREAM_ID,type:s.FRAME_TYPES.ERROR}),e.close();break}const i=this._getSerializers();let u,c;const l=this._config.leases;if(l){const e=l();u=new a.RequesterLeaseHandler(e._receiver),c=new a.ResponderLeaseHandler(e._sender,e._stats)}const f=(0,o.createServerMachine)(e,e=>{t.swap(e)},i,u,c);try{const e=this._config.getRequestHandler(f,function(e,t){return{data:e.data.deserialize(t.data),metadata:e.metadata.deserialize(t.metadata)}}(i,r));f.setRequestHandler(e),this._connections.add(f)}catch(t){e.sendOne({code:s.ERROR_CODES.REJECTED_SETUP,flags:0,message:\"Application rejected setup, reason: \"+t.message,streamId:s.CONNECTION_STREAM_ID,type:s.FRAME_TYPES.ERROR}),e.close()}break;default:(0,n.default)(!1,\"RSocketServer: Expected first frame to be SETUP or RESUME, got `%s`.\",(0,s.getFrameTypeName)(r.type))}},onSubscribe:e=>{(r=e).request(1)}}))}),this._config=e,this._connections=new Set,this._started=!1,this._subscription=null}start(){(0,n.default)(!this._started,\"RSocketServer: Unexpected call to start(), already started.\"),this._started=!0,this._config.transport.start().subscribe({onComplete:this._handleTransportComplete,onError:this._handleTransportError,onNext:this._handleTransportConnection,onSubscribe:e=>{this._subscription=e,e.request(Number.MAX_SAFE_INTEGER)}})}stop(){this._subscription&&this._subscription.cancel(),this._config.transport.stop(),this._handleTransportError(new Error(\"RSocketServer: Connection terminated via stop().\"))}_getSerializers(){return this._config.serializers||i.IdentitySerializers}_setupLeaseError(e){const t=(e.flags&s.FLAGS.LEASE)===s.FLAGS.LEASE,r=this._config.leases;return t&&!r}};class u{constructor(e){this._target=e}swap(e){return this._target=e,this._subscription&&this._target.onSubscribe&&this._target.onSubscribe(this._subscription),this}onComplete(){(0,n.default)(this._target,\"must have target\"),this._target.onComplete&&this._target.onComplete()}onError(e){(0,n.default)(this._target,\"must have target\"),this._target.onError&&this._target.onError(e)}onNext(e){(0,n.default)(this._target,\"must have target\"),this._target.onNext&&this._target.onNext(e)}onSubscribe(e){(0,n.default)(this._target,\"must have target\"),this._subscription=e,this._target.onSubscribe&&this._target.onSubscribe(e)}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(2),s=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1),o=r(17),a=r(11);t.default=class{constructor(e,t,r){(0,s.default)(0<=t.bufferSize,\"RSocketResumableTransport: bufferSize option must be >= 0, got `%s`.\",t.bufferSize),this._encoders=r,this._bufferSize=t.bufferSize,this._sentFramesSize=0,this._position={client:0,server:0},this._currentConnection=null,this._statusSubscription=null,this._receiveSubscription=null,this._receivers=new Set,this._resumeToken=t.resumeToken,this._sessionTimeoutMillis=1e3*t.sessionDurationSeconds,this._sessionTimeoutHandle=null,this._senders=new Set,this._sentFrames=[],this._setupFrame=null,this._source=e,this._status=o.CONNECTION_STATUS.NOT_CONNECTED,this._statusSubscribers=new Set}close(){this._close()}connect(){(0,s.default)(!this._isTerminated(),\"RSocketResumableTransport: Cannot connect(), connection terminated (%s: %s).\",this._status.kind,\"ERROR\"===this._status.kind?this._status.error.message:\"no message\");try{this._disconnect(),this._currentConnection=null,this._receiveSubscription=null,this._statusSubscription=null,this._setConnectionStatus(o.CONNECTION_STATUS.CONNECTING);const e=this._source();e.connectionStatus().subscribe({onNext:t=>{t.kind===this._status.kind||(\"CONNECTED\"===t.kind?(this._sessionTimeoutHandle&&(clearTimeout(this._sessionTimeoutHandle),this._sessionTimeoutHandle=null),null==this._setupFrame?this._handleConnected(e):this._handleResume(e)):this._isTerminationStatus(t)&&(!this._sessionTimeoutHandle&&(this._sessionTimeoutHandle=setTimeout(()=>this._close(this._resumeTimeoutError()),this._sessionTimeoutMillis)),this._disconnect(),this._setConnectionStatus(o.CONNECTION_STATUS.NOT_CONNECTED)))},onSubscribe:e=>{this._statusSubscription=e,e.request(Number.MAX_SAFE_INTEGER)}}),e.connect()}catch(e){this._close(e)}}connectionStatus(){return new n.Flowable(e=>{e.onSubscribe({cancel:()=>{this._statusSubscribers.delete(e)},request:()=>{this._statusSubscribers.add(e),e.onNext(this._status)}})})}receive(){return new n.Flowable(e=>{let t=!1;e.onSubscribe({cancel:()=>{this._receivers.delete(e)},request:()=>{t||(t=!0,this._receivers.add(e))}})})}sendOne(e){try{this._writeFrame(e)}catch(e){this._close(e)}}send(e){let t;e.subscribe({onComplete:()=>{t&&this._senders.delete(t)},onError:e=>{t&&this._senders.delete(t),this._close(e)},onNext:e=>this._writeFrame(e),onSubscribe:e=>{t=e,this._senders.add(t),t.request(Number.MAX_SAFE_INTEGER)}})}_close(e){if(!this._isTerminated()){e?this._setConnectionStatus({error:e,kind:\"ERROR\"}):this._setConnectionStatus(o.CONNECTION_STATUS.CLOSED);const t=this._receivers;t.forEach(e=>e.onComplete()),t.clear();const r=this._senders;r.forEach(e=>e.cancel()),r.clear(),this._sentFrames.length=0,this._disconnect()}}_disconnect(){this._statusSubscription&&(this._statusSubscription.cancel(),this._statusSubscription=null),this._receiveSubscription&&(this._receiveSubscription.cancel(),this._receiveSubscription=null),this._currentConnection&&(this._currentConnection.close(),this._currentConnection=null)}_handleConnected(e){this._currentConnection=e,this._flushFrames(),this._setConnectionStatus(o.CONNECTION_STATUS.CONNECTED),e.receive().subscribe({onNext:e=>{try{this._receiveFrame(e)}catch(e){this._close(e)}},onSubscribe:e=>{this._receiveSubscription=e,e.request(Number.MAX_SAFE_INTEGER)}})}_handleResume(e){e.receive().take(1).subscribe({onNext:t=>{try{if(t.type===i.FRAME_TYPES.RESUME_OK){const{clientPosition:r}=t;if(r<this._position.client)return void this._close(this._nonResumableStateError());let n=r-this._position.client,s=0;for(;0<n;){const e=this._onReleasedTailFrame(this._sentFrames[s]);if(!e)return void this._close(this._absentLengthError(t));n-=e,s++}if(0!==n)return void this._close(this._inconsistentImpliedPositionError());0<s&&this._sentFrames.splice(0,s),this._handleConnected(e)}else{const e=t.type===i.FRAME_TYPES.ERROR?(0,i.createErrorFromFrame)(t):new Error(\"RSocketResumableTransport: Resumption failed for an unspecified reason.\");this._close(e)}}catch(e){this._close(e)}},onSubscribe:e=>{this._receiveSubscription=e,e.request(1)}});const t=this._setupFrame;(0,s.default)(t,\"RSocketResumableTransport: Cannot resume, setup frame has not been sent.\"),e.sendOne({clientPosition:this._position.client,flags:0,majorVersion:t.majorVersion,minorVersion:t.minorVersion,resumeToken:this._resumeToken,serverPosition:this._position.server,streamId:i.CONNECTION_STREAM_ID,type:i.FRAME_TYPES.RESUME})}_absentLengthError(e){return new Error(\"RSocketResumableTransport: absent frame.length for type \"+e.type)}_inconsistentImpliedPositionError(){return new Error(\"RSocketResumableTransport: local frames are inconsistent with remote implied position\")}_nonResumableStateError(){return new Error(\"RSocketResumableTransport: resumption failed, server is missing frames that are no longer in the client buffer.\")}_resumeTimeoutError(){return new Error(\"RSocketResumableTransport: resumable session timed out\")}_isTerminated(){return this._isTerminationStatus(this._status)}_isTerminationStatus(e){const t=e.kind;return\"CLOSED\"===t||\"ERROR\"===t}_setConnectionStatus(e){e.kind===this._status.kind||(this._status=e,this._statusSubscribers.forEach(t=>t.onNext(e)))}_receiveFrame(e){(0,i.isResumePositionFrameType)(e.type)&&(this._position.server+=e.length),this._receivers.forEach(t=>t.onNext(e))}_flushFrames(){this._sentFrames.forEach(e=>{const t=this._currentConnection;t&&t.sendOne(e)})}_onReleasedTailFrame(e){const t=e.length;if(t)return this._sentFramesSize-=t,this._position.client+=t,t}_writeFrame(e){if(e.type===i.FRAME_TYPES.SETUP&&(e=Object.assign({},e,{flags:e.flags|i.FLAGS.RESUME_ENABLE,resumeToken:this._resumeToken}),this._setupFrame=e),e.length=(0,a.sizeOfFrame)(e,this._encoders),(0,i.isResumePositionFrameType)(e.type)){let t=this._bufferSize-this._sentFramesSize;const r=e.length;if(!r)return void this._close(this._absentLengthError(e));for(;t<r;){const r=this._sentFrames.shift();if(!r)break;{const n=this._onReleasedTailFrame(r);if(!n)return void this._close(this._absentLengthError(e));t+=n}}t>=r?(this._sentFrames.push(e),this._sentFramesSize+=r):this._position.client+=r}const t=this._currentConnection;t&&t.sendOne(e)}}},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.CONNECTION_STATUS={CLOSED:Object.freeze({kind:\"CLOSED\"}),CONNECTED:Object.freeze({kind:\"CONNECTED\"}),CONNECTING:Object.freeze({kind:\"CONNECTING\"}),NOT_CONNECTED:Object.freeze({kind:\"NOT_CONNECTED\"})}},function(){},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(40));t.default=n.default},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var s=n(r(41)),i=n(r(42)),o=n(r(0)),a=r(2),u=n(r(43)),c=r(10),l=r(17);t.default=class{constructor(e,t,r){f.call(this),this._emitter=new s.default,this._encoders=t,this._options=e,r&&(this._factory=r)}start(){return new a.Flowable(e=>{let t;const r=()=>{t&&t.stop(),e.onComplete()},n=t=>e.onError(t),s=t=>{e.onNext(new h(t,this._encoders))};e.onSubscribe({cancel:()=>{t&&(t.removeListener(\"connection\",s),t.removeListener(\"error\",n),this._emitter.removeListener(\"close\",r),t.close(),t=null)},request:()=>{t||((t=this._factory(this._options)).on(\"connection\",s),t.on(\"error\",n),this._emitter.on(\"close\",r))}})})}stop(){this._emitter.emit(\"close\")}};var f=function(){this._factory=(e=>new i.default.Server(e))};class h{constructor(e,t){this._active=!0,this._close=new u.default,this._encoders=t,this._socket=e,this._statusSubscribers=new Set,this._status=e?l.CONNECTION_STATUS.CONNECTED:l.CONNECTION_STATUS.NOT_CONNECTED;let r=!1;this._receiver=new a.Flowable(e=>{(0,o.default)(!r,\"RSocketWebSocketServer: Multicast receive() is not supported. Be sure to receive/subscribe only once.\"),r=!0;let t=!1;const n=()=>{t&&(this._socket.removeListener(\"close\",s),this._socket.removeListener(\"error\",i),this._socket.removeListener(\"message\",a),this._socket.close())},s=()=>{n(),e.onError(new Error(\"RSocketWebSocketServer: Socket closed unexpectedly.\")),this._setConnectionStatus(l.CONNECTION_STATUS.CLOSED)},i=t=>{n(),e.onError(t);const r=t?{error:t,kind:\"ERROR\"}:l.CONNECTION_STATUS.CLOSED;this._setConnectionStatus(r)},a=t=>{try{const r=this._readFrame(t);e.onNext(r)}catch(t){n(),e.onError(t)}};e.onSubscribe({cancel:n,request:()=>{t||(t=!0,this._socket.on(\"close\",s),this._socket.on(\"error\",i),this._socket.on(\"message\",a))}})})}connect(){throw new Error(\"not supported\")}connectionStatus(){return new a.Flowable(e=>{e.onSubscribe({cancel:()=>{this._statusSubscribers.delete(e)},request:()=>{this._statusSubscribers.add(e),e.onNext(this._status)}})})}receive(){return this._receiver}sendOne(e){this._writeFrame(e)}send(e){e.subscribe({onError:e=>this._handleError(e),onNext:e=>this._writeFrame(e),onSubscribe(e){e.request(Number.MAX_SAFE_INTEGER)}})}close(){this._socket.emit(\"close\"),this._socket.close()}_readFrame(e){return(0,c.deserializeFrame)(e,this._encoders)}_writeFrame(e){try{const t=(0,c.serializeFrame)(e,this._encoders);this._socket.send(t)}catch(e){this._handleError(e)}}_handleError(e){this._socket.emit(\"error\",e)}_setConnectionStatus(e){this._status=e,this._statusSubscribers.forEach(t=>t.onNext(e))}}},function(e){\"use strict\";function t(){t.init.call(this)}function r(e){return void 0===e._maxListeners?t.defaultMaxListeners:e._maxListeners}function n(e,t,n,s){var i,o,a;if(\"function\"!=typeof n)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof n);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit(\"newListener\",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if(\"function\"==typeof a?a=o[t]=s?[n,a]:[a,n]:s?a.unshift(n):a.push(n),0<(i=r(e))&&a.length>i&&!a.warned){a.warned=!0;var u=new Error(\"Possible EventEmitter memory leak detected. \"+a.length+\" \"+t+\" listeners added. Use emitter.setMaxListeners() to increase limit\");u.name=\"MaxListenersExceededWarning\",u.emitter=e,u.type=t,u.count=a.length,function(e){console&&console.warn&&console.warn(e)}(u)}return e}function s(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,l(this.listener,this.target,e))}.bind(n);return s.listener=r,n.wrapFn=s,s}function i(e,t,r){var n=e._events;if(void 0===n)return[];var s=n[t];return void 0===s?[]:\"function\"==typeof s?r?[s.listener||s]:[s]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(s):a(s,s.length)}function o(e){var t=this._events;if(void 0!==t){var r=t[e];if(\"function\"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function a(e,t){for(var r=Array(t),n=0;n<t;++n)r[n]=e[n];return r}var u,c=\"object\"==typeof Reflect?Reflect:null,l=c&&\"function\"==typeof c.apply?c.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};u=c&&\"function\"==typeof c.ownKeys?c.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var f=Number.isNaN||function(e){return e!=e};e.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._eventsCount=0,t.prototype._maxListeners=void 0;var h=10;Object.defineProperty(t,\"defaultMaxListeners\",{enumerable:!0,get:function(){return h},set:function(e){if(\"number\"!=typeof e||0>e||f(e))throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received '+e+\".\");h=e}}),t.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},t.prototype.setMaxListeners=function(e){if(\"number\"!=typeof e||0>e||f(e))throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received '+e+\".\");return this._maxListeners=e,this},t.prototype.getMaxListeners=function(){return r(this)},t.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n=\"error\"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var i;if(0<t.length&&(i=t[0]),i instanceof Error)throw i;var o=new Error(\"Unhandled error.\"+(i?\" (\"+i.message+\")\":\"\"));throw o.context=i,o}var u=s[e];if(void 0===u)return!1;if(\"function\"==typeof u)l(u,this,t);else{var c=u.length,f=a(u,c);for(r=0;r<c;++r)l(f[r],this,t)}return!0},t.prototype.addListener=function(e,t){return n(this,e,t,!1)},t.prototype.on=t.prototype.addListener,t.prototype.prependListener=function(e,t){return n(this,e,t,!0)},t.prototype.once=function(e,t){if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);return this.on(e,s(this,e,t)),this},t.prototype.prependOnceListener=function(e,t){if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,s(this,e,t)),this},t.prototype.removeListener=function(e,t){var r,n,s,i,o;if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit(\"removeListener\",e,r.listener||t));else if(\"function\"!=typeof r){for(s=-1,i=r.length-1;0<=i;i--)if(r[i]===t||r[i].listener===t){o=r[i].listener,s=i;break}if(0>s)return this;0===s?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,s),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit(\"removeListener\",e,o||t)}return this},t.prototype.off=t.prototype.removeListener,t.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var s,i=Object.keys(r);for(n=0;n<i.length;++n)\"removeListener\"===(s=i[n])||this.removeAllListeners(s);return this.removeAllListeners(\"removeListener\"),this._events=Object.create(null),this._eventsCount=0,this}if(\"function\"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;0<=n;n--)this.removeListener(e,t[n]);return this},t.prototype.listeners=function(e){return i(this,e,!0)},t.prototype.rawListeners=function(e){return i(this,e,!1)},t.listenerCount=function(e,t){return\"function\"==typeof e.listenerCount?e.listenerCount(t):o.call(e,t)},t.prototype.listenerCount=o,t.prototype.eventNames=function(){return 0<this._eventsCount?u(this._events):[]}},function(e){\"use strict\";e.exports=function(){throw new Error(\"ws does not work in the browser. Browser clients must use the native WebSocket object\")}},function(e,t,r){\"use strict\";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=r(44),i=function(){function e(){var e=this;n(this,\"_settled\",void 0),n(this,\"_promise\",void 0),n(this,\"_resolve\",void 0),n(this,\"_reject\",void 0),this._settled=!1,this._promise=new s(function(t,r){e._resolve=t,e._reject=r})}var t=e.prototype;return t.getPromise=function(){return this._promise},t.resolve=function(e){this._settled=!0,this._resolve(e)},t.reject=function(e){this._settled=!0,this._reject(e)},t.catch=function(){return s.prototype.catch.apply(this._promise,arguments)},t.then=function(){return s.prototype.then.apply(this._promise,arguments)},t.done=function(){(arguments.length?this._promise.then.apply(this._promise,arguments):this._promise).then(void 0,function(e){setTimeout(function(){throw e},0)})},t.isSettled=function(){return this._settled},e}();e.exports=i},function(e,t,r){\"use strict\";e.exports=r(45)},function(e,t,r){\"use strict\";e.exports=r(46)},function(e,t,r){\"use strict\";e.exports=r(3),r(47),r(48),r(49),r(50),r(52)},function(e,t,r){\"use strict\";var n=r(3);e.exports=n,n.prototype.done=function(){(arguments.length?this.then.apply(this,arguments):this).then(null,function(e){setTimeout(function(){throw e},0)})}},function(e,t,r){\"use strict\";var n=r(3);e.exports=n,n.prototype.finally=function(e){return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})})}},function(e,t,r){\"use strict\";function n(e){var t=new s(s._61);return t._65=1,t._55=e,t}var s=r(3);e.exports=s;var i=n(!0),o=n(!1),a=n(null),u=n(void 0),c=n(0),l=n(\"\");s.resolve=function(e){if(e instanceof s)return e;if(null===e)return a;if(void 0===e)return u;if(!0===e)return i;if(!1===e)return o;if(0===e)return c;if(\"\"===e)return l;if(\"object\"==typeof e||\"function\"==typeof e)try{var t=e.then;if(\"function\"==typeof t)return new s(t.bind(e))}catch(e){return new s(function(t,r){r(e)})}return n(e)},s.all=function(e){var t=Array.prototype.slice.call(e);return new s(function(e,r){function n(o,a){if(a&&(\"object\"==typeof a||\"function\"==typeof a)){if(a instanceof s&&a.then===s.prototype.then){for(;3===a._65;)a=a._55;return 1===a._65?n(o,a._55):(2===a._65&&r(a._55),void a.then(function(e){n(o,e)},r))}var u=a.then;if(\"function\"==typeof u)return void new s(u.bind(a)).then(function(e){n(o,e)},r)}t[o]=a,0==--i&&e(t)}if(0===t.length)return e([]);for(var i=t.length,o=0;o<t.length;o++)n(o,t[o])})},s.reject=function(e){return new s(function(t,r){r(e)})},s.race=function(e){return new s(function(t,r){e.forEach(function(e){s.resolve(e).then(t,r)})})},s.prototype.catch=function(e){return this.then(null,e)}},function(e,t,r){\"use strict\";var n=r(3),s=r(51);e.exports=n,n.denodeify=function(e,t){return\"number\"==typeof t&&t!==1/0?function(e,t){for(var r=[],s=0;s<t;s++)r.push(\"a\"+s);var o=[\"return function (\"+r.join(\",\")+\") {\",\"var self = this;\",\"return new Promise(function (rs, rj) {\",\"var res = fn.call(\",[\"self\"].concat(r).concat([i]).join(\",\"),\");\",\"if (res &&\",'(typeof res === \"object\" || typeof res === \"function\") &&','typeof res.then === \"function\"',\") {rs(res);}\",\"});\",\"};\"].join(\"\");return Function([\"Promise\",\"fn\"],o)(n,e)}(e,t):function(e){for(var t=Math.max(e.length-1,3),r=[],s=0;s<t;s++)r.push(\"a\"+s);var o=[\"return function (\"+r.join(\",\")+\") {\",\"var self = this;\",\"var args;\",\"var argLength = arguments.length;\",\"if (arguments.length > \"+t+\") {\",\"args = new Array(arguments.length + 1);\",\"for (var i = 0; i < arguments.length; i++) {\",\"args[i] = arguments[i];\",\"}\",\"}\",\"return new Promise(function (rs, rj) {\",\"var cb = \"+i+\";\",\"var res;\",\"switch (argLength) {\",r.concat([\"extra\"]).map(function(e,t){return\"case \"+t+\":res = fn.call(\"+[\"self\"].concat(r.slice(0,t)).concat(\"cb\").join(\",\")+\");break;\"}).join(\"\"),\"default:\",\"args[argLength] = cb;\",\"res = fn.apply(self, args);\",\"}\",\"if (res &&\",'(typeof res === \"object\" || typeof res === \"function\") &&','typeof res.then === \"function\"',\") {rs(res);}\",\"});\",\"};\"].join(\"\");return Function([\"Promise\",\"fn\"],o)(n,e)}(e)};var i=\"function (err, res) {if (err) { rj(err); } else { rs(res); }}\";n.nodeify=function(e){return function(){var t=Array.prototype.slice.call(arguments),r=\"function\"==typeof t[t.length-1]?t.pop():null,i=this;try{return e.apply(this,arguments).nodeify(r,i)}catch(e){if(null==r)return new n(function(t,r){r(e)});s(function(){r.call(i,e)})}}},n.prototype.nodeify=function(e,t){return\"function\"==typeof e?void this.then(function(r){s(function(){e.call(t,null,r)})},function(r){s(function(){e.call(t,r)})}):this}},function(e,t,r){\"use strict\";function n(e){var t;(t=o.length?o.pop():new s).task=e,i(t)}function s(){this.task=null}var i=r(18),o=[],a=[],u=i.makeRequestCallFromTimer(function(){if(a.length)throw a.shift()});e.exports=n,s.prototype.call=function(){try{this.task.call()}catch(e){n.onerror?n.onerror(e):(a.push(e),u())}finally{this.task=null,o[o.length]=this}}},function(e,t,r){\"use strict\";var n=r(3);e.exports=n,n.enableSynchronous=function(){n.prototype.isPending=function(){return 0==this.getState()},n.prototype.isFulfilled=function(){return 1==this.getState()},n.prototype.isRejected=function(){return 2==this.getState()},n.prototype.getValue=function(){if(3===this._65)return this._55.getValue();if(!this.isFulfilled())throw new Error(\"Cannot get a value of an unfulfilled promise.\");return this._55},n.prototype.getReason=function(){if(3===this._65)return this._55.getReason();if(!this.isRejected())throw new Error(\"Cannot get a rejection reason of a non-rejected promise.\");return this._55},n.prototype.getState=function(){return 3===this._65?this._55.getState():-1===this._65||-2===this._65?0:this._65}},n.disableSynchronous=function(){n.prototype.isPending=void 0,n.prototype.isFulfilled=void 0,n.prototype.isRejected=void 0,n.prototype.getValue=void 0,n.prototype.getReason=void 0,n.prototype.getState=void 0}},function(e,t,r){\"use strict\";function n(e){if(e.data&&e.data.detail&&e.data.type){const t=e.data.detail;if(!e.data.workerId)if(e.data.workerId=1,\"ConnectWorkerEvent\"===e.data.type)t.whoAmI&&(Q[t.whoAmI]=this);else{const r=Q[t.to]||Q[t.address];r?r.postMessage(e.data,e.ports):postMessage(e.data,\"*\",e.ports)}}}function s(){ne.MessagePort=te,ne.MessageChannel=re}r.r(t);var i={};r.r(i),r.d(i,\"assert\",function(){return a}),r.d(i,\"isDefined\",function(){return u}),r.d(i,\"assertDefined\",function(){return c}),r.d(i,\"isString\",function(){return l}),r.d(i,\"assertString\",function(){return f}),r.d(i,\"assertNonEmptyString\",function(){return h}),r.d(i,\"isArray\",function(){return d}),r.d(i,\"isNonEmptyArray\",function(){return E}),r.d(i,\"assertArray\",function(){return _}),r.d(i,\"asserNotEmptytArray\",function(){return p}),r.d(i,\"isObject\",function(){return m}),r.d(i,\"assertObject\",function(){return b}),r.d(i,\"assertNonEmptyObject\",function(){return S}),r.d(i,\"isOneOf\",function(){return g}),r.d(i,\"assertOneOf\",function(){return y}),r.d(i,\"isFunction\",function(){return R}),r.d(i,\"isFunctionConstructor\",function(){return v}),r.d(i,\"assertFunction\",function(){return T}),r.d(i,\"assertClass\",function(){return A}),r.d(i,\"isNumber\",function(){return w}),r.d(i,\"assertNumber\",function(){return M});var o={};r.r(o),r.d(o,\"NOT_VALID_PROTOCOL\",function(){return O}),r.d(o,\"NOT_VALID_ADDRESS\",function(){return N}),r.d(o,\"NOT_VALID_HOST\",function(){return P}),r.d(o,\"NOT_VALID_PATH\",function(){return F}),r.d(o,\"NOT_VALID_PORT\",function(){return I}),r.d(o,\"ASYNC_MODEL_TYPES\",function(){return L}),r.d(o,\"SERVICE_NAME_NOT_PROVIDED\",function(){return C}),r.d(o,\"DEFINITION_MISSING_METHODS\",function(){return U}),r.d(o,\"INVALID_METHODS\",function(){return B}),r.d(o,\"getServiceNameInvalid\",function(){return k}),r.d(o,\"getIncorrectMethodValueError\",function(){return x}),r.d(o,\"getAsynModelNotProvidedError\",function(){return Y}),r.d(o,\"getInvalidAsyncModelError\",function(){return j});const a=(e,t)=>{if(!e)throw new Error(t)},u=e=>void 0!==e,c=(e,t=\"Expect to be defined\")=>{a(u(e),t)},l=e=>\"string\"==typeof e||e instanceof String,f=(e,t=\"Expected to be a string\")=>{a(u(e)&&l(e),t)},h=(e,t=\"Expected to be non empty string\")=>{f(e,t),a(0<e.length,t)},d=e=>Array.isArray(e),E=e=>d(e)&&0<e.length,_=(e,t=\"Expected to be an array\")=>{a(d(e),t)},p=(e,t=\"Expected to be an array\")=>{a(E(e),t)},m=e=>\"[object Object]\"===Object.prototype.toString.call(e),b=(e,t=\"Expected to be an object\")=>{a(m(e),t)},S=(e,t=\"Expected to be non empty object\")=>{b(e,t),a(0<Object.keys(e).length,t)},g=(e,t)=>d(e)?e.includes(t):!!m(e)&&Object.values(e).includes(t),y=(e,t,r=\"Expected to be one of the collection elements\")=>{a(g(e,t),r)},R=e=>\"function\"==typeof e&&!/^class\\s/.test(Function.prototype.toString.call(e)),v=e=>\"function\"==typeof e&&/^class\\s/.test(Function.prototype.toString.call(e)),T=(e,t=\"Expected to be a function\")=>{a(R(e),t)},A=(e,t=\"Expected to be a class\")=>{a(v(e),t)},w=e=>\"number\"==typeof e&&!isNaN(e),M=(e,t=\"Expected to be a number\")=>{a(w(e),t)},O=\"Not a valid protocol\",N=\"Address must be of type object\",P=\"Not a valid host\",F=\"Not a valid path\",I=\"Not a valid port\",L={REQUEST_RESPONSE:\"requestResponse\",REQUEST_STREAM:\"requestStream\"},C=\"MS0020 - Invalid format, definition must contain valid serviceName\",U=\"MS0021 - Invalid format, definition must contain valid methods\",B=\"MS0022 - Invalid format, definition must contain valid methods\",k=e=>`MS0023 - Invalid format, serviceName must be not empty string but received type ${typeof e}`,x=e=>`Method value for ${e} definition should be non empty object`,Y=e=>`Async model is not provided in service definition for ${e}`,j=e=>`Invalid async model in service definition for ${e}`,q=(e,t=!0)=>{if(t&&void 0===e)return!0;S(e,N);const{host:r,path:n,protocol:s}=e;let{port:i}=e;return i=l(i)?+i:i,f(r,P),f(n,F),M(i,I),f(s,O),a(g([\"pm\",\"ws\",\"wss\",\"tcp\"],s),O),!0},D=e=>{q(e,!1);const{host:t,path:r,port:n,protocol:s}=e;return`${s}://${t}:${n}/${r}`},z=e=>{const t={};return e=X({key:\"protocol\",optionalValue:\"pm\",delimiter:\"://\",str:e,newAddress:t}),e=X({key:\"host\",optionalValue:\"defaultHost\",delimiter:\":\",str:e,newAddress:t}),e=X({key:\"port\",optionalValue:8080,delimiter:\"/\",str:e,newAddress:t}),t.path=e,t},X=({key:e,optionalValue:t,delimiter:r,newAddress:n,str:s})=>{let[i,o]=s.split(r);return o||(o=i,i=t),n[e]=i,o},G=()=>{try{return!navigator}catch(e){return!1}},Q={},H={},V=[],K={},W=(e,t,r,n,s=\"log\")=>{if(K[e]||(K[e]=(()=>{let e=\"#\";for(let t=0;6>t;t++)e+=\"0123456789ABCDEF\"[Math.floor(16*Math.random())];return e})()),n){const n=`color:${K[e]}`;r&&console[s](`%c******** address: ${e}********`,n),console[s](t),r&&Object.keys(r).forEach(e=>{Array.isArray(r[e])?Object.values(r[e]).forEach(t=>{console[s](`${e}: ${JSON.stringify(t.qualifier||t,null,2)}`)}):console[s](`${e}: ${JSON.stringify(r[e],null,2)}`)})}},J=({serviceName:e,methodName:t})=>`${e}/${t}`,$=e=>{S(e);const{serviceName:t,methods:r}=e;c(t,C),h(t,k(t)),c(r,U),S(r,B),Object.keys(r).forEach(e=>{h(e);const n=J({serviceName:t,methodName:e});Z(n,r[e])})},Z=(e,t)=>{S(t,x(e));const{asyncModel:r}=t;c(r,Y(e)),y(L,r,j(e))};var ee=r(20);class te{constructor(e){this.onmessage=null,this.onmessageerror=null,this.otherPort=null,this.onmessageListeners=[],this.queue=[],this.otherSideStart=!1,this.whoami=e}dispatchEvent(e){return this.onmessage&&this.onmessage(e),this.onmessageListeners.forEach(t=>t(e)),!0}postMessage(e,t){const r={ports:t,data:e};this.otherPort&&(this.otherSideStart?this.otherPort.dispatchEvent(r):this.queue.push(r))}addEventListener(e,t){\"message\"!==e||\"function\"!=typeof t||-1!==this.onmessageListeners.indexOf(t)||this.onmessageListeners.push(t)}removeEventListener(e,t){if(\"message\"===e){const e=this.onmessageListeners.indexOf(t);-1===e||this.onmessageListeners.splice(e,1)}}start(){setTimeout(()=>this.otherPort&&this.otherPort.startSending.apply(this.otherPort,[]),0)}close(){setTimeout(()=>this.otherPort&&this.otherPort.stopSending.apply(this.otherPort,[]),0)}startSending(){this.otherSideStart=!0,this.queue.forEach(e=>this.otherPort&&this.otherPort.dispatchEvent(e))}stopSending(){this.otherSideStart=!1,this.queue.length=0}}class re{constructor(){this.port1=new te(\"client\"),this.port2=new te(\"server\"),this.port1.otherPort=this.port2,this.port2.otherPort=this.port1}}const ne=\"undefined\"!=typeof window&&window.Math===Math?window:\"undefined\"!=typeof self&&self.Math===Math?self:Function(\"return this\")();ne.MessagePort&&ne.MessageChannel||s(),r.d(t,\"workers\",function(){return se}),r.d(t,\"mockMessageChannel\",function(){return ie}),r.d(t,\"check\",function(){return i}),r.d(t,\"getFullAddress\",function(){return D}),r.d(t,\"validateAddress\",function(){return q}),r.d(t,\"constants\",function(){return o}),r.d(t,\"getAddress\",function(){return z}),r.d(t,\"saveToLogs\",function(){return W}),r.d(t,\"isNodejs\",function(){return G}),r.d(t,\"validateServiceDefinition\",function(){return $}),r.d(t,\"getQualifier\",function(){return J});const se=G()?{}:{addWorker:e=>{e.addEventListener(\"message\",n.bind(e))},removeWorker:e=>{e.removeEventListener(\"message\",n.bind(e))},initialize:()=>{G()||(\"undefined\"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?console.warn(\"Don't use this on webworkers, only on the main thread\"):addEventListener(\"message\",e=>{if(e&&e.data&&!e.data.workerId){\"ConnectIframe\"===e.data.type&&(e=>{V.some(t=>(e.source===t.contentWindow&&(H[e.data.detail.whoAmI||e.data.detail.origin]=t),e.source===t.contentWindow))})(e);const t=e.data.detail;if(t){e.data.workerId=1;const r=Q[t.to]||Q[t.address];r&&r.postMessage(e.data,e.ports);const n=H[t.to]||H[t.address];n&&n.contentWindow.postMessage(e.data,\"*\",e.ports)}}}))},addIframe:e=>{V.push(e)}},ie=()=>{Object(ee.a)(),s()}}]);","extractedComments":[]}