{"code":"!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var i in e)t.d(n,i,function(t){return e[t]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=19)}([function(e){\"use strict\";e.exports=function(e,t){for(var r=arguments.length,n=Array(2<r?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(function(e){if(void 0===e)throw new Error(\"invariant(...): Second argument must be a string.\")}(t),!e){var o;if(void 0===t)o=new Error(\"Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.\");else{var s=0;(o=new Error(t.replace(/%s/g,function(){return n[s++]+\"\"}))).name=\"Invariant Violation\"}throw o.framesToPop=1,o}}},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){const t=l[e];return null==t?s(e):t}function o(e){const t=d[e];return null==t?768>=e?\"RESERVED (PROTOCOL)\":\"RESERVED (APPLICATION)\":t}function s(e){return\"0x\"+e.toString(16)}Object.defineProperty(t,\"__esModule\",{value:!0}),t.MAX_VERSION=t.MAX_TTL=t.MAX_STREAM_ID=t.MAX_RESUME_LENGTH=t.MAX_REQUEST_N=t.MAX_REQUEST_COUNT=t.MAX_MIME_LENGTH=t.MAX_METADATA_LENGTH=t.MAX_LIFETIME=t.MAX_KEEPALIVE=t.MAX_CODE=t.FRAME_TYPE_OFFFSET=t.FLAGS_MASK=t.ERROR_EXPLANATIONS=t.ERROR_CODES=t.FLAGS=t.FRAME_TYPE_NAMES=t.FRAME_TYPES=t.CONNECTION_STREAM_ID=void 0,t.isIgnore=function(e){return(e&h.IGNORE)===h.IGNORE},t.isMetadata=function(e){return(e&h.METADATA)===h.METADATA},t.isComplete=function(e){return(e&h.COMPLETE)===h.COMPLETE},t.isNext=function(e){return(e&h.NEXT)===h.NEXT},t.isRespond=function(e){return(e&h.RESPOND)===h.RESPOND},t.isResumeEnable=function(e){return(e&h.RESUME_ENABLE)===h.RESUME_ENABLE},t.isLease=function(e){return(e&h.LEASE)===h.LEASE},t.isResumePositionFrameType=function(e){return e===c.CANCEL||e===c.ERROR||e===c.PAYLOAD||e===c.REQUEST_CHANNEL||e===c.REQUEST_FNF||e===c.REQUEST_RESPONSE||e===c.REQUEST_STREAM||e===c.REQUEST_N},t.getFrameTypeName=i,t.createErrorFromFrame=function(e){const{code:t,message:r}=e,n=o(t),i=new Error((0,a.default)(\"RSocket error %s (%s): %s. See error `source` property for details.\",s(t),n,r));return i.source={code:t,explanation:n,message:r},i},t.getErrorCodeExplanation=o,t.printFrame=function(e){const t=Object.assign({},e);t.type=i(e.type)+` (${s(e.type)})`;const r=[];return(0,u.default)(h,(t,n)=>{(e.flags&t)===t&&r.push(n)}),r.length||r.push(\"NO FLAGS\"),t.flags=r.join(\" | \")+` (${s(e.flags)})`,e.type===c.ERROR&&(t.code=o(e.code)+` (${s(e.code)})`),JSON.stringify(t,null,2)};var u=n(r(27)),a=n(r(28));t.CONNECTION_STREAM_ID=0;const c=t.FRAME_TYPES={CANCEL:9,ERROR:11,EXT:63,KEEPALIVE:3,LEASE:2,METADATA_PUSH:12,PAYLOAD:10,REQUEST_CHANNEL:7,REQUEST_FNF:5,REQUEST_N:8,REQUEST_RESPONSE:4,REQUEST_STREAM:6,RESERVED:0,RESUME:13,RESUME_OK:14,SETUP:1},l=t.FRAME_TYPE_NAMES={};(0,u.default)(c,(e,t)=>{l[e]=t});const h=t.FLAGS={COMPLETE:64,FOLLOWS:128,IGNORE:512,LEASE:64,METADATA:256,NEXT:32,RESPOND:128,RESUME_ENABLE:128},f=t.ERROR_CODES={APPLICATION_ERROR:513,CANCELED:515,CONNECTION_CLOSE:258,CONNECTION_ERROR:257,INVALID:516,INVALID_SETUP:1,REJECTED:514,REJECTED_RESUME:4,REJECTED_SETUP:3,RESERVED:0,RESERVED_EXTENSION:4294967295,UNSUPPORTED_SETUP:2},d=t.ERROR_EXPLANATIONS={};(0,u.default)(f,(e,t)=>{d[e]=t});t.FLAGS_MASK=1023,t.FRAME_TYPE_OFFFSET=10,t.MAX_CODE=2147483647,t.MAX_KEEPALIVE=2147483647,t.MAX_LIFETIME=2147483647,t.MAX_METADATA_LENGTH=16777215,t.MAX_MIME_LENGTH=255,t.MAX_REQUEST_COUNT=2147483647,t.MAX_REQUEST_N=2147483647,t.MAX_RESUME_LENGTH=65535,t.MAX_STREAM_ID=2147483647,t.MAX_TTL=2147483647,t.MAX_VERSION=65535},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.every=t.Single=t.FlowableProcessor=t.Flowable=void 0;var i=n(r(9)),o=n(r(24)),s=n(r(25)),u=r(26);t.Flowable=i.default,t.FlowableProcessor=s.default,t.Single=o.default,t.every=u.every},function(e,t,r){\"use strict\";var n=r(4);e.exports=n},function(e){\"use strict\";function t(e){return function(){return e}}var r=function(){};r.thatReturns=t,r.thatReturnsFalse=t(!1),r.thatReturnsTrue=t(!0),r.thatReturnsNull=t(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(e){return e},e.exports=r},function(e,t,r){\"use strict\";function n(e){if(!e)return\"Lease was not received yet\";if(e.valid())return\"Missing leases\";const t=e.expired(),r=e.allowedRequests;return`Missing leases. Expired: ${t.toString()}, allowedRequests: ${r}`}var i=Math.max;Object.defineProperty(t,\"__esModule\",{value:!0}),t.ResponderLeaseHandler=t.RequesterLeaseHandler=t.Leases=t.Lease=void 0;var o=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),s=r(2),u=r(1);class a{constructor(e,t,r){(0,o.default)(0<e,\"Lease time-to-live must be positive\"),(0,o.default)(0<t,\"Lease allowed requests must be positive\"),this.timeToLiveMillis=e,this.allowedRequests=t,this.startingAllowedRequests=t,this.expiry=Date.now()+e,this.metadata=r}expired(){return Date.now()>this.expiry}valid(){return 0<this.allowedRequests&&!this.expired()}_use(){if(this.expired())return!1;const e=this.allowedRequests,t=0<e;return t&&(this.allowedRequests=e-1),t}}t.Lease=a,t.Leases=class{constructor(){this._sender=(()=>s.Flowable.never()),this._receiver=(()=>{})}sender(e){return this._sender=e,this}receiver(e){return this._receiver=e,this}stats(e){return this._stats=e,this}},t.RequesterLeaseHandler=class{constructor(e){this._requestN=-1,e(new s.Flowable(e=>this._subscriber?void e.onError(new Error(\"only 1 subscriber is allowed\")):this.isDisposed()?void e.onComplete():(this._subscriber=e,void e.onSubscribe({cancel:()=>{this.dispose()},request:t=>{if(0>=t&&e.onError(new Error(`request demand must be positive: ${t}`)),!this.isDisposed()){const e=this._requestN;this._onRequestN(e),this._requestN=Math.min(Number.MAX_SAFE_INTEGER,i(0,e)+t)}}}))))}use(){const e=this._lease;return!!e&&e._use()}errorMessage(){return n(this._lease)}receive(e){if(!this.isDisposed()){const t=e.ttl,r=e.requestCount,n=e.metadata;this._onLease(new a(t,r,n))}}availability(){const e=this._lease;return e&&e.valid()?e.allowedRequests/e.startingAllowedRequests:0}dispose(){if(!this._isDisposed){this._isDisposed=!0;const e=this._subscriber;e&&e.onComplete()}}isDisposed(){return this._isDisposed}_onRequestN(e){const t=this._lease,r=this._subscriber;0>e&&t&&r&&r.onNext(t)}_onLease(e){const t=this._subscriber,r=this._requestN-1;0<=r&&t&&t.onNext(e),this._requestN=i(-1,r),this._lease=e}},t.ResponderLeaseHandler=class{constructor(e,t,r){this._leaseSender=e,this._stats=t,this._errorConsumer=r}use(){const e=this._lease,t=!!e&&e._use();return this._onStatsEvent(t),t}errorMessage(){return n(this._lease)}send(e){let t,r;return this._leaseSender(this._stats).subscribe({onComplete:()=>this._onStatsEvent(),onError:e=>{this._onStatsEvent();const t=this._errorConsumer;t&&t(e)},onNext:t=>{this._lease=t,e(t)},onSubscribe:e=>r?void e.cancel():(e.request(u.MAX_REQUEST_N),void(t=e))}),{dispose(){r||(r=!0,this._onStatsEvent(),t&&t.cancel())},isDisposed:()=>r}}_onStatsEvent(e){const t=this._stats;if(t){const r=void 0===e?\"Terminate\":e?\"Accept\":\"Reject\";t.onEvent(r)}}}},function(e){var t=function(){return this}();try{t=t||new Function(\"return this\")()}catch(e){\"object\"==typeof window&&(t=window)}e.exports=t},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.createBuffer=void 0,t.readUInt24BE=function(e,t){return e.readUInt8(t)<<16|e.readUInt8(t+1)<<8|e.readUInt8(t+2)},t.writeUInt24BE=function(e,t,r){return r=e.writeUInt8(t>>>16,r),r=e.writeUInt8(255&t>>>8,r),e.writeUInt8(255&t,r)},t.readUInt64BE=function(e,t){const r=e.readUInt32BE(t),n=e.readUInt32BE(t+4);return r*o+n},t.writeUInt64BE=function(e,t,r){return r=e.writeUInt32BE(0|t/o,r),e.writeUInt32BE(t%o,r)},t.byteLength=function(e,t){return null==e?0:n.LiteBuffer.byteLength(e,t)},t.toBuffer=function(e){return e instanceof n.LiteBuffer?e:((0,i.default)(e instanceof ArrayBuffer,\"RSocketBufferUtils: Cannot construct buffer. Expected data to be an arraybuffer, got `%s`.\",e),n.LiteBuffer.from(e))};var n=r(14),i=function(e){return e&&e.__esModule?e:{default:e}}(r(0));const o=4294967296;t.createBuffer=\"function\"==typeof n.LiteBuffer.alloc?e=>n.LiteBuffer.alloc(e):e=>new n.LiteBuffer(e).fill(0)},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.IdentitySerializers=t.IdentitySerializer=t.JsonSerializers=t.JsonSerializer=void 0;var n=r(14),i=function(e){return e&&e.__esModule?e:{default:e}}(r(0));const o=t.JsonSerializer={deserialize:e=>{let t;if(null==e)return null;if(\"string\"==typeof e)t=e;else if(n.LiteBuffer.isBuffer(e))t=e.toString(\"utf8\");else{t=n.LiteBuffer.from(e).toString(\"utf8\")}return JSON.parse(t)},serialize:JSON.stringify},s=(t.JsonSerializers={data:o,metadata:o},t.IdentitySerializer={deserialize:e=>((0,i.default)(null==e||\"string\"==typeof e||n.LiteBuffer.isBuffer(e)||e instanceof Uint8Array,\"RSocketSerialization: Expected data to be a string, Buffer, or Uint8Array. Got `%s`.\",e),e),serialize:e=>e});t.IdentitySerializers={data:s,metadata:s}},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(r(22)),o=n(r(23)),s=n(r(0)),u=n(r(3)),a=n(r(4));class c{static just(...e){return new c(t=>{let r=!1,n=0;t.onSubscribe({cancel:()=>{r=!0},request:i=>{for(;!r&&0<i&&n<e.length;)t.onNext(e[n++]),i--;r||n!=e.length||t.onComplete()}})})}static error(e){return new c(t=>{t.onSubscribe({cancel:()=>{},request:()=>{t.onError(e)}})})}static never(){return new c(e=>{e.onSubscribe({cancel:a.default,request:a.default})})}constructor(e,t=Number.MAX_SAFE_INTEGER){this._max=t,this._source=e}subscribe(e){let t=\"function\"==typeof e?this._wrapCallback(e):e;const r=new l(t,this._max);this._source(r)}lift(e){return new c(t=>this._source(e(t)))}map(e){return this.lift(t=>new i.default(t,e))}take(e){return this.lift(t=>new o.default(t,e))}_wrapCallback(e){const t=this._max;return{onNext:e,onSubscribe(e){e.request(t)}}}}t.default=c;class l{constructor(e,t){this._cancel=(()=>{this._active&&(this._active=!1,this._subscription&&this._subscription.cancel())}),this._request=(e=>{(0,s.default)(Number.isInteger(e)&&1<=e&&e<=this._max,\"Flowable: Expected request value to be an integer with a value greater than 0 and less than or equal to %s, got `%s`.\",this._max,e),this._active&&(e===this._max?this._pending=this._max:(this._pending+=e,this._pending>=this._max&&(this._pending=this._max)),this._subscription&&this._subscription.request(e))}),this._active=!1,this._max=t,this._pending=0,this._started=!1,this._subscriber=e||{},this._subscription=null}onComplete(){if(this._active){this._active=!1,this._started=!0;try{this._subscriber.onComplete&&this._subscriber.onComplete()}catch(e){this._subscriber.onError&&this._subscriber.onError(e)}}else(0,u.default)(!1,\"Flowable: Invalid call to onComplete(): %s.\",this._started?\"onComplete/onError was already called\":\"onSubscribe has not been called\")}onError(e){return this._started&&!this._active?void(0,u.default)(!1,\"Flowable: Invalid call to onError(): %s.\",this._active?\"onComplete/onError was already called\":\"onSubscribe has not been called\"):(this._active=!1,this._started=!0,void(this._subscriber.onError&&this._subscriber.onError(e)))}onNext(e){if(this._active)if(0!==this._pending){this._pending!==this._max&&this._pending--;try{this._subscriber.onNext&&this._subscriber.onNext(e)}catch(e){this._subscription&&this._subscription.cancel(),this.onError(e)}}else(0,u.default)(!1,\"Flowable: Invalid call to onNext(), all request()ed values have been published.\");else(0,u.default)(!1,\"Flowable: Invalid call to onNext(): %s.\",this._active?\"onComplete/onError was already called\":\"onSubscribe has not been called\")}onSubscribe(e){if(this._started)(0,u.default)(!1,\"Flowable: Invalid call to onSubscribe(): already called.\");else{this._active=!0,this._started=!0,this._subscription=e;try{this._subscriber.onSubscribe&&this._subscriber.onSubscribe({cancel:this._cancel,request:this._request})}catch(e){this.onError(e)}}}}},function(e){\"use strict\";e.exports=function(e){if(null!=e)return e;throw new Error(\"Got unexpected null or undefined\")}},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.Lease=t.Leases=t.JsonSerializers=t.JsonSerializer=t.IdentitySerializers=t.IdentitySerializer=t.UTF8Encoder=t.Utf8Encoders=t.BufferEncoder=t.BufferEncoders=t.writeUInt24BE=t.toBuffer=t.readUInt24BE=t.createBuffer=t.byteLength=t.serializeFrameWithLength=t.serializeFrame=t.deserializeFrames=t.deserializeFrameWithLength=t.deserializeFrame=t.printFrame=t.isResumeEnable=t.isRespond=t.isNext=t.isMetadata=t.isLease=t.isIgnore=t.isComplete=t.getErrorCodeExplanation=t.createErrorFromFrame=t.MAX_VERSION=t.MAX_STREAM_ID=t.MAX_RESUME_LENGTH=t.MAX_MIME_LENGTH=t.MAX_LIFETIME=t.MAX_KEEPALIVE=t.MAX_CODE=t.FRAME_TYPES=t.FRAME_TYPE_OFFFSET=t.FLAGS=t.FLAGS_MASK=t.ERROR_EXPLANATIONS=t.ERROR_CODES=t.CONNECTION_STREAM_ID=t.RSocketResumableTransport=t.RSocketServer=t.RSocketClient=void 0;var i=r(1);Object.defineProperty(t,\"CONNECTION_STREAM_ID\",{enumerable:!0,get:function(){return i.CONNECTION_STREAM_ID}}),Object.defineProperty(t,\"ERROR_CODES\",{enumerable:!0,get:function(){return i.ERROR_CODES}}),Object.defineProperty(t,\"ERROR_EXPLANATIONS\",{enumerable:!0,get:function(){return i.ERROR_EXPLANATIONS}}),Object.defineProperty(t,\"FLAGS_MASK\",{enumerable:!0,get:function(){return i.FLAGS_MASK}}),Object.defineProperty(t,\"FLAGS\",{enumerable:!0,get:function(){return i.FLAGS}}),Object.defineProperty(t,\"FRAME_TYPE_OFFFSET\",{enumerable:!0,get:function(){return i.FRAME_TYPE_OFFFSET}}),Object.defineProperty(t,\"FRAME_TYPES\",{enumerable:!0,get:function(){return i.FRAME_TYPES}}),Object.defineProperty(t,\"MAX_CODE\",{enumerable:!0,get:function(){return i.MAX_CODE}}),Object.defineProperty(t,\"MAX_KEEPALIVE\",{enumerable:!0,get:function(){return i.MAX_KEEPALIVE}}),Object.defineProperty(t,\"MAX_LIFETIME\",{enumerable:!0,get:function(){return i.MAX_LIFETIME}}),Object.defineProperty(t,\"MAX_MIME_LENGTH\",{enumerable:!0,get:function(){return i.MAX_MIME_LENGTH}}),Object.defineProperty(t,\"MAX_RESUME_LENGTH\",{enumerable:!0,get:function(){return i.MAX_RESUME_LENGTH}}),Object.defineProperty(t,\"MAX_STREAM_ID\",{enumerable:!0,get:function(){return i.MAX_STREAM_ID}}),Object.defineProperty(t,\"MAX_VERSION\",{enumerable:!0,get:function(){return i.MAX_VERSION}}),Object.defineProperty(t,\"createErrorFromFrame\",{enumerable:!0,get:function(){return i.createErrorFromFrame}}),Object.defineProperty(t,\"getErrorCodeExplanation\",{enumerable:!0,get:function(){return i.getErrorCodeExplanation}}),Object.defineProperty(t,\"isComplete\",{enumerable:!0,get:function(){return i.isComplete}}),Object.defineProperty(t,\"isIgnore\",{enumerable:!0,get:function(){return i.isIgnore}}),Object.defineProperty(t,\"isLease\",{enumerable:!0,get:function(){return i.isLease}}),Object.defineProperty(t,\"isMetadata\",{enumerable:!0,get:function(){return i.isMetadata}}),Object.defineProperty(t,\"isNext\",{enumerable:!0,get:function(){return i.isNext}}),Object.defineProperty(t,\"isRespond\",{enumerable:!0,get:function(){return i.isRespond}}),Object.defineProperty(t,\"isResumeEnable\",{enumerable:!0,get:function(){return i.isResumeEnable}}),Object.defineProperty(t,\"printFrame\",{enumerable:!0,get:function(){return i.printFrame}});var o=r(12);Object.defineProperty(t,\"deserializeFrame\",{enumerable:!0,get:function(){return o.deserializeFrame}}),Object.defineProperty(t,\"deserializeFrameWithLength\",{enumerable:!0,get:function(){return o.deserializeFrameWithLength}}),Object.defineProperty(t,\"deserializeFrames\",{enumerable:!0,get:function(){return o.deserializeFrames}}),Object.defineProperty(t,\"serializeFrame\",{enumerable:!0,get:function(){return o.serializeFrame}}),Object.defineProperty(t,\"serializeFrameWithLength\",{enumerable:!0,get:function(){return o.serializeFrameWithLength}});var s=r(7);Object.defineProperty(t,\"byteLength\",{enumerable:!0,get:function(){return s.byteLength}}),Object.defineProperty(t,\"createBuffer\",{enumerable:!0,get:function(){return s.createBuffer}}),Object.defineProperty(t,\"readUInt24BE\",{enumerable:!0,get:function(){return s.readUInt24BE}}),Object.defineProperty(t,\"toBuffer\",{enumerable:!0,get:function(){return s.toBuffer}}),Object.defineProperty(t,\"writeUInt24BE\",{enumerable:!0,get:function(){return s.writeUInt24BE}});var u=r(13);Object.defineProperty(t,\"BufferEncoders\",{enumerable:!0,get:function(){return u.BufferEncoders}}),Object.defineProperty(t,\"BufferEncoder\",{enumerable:!0,get:function(){return u.BufferEncoder}}),Object.defineProperty(t,\"Utf8Encoders\",{enumerable:!0,get:function(){return u.Utf8Encoders}}),Object.defineProperty(t,\"UTF8Encoder\",{enumerable:!0,get:function(){return u.UTF8Encoder}});var a=r(8);Object.defineProperty(t,\"IdentitySerializer\",{enumerable:!0,get:function(){return a.IdentitySerializer}}),Object.defineProperty(t,\"IdentitySerializers\",{enumerable:!0,get:function(){return a.IdentitySerializers}}),Object.defineProperty(t,\"JsonSerializer\",{enumerable:!0,get:function(){return a.JsonSerializer}}),Object.defineProperty(t,\"JsonSerializers\",{enumerable:!0,get:function(){return a.JsonSerializers}});var c=r(5);Object.defineProperty(t,\"Leases\",{enumerable:!0,get:function(){return c.Leases}}),Object.defineProperty(t,\"Lease\",{enumerable:!0,get:function(){return c.Lease}});var l=n(r(33)),h=n(r(35)),f=n(r(36));t.RSocketClient=l.default,t.RSocketServer=h.default,t.RSocketResumableTransport=f.default},function(e,t,r){\"use strict\";function n(e,t){t=t||h.Utf8Encoders;let r=0;const n=e.readInt32BE(r);r+=4,(0,c.default)(0<=n,\"RSocketBinaryFraming: Invalid frame, expected a positive stream id, got `%s.\",n);const i=e.readUInt16BE(r);r+=2;const o=i>>>l.FRAME_TYPE_OFFFSET,s=i&l.FLAGS_MASK;switch(o){case l.FRAME_TYPES.SETUP:return function(e,t,r,n){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid SETUP frame, expected stream id to be 0.\");const i=e.length;let o=d;const s=e.readUInt16BE(o);o+=2;const u=e.readUInt16BE(o);o+=2;const h=e.readInt32BE(o);o+=4,(0,c.default)(0<=h&&h<=l.MAX_KEEPALIVE,\"RSocketBinaryFraming: Invalid SETUP frame, expected keepAlive to be >= 0 and <= %s. Got `%s`.\",l.MAX_KEEPALIVE,h);const f=e.readInt32BE(o);o+=4,(0,c.default)(0<=f&&f<=l.MAX_LIFETIME,\"RSocketBinaryFraming: Invalid SETUP frame, expected lifetime to be >= 0 and <= %s. Got `%s`.\",l.MAX_LIFETIME,f);let p=null;if(r&l.FLAGS.RESUME_ENABLE){const t=e.readInt16BE(o);o+=2,(0,c.default)(0<=t&&t<=l.MAX_RESUME_LENGTH,\"RSocketBinaryFraming: Invalid SETUP frame, expected resumeToken length to be >= 0 and <= %s. Got `%s`.\",l.MAX_RESUME_LENGTH,t),p=n.resumeToken.decode(e,o,o+t),o+=t}const E=e.readUInt8(o);o+=1;const _=n.metadataMimeType.decode(e,o,o+E);o+=E;const b=e.readUInt8(o);o+=1;const y=n.dataMimeType.decode(e,o,o+b);o+=b;const m={data:null,dataMimeType:y,flags:r,keepAlive:h,length:i,lifetime:f,majorVersion:s,metadata:null,metadataMimeType:_,minorVersion:u,resumeToken:p,streamId:t,type:l.FRAME_TYPES.SETUP};return a(e,m,n,o),m}(e,n,s,t);case l.FRAME_TYPES.PAYLOAD:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid PAYLOAD frame, expected stream id to be > 0.\");const i=e.length,o={data:null,flags:r,length:i,metadata:null,streamId:t,type:l.FRAME_TYPES.PAYLOAD};return a(e,o,n,d),o}(e,n,s,t);case l.FRAME_TYPES.ERROR:return function(e,t,r,n){const i=e.length;let o=d;const s=e.readInt32BE(o);o+=4,(0,c.default)(0<=s&&s<=l.MAX_CODE,\"RSocketBinaryFraming: Invalid ERROR frame, expected code to be >= 0 and <= %s. Got `%s`.\",l.MAX_CODE,s);const u=e.length-o;let a=\"\";return 0<u&&(a=n.message.decode(e,o,o+u),o+=u),{code:s,flags:r,length:i,message:a,streamId:t,type:l.FRAME_TYPES.ERROR}}(e,n,s,t);case l.FRAME_TYPES.KEEPALIVE:return function(e,t,r,n){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid KEEPALIVE frame, expected stream id to be 0.\");const i=e.length;let o=d;const s=(0,f.readUInt64BE)(e,o);let u=null;return(o+=8)<e.length&&(u=n.data.decode(e,o,e.length)),{data:u,flags:r,lastReceivedPosition:s,length:i,streamId:t,type:l.FRAME_TYPES.KEEPALIVE}}(e,n,s,t);case l.FRAME_TYPES.REQUEST_FNF:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_FNF frame, expected stream id to be > 0.\");const i=e.length,o={data:null,flags:r,length:i,metadata:null,streamId:t,type:l.FRAME_TYPES.REQUEST_FNF};return a(e,o,n,d),o}(e,n,s,t);case l.FRAME_TYPES.REQUEST_RESPONSE:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_RESPONSE frame, expected stream id to be > 0.\");const i=e.length,o={data:null,flags:r,length:i,metadata:null,streamId:t,type:l.FRAME_TYPES.REQUEST_RESPONSE};return a(e,o,n,d),o}(e,n,s,t);case l.FRAME_TYPES.REQUEST_STREAM:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_STREAM frame, expected stream id to be > 0.\");const i=e.length;let o=d;const s=e.readInt32BE(o);o+=4,(0,c.default)(0<s,\"RSocketBinaryFraming: Invalid REQUEST_STREAM frame, expected requestN to be > 0, got `%s`.\",s);const u={data:null,flags:r,length:i,metadata:null,requestN:s,streamId:t,type:l.FRAME_TYPES.REQUEST_STREAM};return a(e,u,n,o),u}(e,n,s,t);case l.FRAME_TYPES.REQUEST_CHANNEL:return function(e,t,r,n){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_CHANNEL frame, expected stream id to be > 0.\");const i=e.length;let o=d;const s=e.readInt32BE(o);o+=4,(0,c.default)(0<s,\"RSocketBinaryFraming: Invalid REQUEST_STREAM frame, expected requestN to be > 0, got `%s`.\",s);const u={data:null,flags:r,length:i,metadata:null,requestN:s,streamId:t,type:l.FRAME_TYPES.REQUEST_CHANNEL};return a(e,u,n,o),u}(e,n,s,t);case l.FRAME_TYPES.REQUEST_N:return function(e,t,r){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid REQUEST_N frame, expected stream id to be > 0.\");const n=e.length,i=e.readInt32BE(d);return(0,c.default)(0<i,\"RSocketBinaryFraming: Invalid REQUEST_STREAM frame, expected requestN to be > 0, got `%s`.\",i),{flags:r,length:n,requestN:i,streamId:t,type:l.FRAME_TYPES.REQUEST_N}}(e,n,s);case l.FRAME_TYPES.RESUME:return function(e,t,r,n){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid RESUME frame, expected stream id to be 0.\");const i=e.length;let o=d;const s=e.readUInt16BE(o);o+=2;const u=e.readUInt16BE(o);o+=2;const a=e.readInt16BE(o);o+=2,(0,c.default)(0<=a&&a<=l.MAX_RESUME_LENGTH,\"RSocketBinaryFraming: Invalid SETUP frame, expected resumeToken length to be >= 0 and <= %s. Got `%s`.\",l.MAX_RESUME_LENGTH,a);const h=n.resumeToken.decode(e,o,o+a);o+=a;const p=(0,f.readUInt64BE)(e,o);o+=8;const E=(0,f.readUInt64BE)(e,o);return o+=8,{clientPosition:E,flags:r,length:i,majorVersion:s,minorVersion:u,resumeToken:h,serverPosition:p,streamId:t,type:l.FRAME_TYPES.RESUME}}(e,n,s,t);case l.FRAME_TYPES.RESUME_OK:return function(e,t,r){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid RESUME frame, expected stream id to be 0.\");const n=e.length;return{clientPosition:(0,f.readUInt64BE)(e,d),flags:r,length:n,streamId:t,type:l.FRAME_TYPES.RESUME_OK}}(e,n,s);case l.FRAME_TYPES.CANCEL:return function(e,t,r){(0,c.default)(0<t,\"RSocketBinaryFraming: Invalid CANCEL frame, expected stream id to be > 0.\");const n=e.length;return{flags:r,length:n,streamId:t,type:l.FRAME_TYPES.CANCEL}}(e,n,s);case l.FRAME_TYPES.LEASE:return function(e,t,r,n){(0,c.default)(0===t,\"RSocketBinaryFraming: Invalid LEASE frame, expected stream id to be 0.\");const i=e.length;let o=d;const s=e.readUInt32BE(o);o+=4;const u=e.readUInt32BE(o);let a=null;return(o+=4)<e.length&&(a=n.metadata.decode(e,o,e.length)),{flags:r,length:i,metadata:a,requestCount:u,streamId:t,ttl:s,type:l.FRAME_TYPES.LEASE}}(e,n,s,t);default:(0,c.default)(!1,\"RSocketBinaryFraming: Unsupported frame type `%s`.\",(0,l.getFrameTypeName)(o))}}function i(e,t){switch(t=t||h.Utf8Encoders,e.type){case l.FRAME_TYPES.SETUP:return function(e,t){const r=null==e.resumeToken?0:t.resumeToken.byteLength(e.resumeToken),n=null==e.metadataMimeType?0:t.metadataMimeType.byteLength(e.metadataMimeType),i=null==e.dataMimeType?0:t.dataMimeType.byteLength(e.dataMimeType),a=s(e,t),c=(0,f.createBuffer)(d+E+(r?_+r:0)+n+i+a);let h=o(e,c);return h=c.writeUInt16BE(e.majorVersion,h),h=c.writeUInt16BE(e.minorVersion,h),h=c.writeUInt32BE(e.keepAlive,h),h=c.writeUInt32BE(e.lifetime,h),e.flags&l.FLAGS.RESUME_ENABLE&&(h=c.writeUInt16BE(r,h),null!=e.resumeToken&&(h=t.resumeToken.encode(e.resumeToken,c,h,h+r))),h=c.writeUInt8(n,h),null!=e.metadataMimeType&&(h=t.metadataMimeType.encode(e.metadataMimeType,c,h,h+n)),h=c.writeUInt8(i,h),null!=e.dataMimeType&&(h=t.dataMimeType.encode(e.dataMimeType,c,h,h+i)),u(e,c,t,h),c}(e,t);case l.FRAME_TYPES.PAYLOAD:return function(e,t){const r=s(e,t),n=(0,f.createBuffer)(d+r),i=o(e,n);return u(e,n,t,i),n}(e,t);case l.FRAME_TYPES.ERROR:return function(e,t){const r=null==e.message?0:t.message.byteLength(e.message),n=(0,f.createBuffer)(d+b+r);let i=o(e,n);return i=n.writeUInt32BE(e.code,i),null!=e.message&&t.message.encode(e.message,n,i,i+r),n}(e,t);case l.FRAME_TYPES.KEEPALIVE:return function(e,t){const r=null==e.data?0:t.data.byteLength(e.data),n=(0,f.createBuffer)(d+y+r);let i=o(e,n);return i=(0,f.writeUInt64BE)(n,e.lastReceivedPosition,i),null!=e.data&&t.data.encode(e.data,n,i,i+r),n}(e,t);case l.FRAME_TYPES.REQUEST_FNF:case l.FRAME_TYPES.REQUEST_RESPONSE:return function(e,t){const r=s(e,t),n=(0,f.createBuffer)(d+r),i=o(e,n);return u(e,n,t,i),n}(e,t);case l.FRAME_TYPES.REQUEST_STREAM:case l.FRAME_TYPES.REQUEST_CHANNEL:return function(e,t){const r=s(e,t),n=(0,f.createBuffer)(d+v+r);let i=o(e,n);return i=n.writeUInt32BE(e.requestN,i),u(e,n,t,i),n}(e,t);case l.FRAME_TYPES.REQUEST_N:return function(e){const t=(0,f.createBuffer)(d+S),r=o(e,t);return t.writeUInt32BE(e.requestN,r),t}(e);case l.FRAME_TYPES.RESUME:return function(e,t){const r=t.resumeToken.byteLength(e.resumeToken),n=(0,f.createBuffer)(d+g+r);let i=o(e,n);return i=n.writeUInt16BE(e.majorVersion,i),i=n.writeUInt16BE(e.minorVersion,i),i=n.writeUInt16BE(r,i),i=t.resumeToken.encode(e.resumeToken,n,i,i+r),i=(0,f.writeUInt64BE)(n,e.serverPosition,i),(0,f.writeUInt64BE)(n,e.clientPosition,i),n}(e,t);case l.FRAME_TYPES.RESUME_OK:return function(e){const t=(0,f.createBuffer)(d+R),r=o(e,t);return(0,f.writeUInt64BE)(t,e.clientPosition,r),t}(e);case l.FRAME_TYPES.CANCEL:return function(e){const t=(0,f.createBuffer)(d);return o(e,t),t}(e);case l.FRAME_TYPES.LEASE:return function(e,t){const r=null==e.metadata?0:t.metadata.byteLength(e.metadata),n=(0,f.createBuffer)(d+m+r);let i=o(e,n);return i=n.writeUInt32BE(e.ttl,i),i=n.writeUInt32BE(e.requestCount,i),null!=e.metadata&&t.metadata.encode(e.metadata,n,i,i+r),n}(e,t);default:(0,c.default)(!1,\"RSocketBinaryFraming: Unsupported frame type `%s`.\",(0,l.getFrameTypeName)(e.type))}}function o(e,t){const r=t.writeInt32BE(e.streamId,0);return t.writeUInt16BE(e.type<<l.FRAME_TYPE_OFFFSET|e.flags&l.FLAGS_MASK,r)}function s(e,t){let r=0;return null!=e.data&&(r+=t.data.byteLength(e.data)),(0,l.isMetadata)(e.flags)&&(r+=p,null!=e.metadata&&(r+=t.metadata.byteLength(e.metadata))),r}function u(e,t,r,n){if((0,l.isMetadata)(e.flags))if(null!=e.metadata){const i=r.metadata.byteLength(e.metadata);n=(0,f.writeUInt24BE)(t,i,n),n=r.metadata.encode(e.metadata,t,n,n+i)}else n=(0,f.writeUInt24BE)(t,0,n);null!=e.data&&r.data.encode(e.data,t,n,t.length)}function a(e,t,r,n){if((0,l.isMetadata)(t.flags)){const i=(0,f.readUInt24BE)(e,n);n+=p,0<i&&(t.metadata=r.metadata.decode(e,n,n+i),n+=i)}n<e.length&&(t.data=r.data.decode(e,n,e.length))}Object.defineProperty(t,\"__esModule\",{value:!0}),t.deserializeFrameWithLength=function(e,t){const r=(0,f.readUInt24BE)(e,0);return n(e.slice(p,p+r),t)},t.deserializeFrames=function(e,t){const r=[];let i=0;for(;i+p<e.length;){const o=(0,f.readUInt24BE)(e,i),s=i+p,u=s+o;if(u>e.length)break;const a=n(e.slice(s,u),t);r.push(a),i=u}return[r,e.slice(i,e.length)]},t.serializeFrameWithLength=function(e,t){const r=i(e,t),n=(0,f.createBuffer)(r.length+p);return(0,f.writeUInt24BE)(n,r.length,0),r.copy(n,p,0,r.length),n},t.deserializeFrame=n,t.serializeFrame=i,t.sizeOfFrame=function(e,t){switch(t=t||h.Utf8Encoders,e.type){case l.FRAME_TYPES.SETUP:return function(e,t){const r=null==e.resumeToken?0:t.resumeToken.byteLength(e.resumeToken),n=null==e.metadataMimeType?0:t.metadataMimeType.byteLength(e.metadataMimeType),i=null==e.dataMimeType?0:t.dataMimeType.byteLength(e.dataMimeType),o=s(e,t);return d+E+(r?_+r:0)+n+i+o}(e,t);case l.FRAME_TYPES.PAYLOAD:return function(e,t){const r=s(e,t);return d+r}(e,t);case l.FRAME_TYPES.ERROR:return function(e,t){const r=null==e.message?0:t.message.byteLength(e.message);return d+b+r}(e,t);case l.FRAME_TYPES.KEEPALIVE:return function(e,t){const r=null==e.data?0:t.data.byteLength(e.data);return d+y+r}(e,t);case l.FRAME_TYPES.REQUEST_FNF:case l.FRAME_TYPES.REQUEST_RESPONSE:return function(e,t){const r=s(e,t);return d+r}(e,t);case l.FRAME_TYPES.REQUEST_STREAM:case l.FRAME_TYPES.REQUEST_CHANNEL:return function(e,t){const r=s(e,t);return d+v+r}(e,t);case l.FRAME_TYPES.REQUEST_N:return d+S;case l.FRAME_TYPES.RESUME:return function(e,t){const r=t.resumeToken.byteLength(e.resumeToken);return d+g+r}(e,t);case l.FRAME_TYPES.RESUME_OK:return d+R;case l.FRAME_TYPES.CANCEL:return d;case l.FRAME_TYPES.LEASE:return function(e,t){const r=null==e.metadata?0:t.metadata.byteLength(e.metadata);return d+m+r}(e,t);default:(0,c.default)(!1,\"RSocketBinaryFraming: Unsupported frame type `%s`.\",(0,l.getFrameTypeName)(e.type))}};var c=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),l=r(1),h=r(13),f=r(7);const d=6,p=3,E=14,_=2,b=4,y=8,m=8,v=4,S=4,g=22,R=8},function(e,t,r){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0}),t.BufferEncoders=t.Utf8Encoders=t.BufferEncoder=t.UTF8Encoder=void 0;var n=r(7),i=function(e){return e&&e.__esModule?e:{default:e}}(r(0));const o=t.UTF8Encoder={byteLength:e=>(0,n.byteLength)(e,\"utf8\"),decode:(e,t,r)=>e.toString(\"utf8\",t,r),encode:(e,t,r,n)=>((0,i.default)(\"string\"==typeof e,\"RSocketEncoding: Expected value to be a string, got `%s`.\",e),t.write(e,r,n-r,\"utf8\"),n)},s=t.BufferEncoder={byteLength:t=>((0,i.default)(e.isBuffer(t),\"RSocketEncoding: Expected value to be a buffer, got `%s`.\",t),t.length),decode:(e,t,r)=>e.slice(t,r),encode:(t,r,n,o)=>((0,i.default)(e.isBuffer(t),\"RSocketEncoding: Expected value to be a buffer, got `%s`.\",t),t.copy(r,n,0,t.length),o)};t.Utf8Encoders={data:o,dataMimeType:o,message:o,metadata:o,metadataMimeType:o,resumeToken:o},t.BufferEncoders={data:s,dataMimeType:o,message:o,metadata:s,metadataMimeType:o,resumeToken:s}}).call(this,r(29).Buffer)},function(e,t,r){\"use strict\";var n=String.fromCharCode,i=Math.min;(function(e){function r(e){if(e>m)throw new RangeError('The value \"'+e+'\" is invalid for option \"size\"');const t=new Uint8Array(e);return t.__proto__=o.prototype,t}function o(e,t,r){if(\"number\"==typeof e){if(\"string\"==typeof t)throw new TypeError('The \"string\" argument must be of type string. Received type number');return c(e)}return s(e,t,r)}function s(e,t,r){if(ArrayBuffer.isView(e))return l(e);if(null==e)throw TypeError(\"The first argument must be one of type, Buffer, ArrayBuffer, Array, or Array-like Object. Received type \"+typeof e);if(y(e,ArrayBuffer)||e&&y(e.buffer,ArrayBuffer))return function(e,t,r){let n;return(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=o.prototype,n}(e,t,r);if(\"number\"==typeof e)throw new TypeError('The \"value\" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return o.from(n,t,r);const i=h(e);if(i)return i;throw new TypeError(\"The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type \"+typeof e)}function u(e){if(\"number\"!=typeof e)throw new TypeError('\"size\" argument must be of type number');if(0>e)throw new RangeError('The value \"'+e+'\" is invalid for option \"size\"')}function a(e){return u(e),r(e)}function c(e){return u(e),r(0>e?0:0|f(e))}function l(e){const t=0>e.length?0:0|f(e.length),n=r(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e){if(o.isBuffer(e)){const t=0|f(e.length),n=r(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}return void 0===e.length?\"Buffer\"===e.type&&Array.isArray(e.data)?l(e.data):void 0:\"number\"!=typeof e.length||function(e){return e!=e}(e.length)?r(0):l(e)}function f(e){if(e>=m)throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+m.toString(16)+\" bytes\");return 0|e}function d(e){const t=e.length;if(t<=S)return n.apply(String,e);let r=\"\",i=0;for(;i<t;)r+=n.apply(String,e.slice(i,i+=S));return r}function p(e,t,r){if(0!=e%1||0>e)throw new RangeError(\"offset is not uint\");if(e+t>r)throw new RangeError(\"Trying to access beyond buffer length\")}function E(e,t,r,n,i,s){if(!o.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('\"value\" argument is out of bounds');if(r+n>e.length)throw new RangeError(\"Index out of range\")}function _(e,t=1/0){let r,n=t;const i=e.length;let o=null;const s=[];for(let t=0;t<i;++t){if(55295<(r=e.charCodeAt(t))&&57344>r){if(!o){if(56319<r){-1<(n-=3)&&s.push(239,191,189);continue}if(t+1===i){-1<(n-=3)&&s.push(239,191,189);continue}o=r;continue}if(56320>r){-1<(n-=3)&&s.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&-1<(n-=3)&&s.push(239,191,189);if(o=null,128>r){if(0>(n-=1))break;s.push(r)}else if(2048>r){if(0>(n-=2))break;s.push(192|r>>6,128|63&r)}else if(65536>r){if(0>(n-=3))break;s.push(224|r>>12,128|63&r>>6,128|63&r)}else{if(!(1114112>r))throw new Error(\"Invalid code point\");if(0>(n-=4))break;s.push(240|r>>18,128|63&r>>12,128|63&r>>6,128|63&r)}}return s}function b(e,t,r){r=i(e.length,r);const n=[];for(let i=t;i<r;){const t=e[i];let o=null,s=239<t?4:223<t?3:191<t?2:1;if(i+s<=r){let r,n,u,a;1==s?128>t&&(o=t):2==s?128==(192&(r=e[i+1]))&&(127<(a=(31&t)<<6|63&r)&&(o=a)):3==s?(r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(2047<(a=(15&t)<<12|(63&r)<<6|63&n)&&(55296>a||57343<a)&&(o=a))):4==s&&(r=e[i+1],n=e[i+2],u=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&u)&&(65535<(a=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&u)&&1114112>a&&(o=a)))}null===o?(o=65533,s=1):65535<o&&(o-=65536,n.push(55296|1023&o>>>10),o=56320|1023&o),n.push(o),i+=s}return d(n)}function y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}Object.defineProperty(t,\"__esModule\",{value:!0}),t.Buffer=o;const m=2147483647,v=void 0!==e&&e.hasOwnProperty(\"Buffer\");t.LiteBuffer=v?e.Buffer:o;o.from=function(e,t,r){return s(e,t,r)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(e,t,r){return a(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.isEncoding=function(e){switch((e+\"\").toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},o.prototype._isBuffer=!0,o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.write=function(e,t,r,n){switch(n){case\"utf8\":return function(e,t,r,n){return function(e,t,r,n){let i=0;for(;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}(_(t,e.length-r),e,r,n)}(this,e,t,r);default:throw new TypeError(\"Unknown encoding: \"+n)}};const S=4096;o.prototype.slice=function(e,t){const r=this.length;0>(e=~~e)?0>(e+=r)&&(e=0):e>r&&(e=r),0>(t=void 0===t?r:~~t)?0>(t+=r)&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return n.__proto__=o.prototype,n},o.prototype.readUInt8=function(e,t){return e>>>=0,t||p(e,1,this.length),this[e]},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||p(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||p(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readInt8=function(e,t){return e>>>=0,t||p(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16BE=function(e,t){e>>>=0,t||p(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||p(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.toString=function(){return 0===this.length?\"\":function(e,t,r){let n=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return\"\";if((void 0===r||r>this.length)&&(r=this.length),0>=r)return\"\";if((r>>>=0)<=(t>>>=0))return\"\";for(e||(e=\"utf8\");;)switch(e){case\"utf8\":case\"utf-8\":return b(this,t,r);default:if(n)throw new TypeError(\"Unsupported encoding: \"+e);e=(e+\"\").toLowerCase(),n=!0}}.apply(this,arguments)},o.byteLength=function(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||y(e,ArrayBuffer))return e.byteLength;if(\"string\"!=typeof e)throw new TypeError('The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;for(let r=!1;;)switch(t){case\"utf8\":case\"utf-8\":return _(e).length;default:if(r)return n?-1:_(e).length;t=(\"\"+t).toLowerCase(),r=!0}throw new Error(\"Unexpected path in function\")},o.prototype.copy=function(e,t,r,n){if(!o.isBuffer(e))throw new TypeError(\"argument should be a Buffer\");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),0<n&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError(\"targetStart out of bounds\");if(0>r||r>=this.length)throw new RangeError(\"Index out of range\");if(0>n)throw new RangeError(\"sourceEnd out of bounds\");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;if(this===e&&\"function\"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(let n=i-1;0<=n;--n)e[n+t]=this[n+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i}}).call(this,r(6))},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0}),t.createServerMachine=function(e,t,r,n,i){return new l(\"SERVER\",e,t,r,void 0,n,i)},t.createClientMachine=function(e,t,r,n,i,o){return new l(\"CLIENT\",e,t,r,n,i,o)};var i=r(2),o=n(r(4)),s=(n(r(0)),n(r(3))),u=r(1),a=r(8);r(5);class c{constructor(e){this._responder=e||{}}setResponder(e){this._responder=e||{}}fireAndForget(e){if(this._responder.fireAndForget)try{this._responder.fireAndForget(e)}catch(e){console.error(\"fireAndForget threw an exception\",e)}}requestResponse(e){let t;if(this._responder.requestResponse)try{return this._responder.requestResponse(e)}catch(e){console.error(\"requestResponse threw an exception\",e),t=e}return i.Single.error(t||new Error(\"not implemented\"))}requestStream(e){let t;if(this._responder.requestStream)try{return this._responder.requestStream(e)}catch(e){console.error(\"requestStream threw an exception\",e),t=e}return i.Flowable.error(t||new Error(\"not implemented\"))}requestChannel(e){let t;if(this._responder.requestChannel)try{return this._responder.requestChannel(e)}catch(e){console.error(\"requestChannel threw an exception\",e),t=e}return i.Flowable.error(t||new Error(\"not implemented\"))}metadataPush(e){let t;if(this._responder.metadataPush)try{return this._responder.metadataPush(e)}catch(e){console.error(\"metadataPush threw an exception\",e),t=e}return i.Single.error(t||new Error(\"not implemented\"))}}class l{constructor(e,t,r,n,i,o,s){this._connectionAvailability=1,this._handleTransportClose=(()=>{this._handleError(new Error(\"RSocket: The connection was closed.\"))}),this._handleError=(e=>{this._receivers.forEach(t=>{t.onError(e)}),this._receivers.clear(),this._subscriptions.forEach(e=>{e.cancel()}),this._subscriptions.clear(),this._connectionAvailability=0,this._dispose(this._requesterLeaseHandler,this._responderLeaseSenderDisposable)}),this._handleFrame=(e=>{const{streamId:t}=e;t===u.CONNECTION_STREAM_ID?this._handleConnectionFrame(e):this._handleStreamFrame(t,e)}),this._connection=t,this._requesterLeaseHandler=o,this._responderLeaseHandler=s,this._nextStreamId=\"CLIENT\"===e?1:2,this._receivers=new Map,this._subscriptions=new Map,this._serializers=n||a.IdentitySerializers,this._requestHandler=new c(i),r({onComplete:this._handleTransportClose,onError:this._handleError,onNext:this._handleFrame,onSubscribe:e=>e.request(Number.MAX_SAFE_INTEGER)});const l=this._responderLeaseHandler;l&&(this._responderLeaseSenderDisposable=l.send(this._leaseFrameSender())),this._connection.connectionStatus().subscribe({onNext:e=>{\"CLOSED\"===e.kind?this._handleTransportClose():\"ERROR\"===e.kind&&this._handleError(e.error)},onSubscribe:e=>e.request(Number.MAX_SAFE_INTEGER)})}setRequestHandler(e){this._requestHandler.setResponder(e)}close(){this._connection.close()}connectionStatus(){return this._connection.connectionStatus()}availability(){const e=this._requesterLeaseHandler,t=e?e.availability():1;return Math.min(this._connectionAvailability,t)}fireAndForget(e){if(!this._useLeaseOrError(this._requesterLeaseHandler)){const t=this._getNextStreamId(this._receivers),r=this._serializers.data.serialize(e.data),n=this._serializers.metadata.serialize(e.metadata),i={data:r,flags:void 0===e.metadata?0:u.FLAGS.METADATA,metadata:n,streamId:t,type:u.FRAME_TYPES.REQUEST_FNF};this._connection.sendOne(i)}}requestResponse(e){const t=this._useLeaseOrError(this._requesterLeaseHandler);if(t)return i.Single.error(new Error(t));const r=this._getNextStreamId(this._receivers);return new i.Single(t=>{this._receivers.set(r,{onComplete:o.default,onError:e=>t.onError(e),onNext:e=>t.onComplete(e)});const n=this._serializers.data.serialize(e.data),i=this._serializers.metadata.serialize(e.metadata),s={data:n,flags:void 0===e.metadata?0:u.FLAGS.METADATA,metadata:i,streamId:r,type:u.FRAME_TYPES.REQUEST_RESPONSE};this._connection.sendOne(s),t.onSubscribe(()=>{this._receivers.delete(r);const e={flags:0,streamId:r,type:u.FRAME_TYPES.CANCEL};this._connection.sendOne(e)})})}requestStream(e){const t=this._useLeaseOrError(this._requesterLeaseHandler);if(t)return i.Flowable.error(new Error(t));const r=this._getNextStreamId(this._receivers);return new i.Flowable(t=>{this._receivers.set(r,t);let n=!1;t.onSubscribe({cancel:()=>{if(this._receivers.delete(r),n){const e={flags:0,streamId:r,type:u.FRAME_TYPES.CANCEL};this._connection.sendOne(e)}},request:t=>{if(t>u.MAX_REQUEST_N&&(t=u.MAX_REQUEST_N),n){const e={flags:0,requestN:t,streamId:r,type:u.FRAME_TYPES.REQUEST_N};this._connection.sendOne(e)}else{n=!0;const i=this._serializers.data.serialize(e.data),o=this._serializers.metadata.serialize(e.metadata),s={data:i,flags:void 0===e.metadata?0:u.FLAGS.METADATA,metadata:o,requestN:t,streamId:r,type:u.FRAME_TYPES.REQUEST_STREAM};this._connection.sendOne(s)}}})},u.MAX_REQUEST_N)}requestChannel(e){const t=this._useLeaseOrError(this._requesterLeaseHandler);if(t)return i.Flowable.error(new Error(t));const r=this._getNextStreamId(this._receivers);let n=!1;return new i.Flowable(t=>{try{this._receivers.set(r,t);let i=!1;t.onSubscribe({cancel:()=>{if(this._receivers.delete(r),i){const e={flags:0,streamId:r,type:u.FRAME_TYPES.CANCEL};this._connection.sendOne(e)}},request:t=>{if(t>u.MAX_REQUEST_N&&(t=u.MAX_REQUEST_N),i){const e={flags:0,requestN:t,streamId:r,type:u.FRAME_TYPES.REQUEST_N};this._connection.sendOne(e)}else n?(0,s.default)(!1,\"RSocketClient: re-entrant call to request n before initial channel established.\"):(n=!0,e.subscribe({onComplete:()=>{this._sendStreamComplete(r)},onError:e=>{this._sendStreamError(r,e.message)},onNext:e=>{const n=this._serializers.data.serialize(e.data),o=this._serializers.metadata.serialize(e.metadata);if(i){const t={data:n,flags:u.FLAGS.NEXT|(void 0===e.metadata?0:u.FLAGS.METADATA),metadata:o,streamId:r,type:u.FRAME_TYPES.PAYLOAD};this._connection.sendOne(t)}else{i=!0;const s={data:n,flags:void 0===e.metadata?0:u.FLAGS.METADATA,metadata:o,requestN:t,streamId:r,type:u.FRAME_TYPES.REQUEST_CHANNEL};this._connection.sendOne(s)}},onSubscribe:e=>{this._subscriptions.set(r,e),e.request(1)}}))}})}catch(e){console.warn(\"Exception while subscribing to channel flowable:\"+e)}},u.MAX_REQUEST_N)}metadataPush(){throw new Error(\"metadataPush() is not implemented\")}_getNextStreamId(e){const t=this._nextStreamId;do{this._nextStreamId=this._nextStreamId+2&u.MAX_STREAM_ID}while(0===this._nextStreamId||e.has(t));return t}_useLeaseOrError(e){if(e&&!e.use())return e.errorMessage()}_leaseFrameSender(){return e=>this._connection.sendOne({flags:0,metadata:e.metadata,requestCount:e.allowedRequests,streamId:u.CONNECTION_STREAM_ID,ttl:e.timeToLiveMillis,type:u.FRAME_TYPES.LEASE})}_dispose(...e){e.forEach(e=>{e&&e.dispose()})}_isRequest(e){return e===u.FRAME_TYPES.REQUEST_FNF||e===u.FRAME_TYPES.REQUEST_RESPONSE||e===u.FRAME_TYPES.REQUEST_STREAM||e===u.FRAME_TYPES.REQUEST_CHANNEL}_handleConnectionError(e){this._handleError(e),this._connection.close()}_handleConnectionFrame(e){switch(e.type){case u.FRAME_TYPES.ERROR:const t=(0,u.createErrorFromFrame)(e);this._handleConnectionError(t);break;case u.FRAME_TYPES.EXT:break;case u.FRAME_TYPES.KEEPALIVE:(0,u.isRespond)(e.flags)&&this._connection.sendOne(Object.assign({},e,{flags:e.flags^u.FLAGS.RESPOND,lastReceivedPosition:0}));break;case u.FRAME_TYPES.LEASE:const r=this._requesterLeaseHandler;r&&r.receive(e);break;case u.FRAME_TYPES.METADATA_PUSH:case u.FRAME_TYPES.REQUEST_CHANNEL:case u.FRAME_TYPES.REQUEST_FNF:case u.FRAME_TYPES.REQUEST_RESPONSE:case u.FRAME_TYPES.REQUEST_STREAM:case u.FRAME_TYPES.RESERVED:break;case u.FRAME_TYPES.RESUME:case u.FRAME_TYPES.RESUME_OK:}}_handleStreamFrame(e,t){if(this._isRequest(t.type)){const t=this._useLeaseOrError(this._responderLeaseHandler);if(t)return void this._sendStreamError(e,t)}switch(t.type){case u.FRAME_TYPES.CANCEL:this._handleCancel(e,t);break;case u.FRAME_TYPES.REQUEST_N:this._handleRequestN(e,t);break;case u.FRAME_TYPES.REQUEST_FNF:this._handleFireAndForget(e,t);break;case u.FRAME_TYPES.REQUEST_RESPONSE:this._handleRequestResponse(e,t);break;case u.FRAME_TYPES.REQUEST_STREAM:this._handleRequestStream(e,t);break;case u.FRAME_TYPES.REQUEST_CHANNEL:this._handleRequestChannel(e,t);break;case u.FRAME_TYPES.ERROR:const r=(0,u.createErrorFromFrame)(t);this._handleStreamError(e,r);break;case u.FRAME_TYPES.PAYLOAD:const n=this._receivers.get(e);if(null!=n){if((0,u.isNext)(t.flags)){const e={data:this._serializers.data.deserialize(t.data),metadata:this._serializers.metadata.deserialize(t.metadata)};n.onNext(e)}(0,u.isComplete)(t.flags)&&(this._receivers.delete(e),n.onComplete())}}}_handleCancel(e){const t=this._subscriptions.get(e);t&&(t.cancel(),this._subscriptions.delete(e))}_handleRequestN(e,t){const r=this._subscriptions.get(e);r&&r.request(t.requestN)}_handleFireAndForget(e,t){const r=this._deserializePayload(t);this._requestHandler.fireAndForget(r)}_handleRequestResponse(e,t){const r=this._deserializePayload(t);this._requestHandler.requestResponse(r).subscribe({onComplete:t=>{this._sendStreamPayload(e,t,!0)},onError:t=>this._sendStreamError(e,t.message),onSubscribe:t=>{const r={cancel:t,request:o.default};this._subscriptions.set(e,r)}})}_handleRequestStream(e,t){const r=this._deserializePayload(t);this._requestHandler.requestStream(r).subscribe({onComplete:()=>this._sendStreamComplete(e),onError:t=>this._sendStreamError(e,t.message),onNext:t=>this._sendStreamPayload(e,t),onSubscribe:r=>{this._subscriptions.set(e,r),r.request(t.requestN)}})}_handleRequestChannel(e,t){if(!this._subscriptions.get(e)){const r=new i.Flowable(r=>{let n=!0;r.onSubscribe({cancel:()=>{this._receivers.delete(e);const t={flags:0,streamId:e,type:u.FRAME_TYPES.CANCEL};this._connection.sendOne(t)},request:i=>{if(i>u.MAX_REQUEST_N&&(i=u.MAX_REQUEST_N),n&&i--,0<i){const t={flags:0,requestN:i,streamId:e,type:u.FRAME_TYPES.REQUEST_N};this._connection.sendOne(t)}n&&0<=i&&(n=!1,r.onNext(t))}})},u.MAX_REQUEST_N),n=new i.FlowableProcessor(r,e=>this._deserializePayload(e));this._receivers.set(e,n),this._requestHandler.requestChannel(n).subscribe({onComplete:()=>this._sendStreamComplete(e),onError:t=>this._sendStreamError(e,t.message),onNext:t=>this._sendStreamPayload(e,t),onSubscribe:r=>{this._subscriptions.set(e,r),r.request(t.requestN)}})}}_sendStreamComplete(e){this._subscriptions.delete(e),this._connection.sendOne({data:null,flags:u.FLAGS.COMPLETE,metadata:null,streamId:e,type:u.FRAME_TYPES.PAYLOAD})}_sendStreamError(e,t){this._subscriptions.delete(e),this._connection.sendOne({code:u.ERROR_CODES.APPLICATION_ERROR,flags:0,message:t,streamId:e,type:u.FRAME_TYPES.ERROR})}_sendStreamPayload(e,t,r=!1){let n=u.FLAGS.NEXT;r&&(n|=u.FLAGS.COMPLETE,this._subscriptions.delete(e));const i=this._serializers.data.serialize(t.data),o=this._serializers.metadata.serialize(t.metadata);this._connection.sendOne({data:i,flags:n,metadata:o,streamId:e,type:u.FRAME_TYPES.PAYLOAD})}_deserializePayload(e){return function(e,t){return{data:e.data.deserialize(t.data),metadata:e.metadata.deserialize(t.metadata)}}(this._serializers,e)}_handleStreamError(e,t){const r=this._receivers.get(e);null!=r&&(this._receivers.delete(e),r.onError(t))}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(37);Object.keys(n).forEach(function(e){\"default\"===e||\"__esModule\"===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})});var i=r(38);Object.keys(i).forEach(function(e){\"default\"===e||\"__esModule\"===e||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,t,r){\"use strict\";var n=this&&this.__awaiter||function(e,t,r,n){function i(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,o){function s(e){try{a(n.next(e))}catch(e){o(e)}}function u(e){try{a(n.throw(e))}catch(e){o(e)}}function a(e){e.done?r(e.value):i(e.value).then(s,u)}a((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(i=1,o&&(s=2&r[0]?o.return:r[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){a.label=r[1];break}if(6===r[0]&&a.label<s[1]){a.label=s[1],s=r;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(r);break}s[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,s,u,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},\"function\"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:!0});var s=r(39),u=o(r(20)),a=r(11),c=r(40);t.createGatewayProxy=function(e,t,r,o,s){var u,a=this,d=Array.isArray(t);u=d?t:[t];var p,E=[];return new Promise(function(t,_){return n(a,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return[4,l(e,s).catch(function(e){_(e)})];case 1:return p=n.sent(),u.forEach(function(e){var t=e.serviceName,n=e.methods;c.validateServiceDefinition(e);var i={};Object.keys(n).forEach(function(e){var s=n[e].asyncModel,u=c.getQualifier({serviceName:t,methodName:e});i[e]=function(){switch(s){case\"requestResponse\":return r?r(p,u):h(p,u);case\"requestStream\":return o?o(p,u):f(p,u);default:_(new Error(\"Unknown asyncModel\"))}}()}),E.push(i)}),t(d?E:E[0]),[2]}})})})};var l=function(e,t){return void 0===t&&(t={}),new Promise(function(r,n){new a.RSocketClient({serializers:a.JsonSerializers,setup:{dataMimeType:\"application/json\",keepAlive:t.keepAlive||1e5,lifetime:t.lifetime||1e5,metadataMimeType:\"application/json\"},transport:new u.default({url:e})}).connect().subscribe({onComplete:function(e){r(e)},onError:function(){n({message:\"Connection error\"})}})})},h=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new Promise(function(n,i){e.requestResponse({data:{qualifier:t,data:r}}).subscribe({onComplete:function(e){var t=e.data;n(t)},onError:function(e){i(e)}})})}},f=function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new s.Observable(function(n){e.requestStream({data:{qualifier:t,data:r}}).subscribe({onSubscribe:function(e){e.request(2147483647)},onNext:function(e){var t=e.data;n.next(t)},onComplete:function(){n.complete()},onError:function(e){n.error(e)}})})}}},function(e,t,r){\"use strict\";(function(e){r.d(t,\"a\",function(){return n});const n=()=>{const t={};e.postMessage=((e,r,n)=>{(t.message||[]).forEach(t=>{t({ports:n,data:e,type:\"message\"})})});const r=addEventListener;addEventListener=((e,n)=>{if(\"message\"===e){const r=[...t[e]||[],n];t[e]=r}else r(e,n)})}}).call(this,r(6))},function(e,t,r){\"use strict\";r.r(t);var n=r(17);r.n(n);console.log({createGatewayProxy:n.createGatewayProxy})},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(21));t.default=n.default},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(2),o=r(11),s=r(16);t.default=class{constructor(e,t){this._handleClosed=(e=>{this._close(new Error(e.reason||\"RSocketWebSocketClient: Socket closed unexpectedly.\"))}),this._handleError=(e=>{this._close(e.error)}),this._handleOpened=(()=>{this._setConnectionStatus(s.CONNECTION_STATUS.CONNECTED)}),this._handleMessage=(e=>{try{const t=this._readFrame(e);this._receivers.forEach(e=>e.onNext(t))}catch(e){this._close(e)}}),this._encoders=t,this._options=e,this._receivers=new Set,this._senders=new Set,this._socket=null,this._status=s.CONNECTION_STATUS.NOT_CONNECTED,this._statusSubscribers=new Set}close(){this._close()}connect(){(0,n.default)(\"NOT_CONNECTED\"===this._status.kind,\"RSocketWebSocketClient: Cannot connect(), a connection is already established.\"),this._setConnectionStatus(s.CONNECTION_STATUS.CONNECTING);const e=this._options.wsCreator,t=this._options.url;this._socket=e?e(t):new WebSocket(t);const r=this._socket;r.binaryType=\"arraybuffer\",r.addEventListener(\"close\",this._handleClosed),r.addEventListener(\"error\",this._handleError),r.addEventListener(\"open\",this._handleOpened),r.addEventListener(\"message\",this._handleMessage)}connectionStatus(){return new i.Flowable(e=>{e.onSubscribe({cancel:()=>{this._statusSubscribers.delete(e)},request:()=>{this._statusSubscribers.add(e),e.onNext(this._status)}})})}receive(){return new i.Flowable(e=>{e.onSubscribe({cancel:()=>{this._receivers.delete(e)},request:()=>{this._receivers.add(e)}})})}sendOne(e){this._writeFrame(e)}send(e){let t;e.subscribe({onComplete:()=>{t&&this._senders.delete(t)},onError:e=>{t&&this._senders.delete(t),this._close(e)},onNext:e=>this._writeFrame(e),onSubscribe:e=>{t=e,this._senders.add(t),t.request(Number.MAX_SAFE_INTEGER)}})}_close(e){if(\"CLOSED\"!==this._status.kind&&\"ERROR\"!==this._status.kind){const t=e?{error:e,kind:\"ERROR\"}:s.CONNECTION_STATUS.CLOSED;this._setConnectionStatus(t),this._receivers.forEach(t=>{e?t.onError(e):t.onComplete()}),this._receivers.clear(),this._senders.forEach(e=>e.cancel()),this._senders.clear();const r=this._socket;r&&(r.removeEventListener(\"close\",this._handleClosed),r.removeEventListener(\"error\",this._handleClosed),r.removeEventListener(\"open\",this._handleOpened),r.removeEventListener(\"message\",this._handleMessage),r.close(),this._socket=null)}}_setConnectionStatus(e){this._status=e,this._statusSubscribers.forEach(t=>t.onNext(e))}_readFrame(e){const t=(0,o.toBuffer)(e.data);return this._options.lengthPrefixedFrames?(0,o.deserializeFrameWithLength)(t,this._encoders):(0,o.deserializeFrame)(t,this._encoders)}_writeFrame(e){try{const t=this._options.lengthPrefixedFrames?(0,o.serializeFrameWithLength)(e,this._encoders):(0,o.serializeFrame)(e,this._encoders);(0,n.default)(this._socket,\"RSocketWebSocketClient: Cannot send frame, not connected.\"),this._socket.send(t)}catch(e){this._close(e)}}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(10));t.default=class{constructor(e,t){this._fn=t,this._subscriber=e,this._subscription=null}onComplete(){this._subscriber.onComplete()}onError(e){this._subscriber.onError(e)}onNext(e){try{this._subscriber.onNext(this._fn(e))}catch(e){(0,n.default)(this._subscription).cancel(),this._subscriber.onError(e)}}onSubscribe(e){this._subscription=e,this._subscriber.onSubscribe(e)}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(10));t.default=class{constructor(e,t){this._subscriber=e,this._subscription=null,this._toTake=t}onComplete(){this._subscriber.onComplete()}onError(e){this._subscriber.onError(e)}onNext(e){try{this._subscriber.onNext(e),0==--this._toTake&&this._cancelAndComplete()}catch(e){(0,n.default)(this._subscription).cancel(),this._subscriber.onError(e)}}onSubscribe(e){this._subscription=e,this._subscriber.onSubscribe(e),0>=this._toTake&&this._cancelAndComplete()}_cancelAndComplete(){(0,n.default)(this._subscription).cancel(),this._subscriber.onComplete()}}},function(e,t,r){\"use strict\";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(r(3)),o=n(r(4));class s{static of(e){return new s(t=>{t.onSubscribe(),t.onComplete(e)})}static error(e){return new s(t=>{t.onSubscribe(),t.onError(e)})}constructor(e){this._source=e}subscribe(e){const t=new u(e);try{this._source(t)}catch(e){t.onError(e)}}flatMap(e){return new s(t=>{let r;const n=()=>{r&&r(),r=null};this._source({onComplete:n=>{e(n).subscribe({onComplete:e=>{t.onComplete(e)},onError:e=>t.onError(e),onSubscribe:e=>{r=e}})},onError:e=>t.onError(e),onSubscribe:e=>{r=e,t.onSubscribe(n)}})})}map(e){return new s(t=>this._source({onComplete:r=>t.onComplete(e(r)),onError:e=>t.onError(e),onSubscribe:e=>t.onSubscribe(e)}))}then(e,t){this.subscribe({onComplete:e||o.default,onError:t||o.default})}}t.default=s;class u{constructor(e){this._active=!1,this._started=!1,this._subscriber=e||{}}onComplete(e){if(this._active){this._active=!1,this._started=!0;try{this._subscriber.onComplete&&this._subscriber.onComplete(e)}catch(e){this._subscriber.onError&&this._subscriber.onError(e)}}else(0,i.default)(!1,\"Single: Invalid call to onComplete(): %s.\",this._started?\"onComplete/onError was already called\":\"onSubscribe has not been called\")}onError(e){return this._started&&!this._active?void(0,i.default)(!1,\"Single: Invalid call to onError(): %s.\",this._active?\"onComplete/onError was already called\":\"onSubscribe has not been called\"):(this._active=!1,this._started=!0,void(this._subscriber.onError&&this._subscriber.onError(e)))}onSubscribe(e){if(this._started)(0,i.default)(!1,\"Single: Invalid call to onSubscribe(): already called.\");else{this._active=!0,this._started=!0;try{this._subscriber.onSubscribe&&this._subscriber.onSubscribe(()=>{this._active&&(this._active=!1,e&&e())})}catch(e){this.onError(e)}}}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(3));t.default=class{constructor(e,t){this._source=e,this._transformer=t,this._done=!1,this._mappers=[]}onSubscribe(e){this._subscription=e}onNext(e){if(!this._sink)return void(0,n.default)(\"Warning, premature onNext for processor, dropping value\");let t=e;this._transformer&&(t=this._transformer(e));const r=this._mappers.reduce((e,t)=>t(e),t);this._sink.onNext(r)}onError(e){this._error=e,this._sink?this._sink.onError(e):(0,n.default)(\"Warning, premature onError for processor, marking complete/errored\")}onComplete(){this._done=!0,this._sink?this._sink.onComplete():(0,n.default)(\"Warning, premature onError for processor, marking complete\")}subscribe(e){this._source.subscribe&&this._source.subscribe(this),this._sink=e,this._sink.onSubscribe(this),this._error?this._sink.onError(this._error):this._done&&this._sink.onComplete()}map(e){return this._mappers.push(e),this}request(e){this._subscription&&this._subscription.request(e)}cancel(){this._subscription&&this._subscription.cancel()}}},function(e,t,r){\"use strict\";var n=Number.MAX_SAFE_INTEGER;Object.defineProperty(t,\"__esModule\",{value:!0}),t.every=function(e){return new i.default(t=>{let r=null,i=0;t.onSubscribe({cancel:()=>{null!=r&&(clearInterval(r),r=null)},request:o=>{o<n?i+=o:i=n,null!=r||(r=setInterval(()=>{0<i&&(i!==n&&i--,t.onNext(Date.now()))},e))}})})};var i=function(e){return e&&e.__esModule?e:{default:e}}(r(9))},function(e){\"use strict\";var t=Object.prototype.hasOwnProperty;e.exports=function(e,r,n){for(var i in e)t.call(e,i)&&r.call(n,e[i],i,e)}},function(e){\"use strict\";e.exports=function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=0;return e.replace(/%s/g,function(){return r[i++]})}},function(e,t,r){\"use strict\";var n=Math.floor,i=Math.pow,o=String.fromCharCode,s=Math.min;(function(e){function u(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(u()<t)throw new RangeError(\"Invalid typed array length\");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if(\"number\"==typeof e){if(\"string\"==typeof t)throw new Error(\"If encoding is specified then the first argument must be a string\");return f(this,e)}return l(this,e,t,r)}function l(e,t,r,n){if(\"number\"==typeof t)throw new TypeError('\"value\" argument must not be a number');return\"undefined\"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,0>r||t.byteLength<r)throw new RangeError(\"'offset' is out of bounds\");if(t.byteLength<r+(n||0))throw new RangeError(\"'length' is out of bounds\");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=d(e,t),e}(e,t,r,n):\"string\"==typeof t?function(e,t,r){if((\"string\"!=typeof r||\"\"===r)&&(r=\"utf8\"),!c.isEncoding(r))throw new TypeError('\"encoding\" must be a valid string encoding');var n=0|E(t,r),i=(e=a(e,n)).write(t,r);return i!==n&&(e=e.slice(0,i)),e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|p(t.length);return 0===(e=a(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if(\"undefined\"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||\"length\"in t)return\"number\"!=typeof t.length||function(e){return e!=e}\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */(t.length)?a(e,0):d(e,t);if(\"Buffer\"===t.type&&V(t.data))return d(e,t.data)}throw new TypeError(\"First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.\")}(e,t)}function h(e){if(\"number\"!=typeof e)throw new TypeError('\"size\" argument must be a number');if(0>e)throw new RangeError('\"size\" argument must not be negative')}function f(e,t){if(h(t),e=a(e,0>t?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function d(e,t){var r=0>t.length?0:0|p(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(e){if(e>=u())throw new RangeError(\"Attempt to allocate Buffer larger than maximum size: 0x\"+u().toString(16)+\" bytes\");return 0|e}function E(e,t){if(c.isBuffer(e))return e.length;if(\"undefined\"!=typeof ArrayBuffer&&\"function\"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;\"string\"!=typeof e&&(e=\"\"+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case\"ascii\":case\"latin1\":case\"binary\":return r;case\"utf8\":case\"utf-8\":case void 0:return Y(e).length;case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return 2*r;case\"hex\":return r>>>1;case\"base64\":return D(e).length;default:if(n)return Y(e).length;t=(\"\"+t).toLowerCase(),n=!0}}function _(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if(\"string\"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:-2147483648>r&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),0>r&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(0>r){if(!i)return-1;r=0}if(\"string\"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if(\"number\"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&\"function\"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,i);throw new TypeError(\"val must be string, number or Buffer\")}function y(e,t,r,n,i){function o(e,t){return 1==u?e[t]:e.readUInt16BE(t*u)}var s,u=1,a=e.length,c=t.length;if(void 0!==n&&(\"ucs2\"===(n=(n+\"\").toLowerCase())||\"ucs-2\"===n||\"utf16le\"===n||\"utf-16le\"===n)){if(2>e.length||2>t.length)return-1;u=2,a/=2,c/=2,r/=2}if(i){var l=-1;for(s=r;s<a;s++)if(o(e,s)!==o(t,-1==l?0:s-l))-1!=l&&(s-=s-l),l=-1;else if(-1==l&&(l=s),s-l+1===c)return l*u}else for(r+c>a&&(r=a-c),s=r;0<=s;s--){for(var h=!0,f=0;f<c;f++)if(o(e,s+f)!==o(t,f)){h=!1;break}if(h)return s}return-1}function m(e,t,r,n){r=+r||0;var i=e.length-r;n?(n=+n)>i&&(n=i):n=i;var o=t.length;if(0!=o%2)throw new TypeError(\"Invalid hex string\");n>o/2&&(n=o/2);for(var s,u=0;u<n;++u){if(s=parseInt(t.substr(2*u,2),16),isNaN(s))return u;e[r+u]=s}return u}function v(e,t,r,n){return q(Y(t,e.length-r),e,r,n)}function S(e,t,r,n){return q(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function g(e,t,r,n){return S(e,t,r,n)}function R(e,t,r,n){return q(D(t),e,r,n)}function T(e,t,r,n){return q(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!(0>(t-=2));++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?z.fromByteArray(e):z.fromByteArray(e.slice(t,r))}function w(e,t,r){r=s(e.length,r);for(var n=[],i=t;i<r;){var o,u,a,c,l=e[i],h=null,f=239<l?4:223<l?3:191<l?2:1;if(i+f<=r)1==f?128>l&&(h=l):2==f?128==(192&(o=e[i+1]))&&(127<(c=(31&l)<<6|63&o)&&(h=c)):3==f?(o=e[i+1],u=e[i+2],128==(192&o)&&128==(192&u)&&(2047<(c=(15&l)<<12|(63&o)<<6|63&u)&&(55296>c||57343<c)&&(h=c))):4==f&&(o=e[i+1],u=e[i+2],a=e[i+3],128==(192&o)&&128==(192&u)&&128==(192&a)&&(65535<(c=(15&l)<<18|(63&o)<<12|(63&u)<<6|63&a)&&1114112>c&&(h=c)));null===h?(h=65533,f=1):65535<h&&(h-=65536,n.push(55296|1023&h>>>10),h=56320|1023&h),n.push(h),i+=f}return M(n)}function M(e){var t=e.length;if(t<=G)return o.apply(String,e);for(var r=\"\",n=0;n<t;)r+=o.apply(String,e.slice(n,n+=G));return r}function O(e,t,r){var n=\"\";r=s(e.length,r);for(var i=t;i<r;++i)n+=o(127&e[i]);return n}function N(e,t,r){var n=\"\";r=s(e.length,r);for(var i=t;i<r;++i)n+=o(e[i]);return n}function P(e,t,r){var n=e.length;(!t||0>t)&&(t=0),(!r||0>r||r>n)&&(r=n);for(var i=\"\",o=t;o<r;++o)i+=j(e[o]);return i}function I(e,t,r){for(var n=e.slice(t,r),i=\"\",s=0;s<n.length;s+=2)i+=o(n[s]+256*n[s+1]);return i}function F(e,t,r){if(0!=e%1||0>e)throw new RangeError(\"offset is not uint\");if(e+t>r)throw new RangeError(\"Trying to access beyond buffer length\")}function C(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('\"buffer\" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('\"value\" argument is out of bounds');if(r+n>e.length)throw new RangeError(\"Index out of range\")}function x(e,t,r,n){0>t&&(t=65535+t+1);for(var i=0,o=s(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function L(e,t,r,n){0>t&&(t=4294967295+t+1);for(var i=0,o=s(e.length-r,4);i<o;++i)e[r+i]=255&t>>>8*(n?i:3-i)}function U(e,t,r,n){if(r+n>e.length)throw new RangeError(\"Index out of range\");if(0>r)throw new RangeError(\"Index out of range\")}function k(e,t,r,n,i){return i||U(e,0,r,4),X.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,i){return i||U(e,0,r,8),X.write(e,t,r,n,52,8),r+8}function j(e){return 16>e?\"0\"+e.toString(16):e.toString(16)}function Y(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],s=0;s<n;++s){if(55295<(r=e.charCodeAt(s))&&57344>r){if(!i){if(56319<r){-1<(t-=3)&&o.push(239,191,189);continue}if(s+1===n){-1<(t-=3)&&o.push(239,191,189);continue}i=r;continue}if(56320>r){-1<(t-=3)&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(t-=3)&&o.push(239,191,189);if(i=null,128>r){if(0>(t-=1))break;o.push(r)}else if(2048>r){if(0>(t-=2))break;o.push(192|r>>6,128|63&r)}else if(65536>r){if(0>(t-=3))break;o.push(224|r>>12,128|63&r>>6,128|63&r)}else{if(!(1114112>r))throw new Error(\"Invalid code point\");if(0>(t-=4))break;o.push(240|r>>18,128|63&r>>12,128|63&r>>6,128|63&r)}}return o}function D(e){return z.toByteArray(function(e){if(2>(e=function(e){return e.trim?e.trim():e.replace(/^\\s+|\\s+$/g,\"\")}(e).replace(H,\"\")).length)return\"\";for(;0!=e.length%4;)e+=\"=\";return e}(e))}function q(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}var z=r(30),X=r(31),V=r(32);t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0===e.TYPED_ARRAY_SUPPORT?function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&\"function\"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}():e.TYPED_ARRAY_SUPPORT,t.kMaxLength=u(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return l(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,\"undefined\"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,n){return h(t),0>=t?a(e,t):void 0===r?a(e,t):\"string\"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r)}(null,e,t,r)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError(\"Arguments must be Buffers\");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=s(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch((e+\"\").toLowerCase()){case\"hex\":case\"utf8\":case\"utf-8\":case\"ascii\":case\"latin1\":case\"binary\":case\"base64\":case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return!0;default:return!1}},c.concat=function(e,t){if(!V(e))throw new TypeError('\"list\" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(!c.isBuffer(o))throw new TypeError('\"list\" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},c.byteLength=E,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError(\"Buffer size must be a multiple of 16-bits\");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError(\"Buffer size must be a multiple of 32-bits\");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError(\"Buffer size must be a multiple of 64-bits\");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0==e?\"\":0===arguments.length?w(this,0,e):function(e,t,r){var n=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return\"\";if((void 0===r||r>this.length)&&(r=this.length),0>=r)return\"\";if((r>>>=0)<=(t>>>=0))return\"\";for(e||(e=\"utf8\");;)switch(e){case\"hex\":return P(this,t,r);case\"utf8\":case\"utf-8\":return w(this,t,r);case\"ascii\":return O(this,t,r);case\"latin1\":case\"binary\":return N(this,t,r);case\"base64\":return A(this,t,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return I(this,t,r);default:if(n)throw new TypeError(\"Unknown encoding: \"+e);e=(e+\"\").toLowerCase(),n=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e=\"\",r=t.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString(\"hex\",0,r).match(/.{2}/g).join(\" \"),this.length>r&&(e+=\" ... \")),\"<Buffer \"+e+\">\"},c.prototype.compare=function(e,t,r,n,i){if(!c.isBuffer(e))throw new TypeError(\"Argument must be a Buffer\");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),0>t||r>e.length||0>n||i>this.length)throw new RangeError(\"out of range index\");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(r>>>=0)-(t>>>=0),a=s(o,u),l=this.slice(n,i),h=e.slice(t,r),f=0;f<a;++f)if(l[f]!==h[f]){o=l[f],u=h[f];break}return o<u?-1:u<o?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n=\"utf8\",r=this.length,t=0;else if(void 0===r&&\"string\"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error(\"Buffer.write(string, encoding, offset[, length]) is no longer supported\");t|=0,isFinite(r)?(r|=0,void 0===n&&(n=\"utf8\")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),0<e.length&&(0>r||0>t)||t>this.length)throw new RangeError(\"Attempt to write outside buffer bounds\");n||(n=\"utf8\");for(var o=!1;;)switch(n){case\"hex\":return m(this,e,t,r);case\"utf8\":case\"utf-8\":return v(this,e,t,r);case\"ascii\":return S(this,e,t,r);case\"latin1\":case\"binary\":return g(this,e,t,r);case\"base64\":return R(this,e,t,r);case\"ucs2\":case\"ucs-2\":case\"utf16le\":case\"utf-16le\":return T(this,e,t,r);default:if(o)throw new TypeError(\"Unknown encoding: \"+n);n=(\"\"+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:\"Buffer\",data:Array.prototype.slice.call(this._arr||this,0)}};var G=4096;c.prototype.slice=function(e,t){var r,n=this.length;if(0>(e=~~e)?0>(e+=n)&&(e=0):e>n&&(e=n),0>(t=void 0===t?n:~~t)?0>(t+=n)&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;r=new c(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||F(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||F(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUInt8=function(e,t){return t||F(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||F(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||F(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||F(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return n>=(o*=128)&&(n-=i(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||F(e,t,this.length);for(var n=t,o=1,s=this[e+--n];0<n&&(o*=256);)s+=this[e+--n]*o;return s>=(o*=128)&&(s-=i(2,8*t)),s},c.prototype.readInt8=function(e,t){return t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||F(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||F(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||F(e,4,this.length),X.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||F(e,4,this.length),X.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||F(e,8,this.length),X.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||F(e,8,this.length),X.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||C(this,e,t,r,i(2,8*r)-1,0);var o=1,s=0;for(this[t]=255&e;++s<r&&(o*=256);)this[t+s]=255&e/o;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||C(this,e,t,r,i(2,8*r)-1,0);var o=r-1,s=1;for(this[t+o]=255&e;0<=--o&&(s*=256);)this[t+o]=255&e/s;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=n(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=i(2,8*r-1);C(this,e,t,r,o-1,-o)}var s=0,u=1,a=0;for(this[t]=255&e;++s<r&&(u*=256);)0>e&&0==a&&0!==this[t+s-1]&&(a=1),this[t+s]=255&(e/u>>0)-a;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=i(2,8*r-1);C(this,e,t,r,o-1,-o)}var s=r-1,u=1,a=0;for(this[t+s]=255&e;0<=--s&&(u*=256);)0>e&&0==a&&0!==this[t+s+1]&&(a=1),this[t+s]=255&(e/u>>0)-a;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=n(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||C(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),0<n&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError(\"targetStart out of bounds\");if(0>r||r>=this.length)throw new RangeError(\"sourceStart out of bounds\");if(0>n)throw new RangeError(\"sourceEnd out of bounds\");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;0<=i;--i)e[i+t]=this[i+r];else if(1e3>o||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},c.prototype.fill=function(e,t,r,n){if(\"string\"==typeof e){if(\"string\"==typeof t?(n=t,t=0,r=this.length):\"string\"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);256>i&&(e=i)}if(void 0!==n&&\"string\"!=typeof n)throw new TypeError(\"encoding must be a string\");if(\"string\"==typeof n&&!c.isEncoding(n))throw new TypeError(\"Unknown encoding: \"+n)}else\"number\"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<r)throw new RangeError(\"Out of range index\");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),\"number\"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=c.isBuffer(e)?e:Y(new c(e,n).toString()),u=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%u]}return this};var H=/[^+\\/0-9A-Za-z-_]/g}).call(this,r(6))},function(e,t){\"use strict\";function r(e){var t=e.length;if(0<t%4)throw new Error(\"Invalid string. Length must be a multiple of 4\");var r=e.indexOf(\"=\");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function n(e){return o[63&e>>18]+o[63&e>>12]+o[63&e>>6]+o[63&e]}function i(e,t,r){for(var i,o=[],s=t;s<r;s+=3)i=(16711680&e[s]<<16)+(65280&e[s+1]<<8)+(255&e[s+2]),o.push(n(i));return o.join(\"\")}t.byteLength=function(e){var t=r(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=r(e),o=i[0],a=i[1],c=new u(function(e,t,r){return 3*(t+r)/4-r}(0,o,a)),l=0,h=0<a?o-4:o;for(n=0;n<h;n+=4)t=s[e.charCodeAt(n)]<<18|s[e.charCodeAt(n+1)]<<12|s[e.charCodeAt(n+2)]<<6|s[e.charCodeAt(n+3)],c[l++]=255&t>>16,c[l++]=255&t>>8,c[l++]=255&t;return 2===a&&(t=s[e.charCodeAt(n)]<<2|s[e.charCodeAt(n+1)]>>4,c[l++]=255&t),1===a&&(t=s[e.charCodeAt(n)]<<10|s[e.charCodeAt(n+1)]<<4|s[e.charCodeAt(n+2)]>>2,c[l++]=255&t>>8,c[l++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,s=[],u=16383,a=0,c=r-n;a<c;a+=u)s.push(i(e,a,a+u>c?c:a+u));return 1==n?(t=e[r-1],s.push(o[t>>2]+o[63&t<<4]+\"==\")):2==n&&(t=(e[r-2]<<8)+e[r-1],s.push(o[t>>10]+o[63&t>>4]+o[63&t<<2]+\"=\")),s.join(\"\")};for(var o=[],s=[],u=\"undefined\"==typeof Uint8Array?Array:Uint8Array,a=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",c=0,l=a.length;c<l;++c)o[c]=a[c],s[a.charCodeAt(c)]=c;s[45]=62,s[95]=63},function(e,t){var r=Math.pow;t.read=function(e,t,n,i,o){var s,u,a=8*o-i-1,c=(1<<a)-1,l=c>>1,h=-7,f=n?o-1:0,d=n?-1:1,p=e[t+f];for(f+=d,s=p&(1<<-h)-1,p>>=-h,h+=a;0<h;s=256*s+e[t+f],f+=d,h-=8);for(u=s&(1<<-h)-1,s>>=-h,h+=i;0<h;u=256*u+e[t+f],f+=d,h-=8);if(0===s)s=1-l;else{if(s===c)return u?NaN:1/0*(p?-1:1);u+=r(2,i),s-=l}return(p?-1:1)*u*r(2,s-i)},t.write=function(e,t,n,i,o,s){var u,a,c,l=8*s-o-1,h=(1<<l)-1,f=h>>1,d=23===o?5.960464477539062e-8:0,p=i?0:s-1,E=i?1:-1,_=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,u=h):(u=Math.floor(Math.log(t)/Math.LN2),1>t*(c=r(2,-u))&&(u--,c*=2),2<=(t+=1<=u+f?d/c:d*r(2,1-f))*c&&(u++,c/=2),u+f>=h?(a=0,u=h):1<=u+f?(a=(t*c-1)*r(2,o),u+=f):(a=t*r(2,f-1)*r(2,o),u=0));8<=o;e[n+p]=255&a,p+=E,a/=256,o-=8);for(u=u<<o|a,l+=o;0<l;e[n+p]=255&u,p+=E,u/=256,l-=8);e[n+p-E]|=128*_}},function(e){var t={}.toString;e.exports=Array.isArray||function(e){return\"[object Array]\"==t.call(e)}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(2),i=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),o=r(1),s=r(34),u=r(15),a=r(5);t.default=class{constructor(e){this._cancel=null,this._config=e,this._connection=null,this._socket=null}close(){this._config.transport.close()}connect(){return(0,i.default)(!this._connection,\"RSocketClient: Unexpected call to connect(), already connected.\"),this._connection=new n.Single(e=>{const t=this._config.transport;let r;t.connectionStatus().subscribe({onNext:n=>{\"CONNECTED\"===n.kind?(r&&r.cancel(),e.onComplete(new c(this._config,t))):\"ERROR\"===n.kind?(r&&r.cancel(),e.onError(n.error)):\"CLOSED\"===n.kind&&(r&&r.cancel(),e.onError(new Error(\"RSocketClient: Connection closed.\")))},onSubscribe:t=>{e.onSubscribe(()=>t.cancel()),(r=t).request(Number.MAX_SAFE_INTEGER)}}),t.connect()}),this._connection}};class c{constructor(e,t){let r,i;const s=e.leases;if(s){const e=s();r=new a.RequesterLeaseHandler(e._receiver),i=new a.ResponderLeaseHandler(e._sender,e._stats)}this._machine=(0,u.createClientMachine)(t,e=>t.receive().subscribe(e),e.serializers,e.responder,r,i),t.sendOne(this._buildSetupFrame(e));const{keepAlive:c}=e.setup,l=e.navigator;3e4<c&&l&&l.userAgent&&(l.userAgent.includes(\"Trident\")||l.userAgent.includes(\"Edg\"))&&console.warn(\"rsocket-js: Due to a browser bug, Internet Explorer and Edge users may experience WebSocket instability with keepAlive values longer than 30 seconds.\");const h=(0,n.every)(c).map(()=>({data:null,flags:o.FLAGS.RESPOND,lastReceivedPosition:0,streamId:o.CONNECTION_STREAM_ID,type:o.FRAME_TYPES.KEEPALIVE}));t.send(h)}fireAndForget(e){this._machine.fireAndForget(e)}requestResponse(e){return this._machine.requestResponse(e)}requestStream(e){return this._machine.requestStream(e)}requestChannel(e){return this._machine.requestChannel(e)}metadataPush(e){return this._machine.metadataPush(e)}close(){this._machine.close()}connectionStatus(){return this._machine.connectionStatus()}availability(){return this._machine.availability()}_buildSetupFrame(e){const{dataMimeType:t,keepAlive:r,lifetime:n,metadata:i,metadataMimeType:u,data:a}=e.setup;let c=0;return void 0!==i&&(c|=o.FLAGS.METADATA),{data:a,dataMimeType:t,flags:c|(e.leases?o.FLAGS.LEASE:0),keepAlive:r,lifetime:n,majorVersion:s.MAJOR_VERSION,metadata:i,metadataMimeType:u,minorVersion:s.MINOR_VERSION,resumeToken:null,streamId:o.CONNECTION_STREAM_ID,type:o.FRAME_TYPES.SETUP}}}},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});t.MAJOR_VERSION=1,t.MINOR_VERSION=0},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});r(2);var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=r(1),o=r(8),s=r(15),u=r(5);t.default=class{constructor(e){this._handleTransportComplete=(()=>{this._handleTransportError(new Error(\"RSocketServer: Connection closed unexpectedly.\"))}),this._handleTransportError=(()=>{this._connections.forEach(e=>{e.close()})}),this._handleTransportConnection=(e=>{const t=new a;let r;e.receive().subscribe(t.swap({onError:e=>console.error(e),onNext:r=>{switch(r.type){case i.FRAME_TYPES.RESUME:e.sendOne({code:i.ERROR_CODES.REJECTED_RESUME,flags:0,message:\"RSocketServer: RESUME not supported.\",streamId:i.CONNECTION_STREAM_ID,type:i.FRAME_TYPES.ERROR}),e.close();break;case i.FRAME_TYPES.SETUP:if(this._setupLeaseError(r)){e.sendOne({code:i.ERROR_CODES.INVALID_SETUP,flags:0,message:\"RSocketServer: LEASE not supported.\",streamId:i.CONNECTION_STREAM_ID,type:i.FRAME_TYPES.ERROR}),e.close();break}const o=this._getSerializers();let a,c;const l=this._config.leases;if(l){const e=l();a=new u.RequesterLeaseHandler(e._receiver),c=new u.ResponderLeaseHandler(e._sender,e._stats)}const h=(0,s.createServerMachine)(e,e=>{t.swap(e)},o,a,c);try{const e=this._config.getRequestHandler(h,function(e,t){return{data:e.data.deserialize(t.data),metadata:e.metadata.deserialize(t.metadata)}}(o,r));h.setRequestHandler(e),this._connections.add(h)}catch(t){e.sendOne({code:i.ERROR_CODES.REJECTED_SETUP,flags:0,message:\"Application rejected setup, reason: \"+t.message,streamId:i.CONNECTION_STREAM_ID,type:i.FRAME_TYPES.ERROR}),e.close()}break;default:(0,n.default)(!1,\"RSocketServer: Expected first frame to be SETUP or RESUME, got `%s`.\",(0,i.getFrameTypeName)(r.type))}},onSubscribe:e=>{(r=e).request(1)}}))}),this._config=e,this._connections=new Set,this._started=!1,this._subscription=null}start(){(0,n.default)(!this._started,\"RSocketServer: Unexpected call to start(), already started.\"),this._started=!0,this._config.transport.start().subscribe({onComplete:this._handleTransportComplete,onError:this._handleTransportError,onNext:this._handleTransportConnection,onSubscribe:e=>{this._subscription=e,e.request(Number.MAX_SAFE_INTEGER)}})}stop(){this._subscription&&this._subscription.cancel(),this._config.transport.stop(),this._handleTransportError(new Error(\"RSocketServer: Connection terminated via stop().\"))}_getSerializers(){return this._config.serializers||o.IdentitySerializers}_setupLeaseError(e){const t=(e.flags&i.FLAGS.LEASE)===i.FLAGS.LEASE,r=this._config.leases;return t&&!r}};class a{constructor(e){this._target=e}swap(e){return this._target=e,this._subscription&&this._target.onSubscribe&&this._target.onSubscribe(this._subscription),this}onComplete(){(0,n.default)(this._target,\"must have target\"),this._target.onComplete&&this._target.onComplete()}onError(e){(0,n.default)(this._target,\"must have target\"),this._target.onError&&this._target.onError(e)}onNext(e){(0,n.default)(this._target,\"must have target\"),this._target.onNext&&this._target.onNext(e)}onSubscribe(e){(0,n.default)(this._target,\"must have target\"),this._subscription=e,this._target.onSubscribe&&this._target.onSubscribe(e)}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(2),i=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),o=r(1),s=r(16),u=r(12);t.default=class{constructor(e,t,r){(0,i.default)(0<=t.bufferSize,\"RSocketResumableTransport: bufferSize option must be >= 0, got `%s`.\",t.bufferSize),this._encoders=r,this._bufferSize=t.bufferSize,this._sentFramesSize=0,this._position={client:0,server:0},this._currentConnection=null,this._statusSubscription=null,this._receiveSubscription=null,this._receivers=new Set,this._resumeToken=t.resumeToken,this._sessionTimeoutMillis=1e3*t.sessionDurationSeconds,this._sessionTimeoutHandle=null,this._senders=new Set,this._sentFrames=[],this._setupFrame=null,this._source=e,this._status=s.CONNECTION_STATUS.NOT_CONNECTED,this._statusSubscribers=new Set}close(){this._close()}connect(){(0,i.default)(!this._isTerminated(),\"RSocketResumableTransport: Cannot connect(), connection terminated (%s: %s).\",this._status.kind,\"ERROR\"===this._status.kind?this._status.error.message:\"no message\");try{this._disconnect(),this._currentConnection=null,this._receiveSubscription=null,this._statusSubscription=null,this._setConnectionStatus(s.CONNECTION_STATUS.CONNECTING);const e=this._source();e.connectionStatus().subscribe({onNext:t=>{t.kind===this._status.kind||(\"CONNECTED\"===t.kind?(this._sessionTimeoutHandle&&(clearTimeout(this._sessionTimeoutHandle),this._sessionTimeoutHandle=null),null==this._setupFrame?this._handleConnected(e):this._handleResume(e)):this._isTerminationStatus(t)&&(!this._sessionTimeoutHandle&&(this._sessionTimeoutHandle=setTimeout(()=>this._close(this._resumeTimeoutError()),this._sessionTimeoutMillis)),this._disconnect(),this._setConnectionStatus(s.CONNECTION_STATUS.NOT_CONNECTED)))},onSubscribe:e=>{this._statusSubscription=e,e.request(Number.MAX_SAFE_INTEGER)}}),e.connect()}catch(e){this._close(e)}}connectionStatus(){return new n.Flowable(e=>{e.onSubscribe({cancel:()=>{this._statusSubscribers.delete(e)},request:()=>{this._statusSubscribers.add(e),e.onNext(this._status)}})})}receive(){return new n.Flowable(e=>{let t=!1;e.onSubscribe({cancel:()=>{this._receivers.delete(e)},request:()=>{t||(t=!0,this._receivers.add(e))}})})}sendOne(e){try{this._writeFrame(e)}catch(e){this._close(e)}}send(e){let t;e.subscribe({onComplete:()=>{t&&this._senders.delete(t)},onError:e=>{t&&this._senders.delete(t),this._close(e)},onNext:e=>this._writeFrame(e),onSubscribe:e=>{t=e,this._senders.add(t),t.request(Number.MAX_SAFE_INTEGER)}})}_close(e){if(!this._isTerminated()){e?this._setConnectionStatus({error:e,kind:\"ERROR\"}):this._setConnectionStatus(s.CONNECTION_STATUS.CLOSED);const t=this._receivers;t.forEach(e=>e.onComplete()),t.clear();const r=this._senders;r.forEach(e=>e.cancel()),r.clear(),this._sentFrames.length=0,this._disconnect()}}_disconnect(){this._statusSubscription&&(this._statusSubscription.cancel(),this._statusSubscription=null),this._receiveSubscription&&(this._receiveSubscription.cancel(),this._receiveSubscription=null),this._currentConnection&&(this._currentConnection.close(),this._currentConnection=null)}_handleConnected(e){this._currentConnection=e,this._flushFrames(),this._setConnectionStatus(s.CONNECTION_STATUS.CONNECTED),e.receive().subscribe({onNext:e=>{try{this._receiveFrame(e)}catch(e){this._close(e)}},onSubscribe:e=>{this._receiveSubscription=e,e.request(Number.MAX_SAFE_INTEGER)}})}_handleResume(e){e.receive().take(1).subscribe({onNext:t=>{try{if(t.type===o.FRAME_TYPES.RESUME_OK){const{clientPosition:r}=t;if(r<this._position.client)return void this._close(this._nonResumableStateError());let n=r-this._position.client,i=0;for(;0<n;){const e=this._onReleasedTailFrame(this._sentFrames[i]);if(!e)return void this._close(this._absentLengthError(t));n-=e,i++}if(0!==n)return void this._close(this._inconsistentImpliedPositionError());0<i&&this._sentFrames.splice(0,i),this._handleConnected(e)}else{const e=t.type===o.FRAME_TYPES.ERROR?(0,o.createErrorFromFrame)(t):new Error(\"RSocketResumableTransport: Resumption failed for an unspecified reason.\");this._close(e)}}catch(e){this._close(e)}},onSubscribe:e=>{this._receiveSubscription=e,e.request(1)}});const t=this._setupFrame;(0,i.default)(t,\"RSocketResumableTransport: Cannot resume, setup frame has not been sent.\"),e.sendOne({clientPosition:this._position.client,flags:0,majorVersion:t.majorVersion,minorVersion:t.minorVersion,resumeToken:this._resumeToken,serverPosition:this._position.server,streamId:o.CONNECTION_STREAM_ID,type:o.FRAME_TYPES.RESUME})}_absentLengthError(e){return new Error(\"RSocketResumableTransport: absent frame.length for type \"+e.type)}_inconsistentImpliedPositionError(){return new Error(\"RSocketResumableTransport: local frames are inconsistent with remote implied position\")}_nonResumableStateError(){return new Error(\"RSocketResumableTransport: resumption failed, server is missing frames that are no longer in the client buffer.\")}_resumeTimeoutError(){return new Error(\"RSocketResumableTransport: resumable session timed out\")}_isTerminated(){return this._isTerminationStatus(this._status)}_isTerminationStatus(e){const t=e.kind;return\"CLOSED\"===t||\"ERROR\"===t}_setConnectionStatus(e){e.kind===this._status.kind||(this._status=e,this._statusSubscribers.forEach(t=>t.onNext(e)))}_receiveFrame(e){(0,o.isResumePositionFrameType)(e.type)&&(this._position.server+=e.length),this._receivers.forEach(t=>t.onNext(e))}_flushFrames(){this._sentFrames.forEach(e=>{const t=this._currentConnection;t&&t.sendOne(e)})}_onReleasedTailFrame(e){const t=e.length;if(t)return this._sentFramesSize-=t,this._position.client+=t,t}_writeFrame(e){if(e.type===o.FRAME_TYPES.SETUP&&(e=Object.assign({},e,{flags:e.flags|o.FLAGS.RESUME_ENABLE,resumeToken:this._resumeToken}),this._setupFrame=e),e.length=(0,u.sizeOfFrame)(e,this._encoders),(0,o.isResumePositionFrameType)(e.type)){let t=this._bufferSize-this._sentFramesSize;const r=e.length;if(!r)return void this._close(this._absentLengthError(e));for(;t<r;){const r=this._sentFrames.shift();if(!r)break;{const n=this._onReleasedTailFrame(r);if(!n)return void this._close(this._absentLengthError(e));t+=n}}t>=r?(this._sentFrames.push(e),this._sentFramesSize+=r):this._position.client+=r}const t=this._currentConnection;t&&t.sendOne(e)}}},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.CONNECTION_STATUS={CLOSED:Object.freeze({kind:\"CLOSED\"}),CONNECTED:Object.freeze({kind:\"CONNECTED\"}),CONNECTING:Object.freeze({kind:\"CONNECTING\"}),NOT_CONNECTED:Object.freeze({kind:\"NOT_CONNECTED\"})}},function(){},function(e,t,r){\"use strict\";function n(e,t){function r(){this.constructor=e}de(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function i(e){return\"function\"==typeof e}function o(e){setTimeout(function(){throw e},0)}function s(e){return null!==e&&\"object\"==typeof e}function u(e){return e.reduce(function(e,t){return e.concat(t instanceof ye?t.errors:t)},[])}function a(e){for(;e;){var t=e,r=t.closed,n=t.destination,i=t.isStopped;if(r||i)return!1;e=n&&n instanceof Se?n:null}return!0}function c(e){return e}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return h(e)}function h(e){return 0===e.length?c:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}function f(e){if(e||(e=Ee.Promise||Promise),!e)throw new Error(\"no Promise impl found\");return e}function d(e){return e?function(e){return new Te(function(t){return e.schedule(function(){return t.complete()})})}(e):Ge}function p(e){return e&&\"function\"==typeof e.schedule}function E(e,t){return new Te(function(r){var n=new me,i=0;return n.add(t.schedule(function(){return i===e.length?void r.complete():(r.next(e[i++]),void(!r.closed&&n.add(this.schedule())))})),n})}function _(e,t){return t?E(e,t):new Te(He(e))}function b(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[e.length-1];return p(r)?(e.pop(),E(e,r)):_(e)}function y(e,t){return new Te(t?function(r){return t.schedule(m,0,{error:e,subscriber:r})}:function(t){return t.error(e)})}function m(e){var t=e.error;e.subscriber.error(t)}function v(e){return!!(e in rt)&&(delete rt[e],!0)}function S(){}function g(e){return!!e&&(e instanceof Te||\"function\"==typeof e.lift&&\"function\"==typeof e.subscribe)}function R(e,t){return function(r){if(\"function\"!=typeof e)throw new TypeError(\"argument is not a function. Are you looking for `mapTo()`?\");return r.lift(new _t(e,t))}}function T(e,t,r){if(t){if(!p(t))return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return T(e,r).apply(void 0,n).pipe(R(function(e){return be(e)?t.apply(void 0,e):t(e)}))};r=t}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i,o=this,s={context:o,subject:i,callbackFunc:e,scheduler:r};return new Te(function(n){if(!r){if(!i){i=new Ze;try{e.apply(o,t.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.next(1>=e.length?e[0]:e),i.complete()}]))}catch(e){a(i)?i.error(e):console.warn(e)}}return i.subscribe(n)}return r.schedule(A,0,{args:t,subscriber:n,params:s})})}}function A(e){var t=this,r=e.args,n=e.subscriber,i=e.params,o=i.callbackFunc,s=i.context,u=i.scheduler,a=i.subject;if(!a){a=i.subject=new Ze;try{o.apply(s,r.concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=1>=e.length?e[0]:e;t.add(u.schedule(w,0,{value:n,subject:a}))}]))}catch(e){a.error(e)}}this.add(a.subscribe(n))}function w(e){var t=e.value,r=e.subject;r.next(t),r.complete()}function M(e,t,r){if(t){if(!p(t))return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return M(e,r).apply(void 0,n).pipe(R(function(e){return be(e)?t.apply(void 0,e):t(e)}))};r=t}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i={subject:void 0,args:t,callbackFunc:e,scheduler:r,context:this};return new Te(function(n){var o=i.context,s=i.subject;if(!r){if(!s){s=i.subject=new Ze;try{e.apply(o,t.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.shift();return r?void s.error(r):(s.next(1>=e.length?e[0]:e),void s.complete())}]))}catch(e){a(s)?s.error(e):console.warn(e)}}return s.subscribe(n)}return r.schedule(O,0,{params:i,subscriber:n,context:o})})}}function O(e){var t=this,r=e.params,n=e.subscriber,i=e.context,o=r.callbackFunc,s=r.args,u=r.scheduler,a=r.subject;if(!a){a=r.subject=new Ze;try{o.apply(i,s.concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e.shift();if(n)t.add(u.schedule(P,0,{err:n,subject:a}));else{var i=1>=e.length?e[0]:e;t.add(u.schedule(N,0,{value:i,subject:a}))}}]))}catch(e){this.add(u.schedule(P,0,{err:e,subject:a}))}}this.add(a.subscribe(n))}function N(e){var t=e.value,r=e.subject;r.next(t),r.complete()}function P(e){var t=e.err;e.subject.error(t)}function I(e){return!!e&&\"function\"!=typeof e.subscribe&&\"function\"==typeof e.then}function F(e,t,r,n,i){return void 0===i&&(i=new mt(e,r,n)),i.closed?void 0:t instanceof Te?t.subscribe(i):gt(t)(i)}function C(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=void 0,n=void 0;return p(e[e.length-1])&&(n=e.pop()),\"function\"==typeof e[e.length-1]&&(r=e.pop()),1===e.length&&be(e[0])&&(e=e[0]),_(e,n).lift(new Tt(r))}function x(e,t){if(null!=e){if(function(e){return e&&\"function\"==typeof e[Re]}(e))return function(e,t){return new Te(function(r){var n=new me;return n.add(t.schedule(function(){var i=e[Re]();n.add(i.subscribe({next:function(e){n.add(t.schedule(function(){return r.next(e)}))},error:function(e){n.add(t.schedule(function(){return r.error(e)}))},complete:function(){n.add(t.schedule(function(){return r.complete()}))}}))})),n})}(e,t);if(I(e))return function(e,t){return new Te(function(r){var n=new me;return n.add(t.schedule(function(){return e.then(function(e){n.add(t.schedule(function(){r.next(e),n.add(t.schedule(function(){return r.complete()}))}))},function(e){n.add(t.schedule(function(){return r.error(e)}))})})),n})}(e,t);if(St(e))return E(e,t);if(function(e){return e&&\"function\"==typeof e[vt]}(e)||\"string\"==typeof e)return function(e,t){if(!e)throw new Error(\"Iterable cannot be null\");return new Te(function(r){var n,i=new me;return i.add(function(){n&&\"function\"==typeof n.return&&n.return()}),i.add(t.schedule(function(){n=e[vt](),i.add(t.schedule(function(){if(!r.closed){var e,t;try{var i=n.next();e=i.value,t=i.done}catch(e){return void r.error(e)}t?r.complete():(r.next(e),this.schedule())}}))})),i})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+\" is not observable\")}function L(e,t){return t?x(e,t):e instanceof Te?e:new Te(gt(e))}function U(e,t){return t.closed?void 0:e instanceof Te?e.subscribe(t):gt(e)(t)}function k(e){return void 0===e&&(e=he),function e(t,r,n){return void 0===n&&(n=he),\"function\"==typeof r?function(i){return i.pipe(e(function(e,n){return L(t(e,n)).pipe(R(function(t,i){return r(e,t,n,i)}))},n))}:(\"number\"==typeof r&&(n=r),function(e){return e.lift(new Ot(t,n))})}(c,e)}function B(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return k(1)(b.apply(void 0,e))}function j(e){return new Te(function(t){var r;try{r=e()}catch(e){return void t.error(e)}return(r?L(r):d()).subscribe(t)})}function Y(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var r=e[0];if(be(r))return D(r,null);if(s(r)&&Object.getPrototypeOf(r)===Object.prototype){var n=Object.keys(r);return D(n.map(function(e){return r[e]}),n)}}if(\"function\"==typeof e[e.length-1]){var i=e.pop();return D(e=1===e.length&&be(e[0])?e[0]:e,null).pipe(R(function(e){return i.apply(void 0,e)}))}return D(e,null)}function D(e,t){return new Te(function(r){var n=e.length;if(0!==n)for(var i=Array(n),o=0,s=0,u=function(u){var a=L(e[u]),c=!1;r.add(a.subscribe({next:function(e){c||(c=!0,s++),i[u]=e},error:function(e){return r.error(e)},complete:function(){++o!==n&&c||(s===n&&r.next(t?t.reduce(function(e,t,r){return e[t]=i[r],e},{}):i),r.complete())}}))},a=0;a<n;a++)u(a);else r.complete()})}function q(e,t,r,n){return i(r)&&(n=r,r=void 0),n?q(e,t,r).pipe(R(function(e){return be(e)?n.apply(void 0,e):n(e)})):new Te(function(n){!function e(t,r,n,i,o){var s;if(function(e){return e&&\"function\"==typeof e.addEventListener&&\"function\"==typeof e.removeEventListener}(t))t.addEventListener(r,n,o),s=function(){return t.removeEventListener(r,n,o)};else if(function(e){return e&&\"function\"==typeof e.on&&\"function\"==typeof e.off}(t))t.on(r,n),s=function(){return t.off(r,n)};else if(function(e){return e&&\"function\"==typeof e.addListener&&\"function\"==typeof e.removeListener}(t))t.addListener(r,n),s=function(){return t.removeListener(r,n)};else{if(!t||!t.length)throw new TypeError(\"Invalid event target\");for(var u=0,a=t.length;u<a;u++)e(t[u],r,n,i,o)}i.add(s)}(e,t,function(e){1<arguments.length?n.next(Array.prototype.slice.call(arguments)):n.next(e)},n,r)})}function z(e,t,r){return r?z(e,t).pipe(R(function(e){return be(e)?r.apply(void 0,e):r(e)})):new Te(function(r){var n,o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.next(1===e.length?e[0]:e)};try{n=e(o)}catch(e){return void r.error(e)}return i(t)?function(){return t(o,n)}:void 0})}function X(e,t,r,n,i){var o,s;if(1==arguments.length){var u=e;s=u.initialState,t=u.condition,r=u.iterate,o=u.resultSelector||c,i=u.scheduler}else void 0===n||p(n)?(s=e,o=c,i=n):(s=e,o=n);return new Te(function(e){var n=s;if(i)return i.schedule(V,0,{subscriber:e,iterate:r,condition:t,resultSelector:o,state:n});for(;;){if(t){var u=void 0;try{u=t(n)}catch(t){return void e.error(t)}if(!u){e.complete();break}}var a=void 0;try{a=o(n)}catch(t){return void e.error(t)}if(e.next(a),e.closed)break;try{n=r(n)}catch(t){return void e.error(t)}}})}function V(e){var t=e.subscriber,r=e.condition;if(!t.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(e){return void t.error(e)}else e.needIterate=!0;if(r){var n;try{n=r(e.state)}catch(e){return void t.error(e)}if(!n)return void t.complete();if(t.closed)return}var i;try{i=e.resultSelector(e.state)}catch(e){return void t.error(e)}if(!t.closed)return t.next(i),t.closed?void 0:this.schedule(e)}}function G(e,t,r){return void 0===t&&(t=Ge),void 0===r&&(r=Ge),j(function(){return e()?t:r})}function H(e){return!be(e)&&0<=e-parseFloat(e)+1}function Q(e,t){return void 0===e&&(e=0),void 0===t&&(t=at),(!H(e)||0>e)&&(e=0),t&&\"function\"==typeof t.schedule||(t=at),new Te(function(r){return r.add(t.schedule(W,e,{subscriber:r,counter:0,period:e})),r})}function W(e){var t=e.subscriber,r=e.counter,n=e.period;t.next(r),this.schedule({subscriber:t,counter:r+1,period:n},n)}function K(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=he,n=null,i=e[e.length-1];return p(i)?(n=e.pop(),1<e.length&&\"number\"==typeof e[e.length-1]&&(r=e.pop())):\"number\"==typeof i&&(r=e.pop()),null===n&&1===e.length&&e[0]instanceof Te?e[0]:k(r)(_(e,n))}function J(){return Pt}function $(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return Ge;var r=e[0],n=e.slice(1);return 1===e.length&&be(r)?$.apply(void 0,r):new Te(function(e){var t=function(){return e.add($.apply(void 0,n).subscribe(e))};return L(r).subscribe({next:function(t){e.next(t)},error:t,complete:t})})}function Z(e,t){return new Te(t?function(r){var n=Object.keys(e),i=new me;return i.add(t.schedule(ee,0,{keys:n,index:0,subscriber:r,subscription:i,obj:e})),i}:function(t){for(var r,n=Object.keys(e),i=0;i<n.length&&!t.closed;i++)r=n[i],e.hasOwnProperty(r)&&t.next([r,e[r]]);t.complete()})}function ee(e){var t=e.keys,r=e.index,n=e.subscriber,i=e.subscription,o=e.obj;if(!n.closed)if(r<t.length){var s=t[r];n.next([s,o[s]]),i.add(this.schedule({keys:t,index:r+1,subscriber:n,subscription:i,obj:o}))}else n.complete()}function te(e,t){function r(){return!r.pred.apply(r.thisArg,arguments)}return r.pred=e,r.thisArg=t,r}function re(e,t){return function(r){return r.lift(new It(e,t))}}function ne(e,t,r){return[re(t,r)(new Te(gt(e))),re(te(t,r))(new Te(gt(e)))]}function ie(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){if(!be(e[0]))return e[0];e=e[0]}return _(e,void 0).lift(new Ct)}function oe(e,t,r){return void 0===e&&(e=0),new Te(function(n){void 0===t&&(t=e,e=0);var i=0,o=e;if(r)return r.schedule(se,0,{index:i,count:t,start:e,subscriber:n});for(;;){if(i++>=t){n.complete();break}if(n.next(o++),n.closed)break}})}function se(e){var t=e.start,r=e.index,n=e.count,i=e.subscriber;r>=n?i.complete():(i.next(t),i.closed||(e.index=r+1,e.start=t+1,this.schedule(e)))}function ue(e,t,r){void 0===e&&(e=0);var n=-1;return H(t)?n=1>+t?1:+t:p(t)&&(r=t),p(r)||(r=at),new Te(function(t){var i=H(e)?e:+e-r.now();return r.schedule(ae,i,{index:0,period:n,subscriber:t})})}function ae(e){var t=e.index,r=e.period,n=e.subscriber;if(n.next(t),!n.closed)return-1===r?n.complete():(e.index=t+1,void this.schedule(e,r))}function ce(e,t){return new Te(function(r){var n,i;try{n=e()}catch(e){return void r.error(e)}try{i=t(n)}catch(e){return void r.error(e)}var o=(i?L(i):Ge).subscribe(r);return function(){o.unsubscribe(),n&&n.unsubscribe()}})}function le(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[e.length-1];return\"function\"==typeof r&&e.pop(),_(e,void 0).lift(new Lt(r))}var he=Number.POSITIVE_INFINITY;r.r(t);var fe,de=function(e,t){return(de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},pe=!1,Ee={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn(\"DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n\"+t.stack)}else pe&&console.log(\"RxJS: Back to a better error behavior. Thank you. <3\");pe=e},get useDeprecatedSynchronousErrorHandling(){return pe}},_e={closed:!0,next:function(){},error:function(e){if(Ee.useDeprecatedSynchronousErrorHandling)throw e;o(e)},complete:function(){}},be=Array.isArray||function(e){return e&&\"number\"==typeof e.length},ye=function(){function e(e){return Error.call(this),this.message=e?e.length+\" errors occurred during unsubscription:\\n\"+e.map(function(e,t){return t+1+\") \"+e.toString()}).join(\"\\n  \"):\"\",this.name=\"UnsubscriptionError\",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),me=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this,n=r._parentOrParents,o=r._ctorUnsubscribe,a=r._unsubscribe,c=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var l=0;l<n.length;++l)n[l].remove(this);if(i(a)){o&&(this._unsubscribe=void 0);try{a.call(this)}catch(r){t=r instanceof ye?u(r.errors):[r]}}if(be(c)){l=-1;for(var h,f=c.length;++l<f;)if(s(h=c[l]))try{h.unsubscribe()}catch(r){t=t||[],r instanceof ye?t=t.concat(u(r.errors)):t.push(r)}}if(t)throw new ye(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case\"function\":r=new e(t);case\"object\":if(r===this||r.closed||\"function\"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error(\"unrecognized teardown \"+t+\" added to Subscription.\")}var i=r._parentOrParents;if(null===i)r._parentOrParents=this;else if(i instanceof e){if(i===this)return r;r._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return r;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[r]:o.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}(),ve=\"function\"==typeof Symbol?Symbol(\"rxSubscriber\"):\"@@rxSubscriber_\"+Math.random(),Se=function(e){function t(r,n,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=_e;break;case 1:if(!r){o.destination=_e;break}if(\"object\"==typeof r){r instanceof t?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new ge(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new ge(o,r,n,i)}return o}return n(t,e),t.prototype[ve]=function(){return this},t.create=function(e,r,n){var i=new t(e,r,n);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(me),ge=function(e){function t(t,r,n,o){var s=e.call(this)||this;s._parentSubscriber=t;var u,a=s;return i(r)?u=r:r&&(u=r.next,n=r.error,o=r.complete,r!==_e&&(i((a=Object.create(r)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=u,s._error=n,s._complete=o,s}return n(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;Ee.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=Ee.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):o(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;o(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};Ee.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),Ee.useDeprecatedSynchronousErrorHandling)throw e;o(e)}},t.prototype.__tryOrSetError=function(e,t,r){if(!Ee.useDeprecatedSynchronousErrorHandling)throw new Error(\"bad call\");try{t.call(this._context,r)}catch(t){return Ee.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(o(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Se),Re=\"function\"==typeof Symbol&&Symbol.observable||\"@@observable\",Te=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,i=function(e,t,r){if(e){if(e instanceof Se)return e;if(e[ve])return e[ve]()}return e||t||r?new Se(e,t,r):new Se(_e)}(e,t,r);if(n?i.add(n.call(i,this.source)):i.add(this.source||Ee.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),Ee.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){Ee.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),a(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=f(t))(function(t,n){var i=r.subscribe(function(t){try{e(t)}catch(e){n(e),i&&i.unsubscribe()}},n,t)})},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[Re]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:h(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=f(e))(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})},e.create=function(t){return new e(t)},e}(),Ae=function(){function e(){return Error.call(this),this.message=\"object unsubscribed\",this.name=\"ObjectUnsubscribedError\",this}return e.prototype=Object.create(Error.prototype),e}(),we=function(e){function t(t,r){var n=e.call(this)||this;return n.subject=t,n.subscriber=r,n.closed=!1,n}return n(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},t}(me),Me=function(e){function t(t){var r=e.call(this,t)||this;return r.destination=t,r}return n(t,e),t}(Se),Oe=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return n(t,e),t.prototype[ve]=function(){return new Me(this)},t.prototype.lift=function(e){var t=new Ne(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new Ae;if(!this.isStopped)for(var t=this.observers,r=t.length,n=t.slice(),i=0;i<r;i++)n[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new Ae;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,n=t.slice(),i=0;i<r;i++)n[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new Ae;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++)r[n].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new Ae;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new Ae;return this.hasError?(e.error(this.thrownError),me.EMPTY):this.isStopped?(e.complete(),me.EMPTY):(this.observers.push(e),new we(this,e))},t.prototype.asObservable=function(){var e=new Te;return e.source=this,e},t.create=function(e,t){return new Ne(e,t)},t}(Te),Ne=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return n(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):me.EMPTY},t}(Oe),Pe=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var r=this.connectable;r._refCount++;var n=new Ie(e,r),i=t.subscribe(n);return n.closed||(n.connection=r.connect()),i},e}(),Ie=function(e){function t(t,r){var n=e.call(this,t)||this;return n.connectable=r,n}return n(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(0>=t)this.connection=null;else if(e._refCount=t-1,1<t)this.connection=null;else{var r=this.connection,n=e._connection;this.connection=null,n&&(!r||n===r)&&n.unsubscribe()}}else this.connection=null},t}(Se),Fe=function(e){function t(t,r){var n=e.call(this)||this;return n.source=t,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return n(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new me).add(this.source.subscribe(new Ce(this.getSubject(),this))),e.closed&&(this._connection=null,e=me.EMPTY)),e},t.prototype.refCount=function(){return(e=this).lift(new Pe(e));var e},t}(Te),Ce=(function(){var e=Fe.prototype;e._subscribe,e._isComplete,e.getSubject,e.connect,e.refCount}(),function(e){function t(t,r){var n=e.call(this,t)||this;return n.connectable=r,n}return n(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(Me)),xe=(function(){function e(e){this.connectable=e}e.prototype.call=function(e,t){var r=this.connectable;r._refCount++;var n=new xe(e,r),i=t.subscribe(n);return n.closed||(n.connection=r.connect()),i}}(),function(e){function t(t,r){var n=e.call(this,t)||this;return n.connectable=r,n}return n(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(0>=t)this.connection=null;else if(e._refCount=t-1,1<t)this.connection=null;else{var r=this.connection,n=e._connection;this.connection=null,n&&(!r||n===r)&&n.unsubscribe()}}else this.connection=null},t}(Se)),Le=(function(){function e(e,t,r,n){this.keySelector=e,this.elementSelector=t,this.durationSelector=r,this.subjectSelector=n}e.prototype.call=function(e,t){return t.subscribe(new Le(e,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))}}(),function(e){function t(t,r,n,i,o){var s=e.call(this,t)||this;return s.keySelector=r,s.elementSelector=n,s.durationSelector=i,s.subjectSelector=o,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}return n(t,e),t.prototype._next=function(e){var t;try{t=this.keySelector(e)}catch(e){return void this.error(e)}this._group(e,t)},t.prototype._group=function(e,t){var r=this.groups;r||(r=this.groups=new Map);var n,i=r.get(t);if(this.elementSelector)try{n=this.elementSelector(e)}catch(e){this.error(e)}else n=e;if(!i){i=this.subjectSelector?this.subjectSelector():new Oe,r.set(t,i);var o=new ke(t,i,this);if(this.destination.next(o),this.durationSelector){var s;try{s=this.durationSelector(new ke(t,i))}catch(e){return void this.error(e)}this.add(s.subscribe(new Ue(t,i,this)))}}i.closed||i.next(n)},t.prototype._error=function(e){var t=this.groups;t&&(t.forEach(function(t){t.error(e)}),t.clear()),this.destination.error(e)},t.prototype._complete=function(){var e=this.groups;e&&(e.forEach(function(e){e.complete()}),e.clear()),this.destination.complete()},t.prototype.removeGroup=function(e){this.groups.delete(e)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&e.prototype.unsubscribe.call(this))},t}(Se)),Ue=function(e){function t(t,r,n){var i=e.call(this,r)||this;return i.key=t,i.group=r,i.parent=n,i}return n(t,e),t.prototype._next=function(){this.complete()},t.prototype._unsubscribe=function(){var e=this.parent,t=this.key;this.key=this.parent=null,e&&e.removeGroup(t)},t}(Se),ke=function(e){function t(t,r,n){var i=e.call(this)||this;return i.key=t,i.groupSubject=r,i.refCountSubscription=n,i}return n(t,e),t.prototype._subscribe=function(e){var t=new me,r=this.refCountSubscription,n=this.groupSubject;return r&&!r.closed&&t.add(new Be(r)),t.add(n.subscribe(e)),t},t}(Te),Be=function(e){function t(t){var r=e.call(this)||this;return r.parent=t,t.count++,r}return n(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}(me),je=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return n(t,e),Object.defineProperty(t.prototype,\"value\",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return r&&!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Ae;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Oe),Ye=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return n(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){return void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending?t:void clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error(\"executing a cancelled action\");this.pending=!1;var r=this._execute(e,t);return r||void(!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null)))},t.prototype._execute=function(e){var t=!1,r=void 0;try{this.work(e)}catch(e){t=!0,r=!!e&&e||new Error(e)}if(t)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,r=t.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(){return e.call(this)||this}return n(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(me)),De=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return n(t,e),t.prototype.schedule=function(t,r){return void 0===r&&(r=0),0<r?e.prototype.schedule.call(this,t,r):(this.delay=r,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,r){return 0<r||this.closed?e.prototype.execute.call(this,t,r):this._execute(t,r)},t.prototype.requestAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&0<n||null===n&&0<this.delay?e.prototype.requestAsyncId.call(this,t,r,n):t.flush(this)},t}(Ye),qe=function(){function e(t,r){void 0===r&&(r=e.now),this.SchedulerAction=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(r,t)},e.now=function(){return Date.now()},e}(),ze=function(e){function t(r,n){void 0===n&&(n=qe.now);var i=e.call(this,r,function(){return t.delegate&&t.delegate!==i?t.delegate.now():n()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return n(t,e),t.prototype.schedule=function(r,n,i){return void 0===n&&(n=0),t.delegate&&t.delegate!==this?t.delegate.schedule(r,n,i):e.prototype.schedule.call(this,r,n,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(qe),Xe=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(ze))(De),Ve=Xe,Ge=new Te(function(e){return e.complete()}),He=function(e){return function(t){for(var r=0,n=e.length;r<n&&!t.closed;r++)t.next(e[r]);t.complete()}};!function(e){e.NEXT=\"N\",e.ERROR=\"E\",e.COMPLETE=\"C\"}(fe||(fe={}));var Qe=function(){function e(e,t,r){this.kind=e,this.value=t,this.error=r,this.hasValue=\"N\"===e}return e.prototype.observe=function(e){switch(this.kind){case\"N\":return e.next&&e.next(this.value);case\"E\":return e.error&&e.error(this.error);case\"C\":return e.complete&&e.complete()}},e.prototype.do=function(e,t,r){var n=this.kind;return\"N\"===n?e&&e(this.value):\"E\"===n?t&&t(this.error):\"C\"===n?r&&r():void 0},e.prototype.accept=function(e,t,r){return e&&\"function\"==typeof e.next?this.observe(e):this.do(e,t,r)},e.prototype.toObservable=function(){switch(this.kind){case\"N\":return b(this.value);case\"E\":return y(this.error);case\"C\":return d()}throw new Error(\"unexpected notification kind value\")},e.createNext=function(t){return void 0===t?e.undefinedValueNotification:new e(\"N\",t)},e.createError=function(t){return new e(\"E\",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e(\"C\"),e.undefinedValueNotification=new e(\"N\",void 0),e}(),We=(function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}e.prototype.call=function(e,t){return t.subscribe(new We(e,this.scheduler,this.delay))}}(),function(e){function t(t,r,n){void 0===n&&(n=0);var i=e.call(this,t)||this;return i.scheduler=r,i.delay=n,i}return n(t,e),t.dispatch=function(e){var t=e.notification,r=e.destination;t.observe(r),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new Ke(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(Qe.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(Qe.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Qe.createComplete()),this.unsubscribe()},t}(Se)),Ke=function(e,t){this.notification=e,this.destination=t},Je=function(e){function t(t,r,n){void 0===t&&(t=he),void 0===r&&(r=he);var i=e.call(this)||this;return i.scheduler=n,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=1>t?1:t,i._windowTime=1>r?1:r,r===he?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return n(t,e),t.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var r=this._events;r.push(t),r.length>this._bufferSize&&r.shift()}e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new $e(this._getNow(),t)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,r=this._infiniteTimeWindow,n=r?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=n.length;if(this.closed)throw new Ae;if(this.isStopped||this.hasError?t=me.EMPTY:(this.observers.push(e),t=new we(this,e)),i&&e.add(e=new We(e,i)),r)for(var s=0;s<o&&!e.closed;s++)e.next(n[s]);else for(s=0;s<o&&!e.closed;s++)e.next(n[s].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||Ve).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,r=this._windowTime,n=this._events,i=n.length,o=0;o<i&&!(e-n[o].time<r);)o++;return i>t&&(o=Math.max(o,i-t)),0<o&&n.splice(0,o),n},t}(Oe),$e=function(e,t){this.time=e,this.value=t},Ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return n(t,e),t.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),me.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),me.EMPTY):e.prototype._subscribe.call(this,t)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},t}(Oe),et=1,tt=Promise.resolve(),rt={},nt=function(e){var t=et++;return rt[t]=!0,tt.then(function(){return v(t)&&e()}),t},it=function(e){v(e)},ot=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return n(t,e),t.prototype.requestAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&0<n?e.prototype.requestAsyncId.call(this,t,r,n):(t.actions.push(this),t.scheduled||(t.scheduled=nt(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&0<n||null===n&&0<this.delay?e.prototype.recycleAsyncId.call(this,t,r,n):void(0===t.actions.length&&(it(r),t.scheduled=void 0))},t}(Ye),st=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,n=-1,i=r.length;e=e||r.shift();do{if(t=e.execute(e.state,e.delay))break}while(++n<i&&(e=r.shift()));if(this.active=!1,t){for(;++n<i&&(e=r.shift());)e.unsubscribe();throw t}},t}(ze))(ot),ut=new ze(Ye),at=ut,ct=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return n(t,e),t.prototype.requestAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&0<n?e.prototype.requestAsyncId.call(this,t,r,n):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(function(){return t.flush(null)})))},t.prototype.recycleAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&0<n||null===n&&0<this.delay?e.prototype.recycleAsyncId.call(this,t,r,n):void(0===t.actions.length&&(cancelAnimationFrame(r),t.scheduled=void 0))},t}(Ye),lt=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,n=-1,i=r.length;e=e||r.shift();do{if(t=e.execute(e.state,e.delay))break}while(++n<i&&(e=r.shift()));if(this.active=!1,t){for(;++n<i&&(e=r.shift());)e.unsubscribe();throw t}},t}(ze))(ct),ht=function(e){function t(t,r){void 0===t&&(t=ft),void 0===r&&(r=he);var n=e.call(this,t,function(){return n.frame})||this;return n.maxFrames=r,n.frame=0,n.index=-1,n}return n(t,e),t.prototype.flush=function(){for(var e,t,r=this.actions,n=this.maxFrames;(t=r[0])&&t.delay<=n&&(r.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=r.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(ze),ft=function(e){function t(t,r,n){void 0===n&&(n=t.index+=1);var i=e.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.index=n,i.active=!0,i.index=t.index=n,i}return n(t,e),t.prototype.schedule=function(r,n){if(void 0===n&&(n=0),!this.id)return e.prototype.schedule.call(this,r,n);this.active=!1;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(r,n)},t.prototype.requestAsyncId=function(e,r,n){void 0===n&&(n=0),this.delay=e.frame+n;var i=e.actions;return i.push(this),i.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,r){void 0===r&&(r=0)},t.prototype._execute=function(t,r){if(!0===this.active)return e.prototype._execute.call(this,t,r)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(Ye),dt=function(){function e(){return Error.call(this),this.message=\"argument out of range\",this.name=\"ArgumentOutOfRangeError\",this}return e.prototype=Object.create(Error.prototype),e}(),pt=function(){function e(){return Error.call(this),this.message=\"no elements in sequence\",this.name=\"EmptyError\",this}return e.prototype=Object.create(Error.prototype),e}(),Et=function(){function e(){return Error.call(this),this.message=\"Timeout has occurred\",this.name=\"TimeoutError\",this}return e.prototype=Object.create(Error.prototype),e}(),_t=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new bt(e,this.project,this.thisArg))},e}(),bt=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.project=r,i.count=0,i.thisArg=n||i,i}return n(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Se),yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.notifyNext=function(e,t){this.destination.next(t)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(Se),mt=function(e){function t(t,r,n){var i=e.call(this)||this;return i.parent=t,i.outerValue=r,i.outerIndex=n,i.index=0,i}return n(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Se),vt=\"function\"==typeof Symbol&&Symbol.iterator?Symbol.iterator:\"@@iterator\",St=function(e){return e&&\"number\"==typeof e.length&&\"function\"!=typeof e},gt=function(e){if(e&&\"function\"==typeof e[Re])return function(e){return function(t){var r=e[Re]();if(\"function\"!=typeof r.subscribe)throw new TypeError(\"Provided object does not correctly implement Symbol.observable\");return r.subscribe(t)}}(e);if(St(e))return He(e);if(I(e))return function(e){return function(t){return e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,o),t}}(e);if(e&&\"function\"==typeof e[vt])return function(e){return function(t){for(var r=e[vt]();;){var n=void 0;try{n=r.next()}catch(e){return t.error(e),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return\"function\"==typeof r.return&&t.add(function(){r.return&&r.return()}),t}}(e);var t=s(e)?\"an invalid object\":\"'\"+e+\"'\";throw new TypeError(\"You provided \"+t+\" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.\")},Rt={},Tt=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new At(e,this.resultSelector))},e}(),At=function(e){function t(t,r){var n=e.call(this,t)||this;return n.resultSelector=r,n.active=0,n.values=[],n.observables=[],n}return n(t,e),t.prototype._next=function(e){this.values.push(Rt),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var r,n=0;n<t;n++)r=e[n],this.add(F(this,r,void 0,n))}},t.prototype.notifyComplete=function(){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,r){var n=this.values,i=n[r],o=this.toRespond?i===Rt?--this.toRespond:this.toRespond:0;n[r]=t,0===o&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(yt),wt=function(e){function t(t){var r=e.call(this)||this;return r.parent=t,r}return n(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(Se),Mt=(function(e){function t(t,r,n){var i=e.call(this)||this;return i.parent=t,i.outerValue=r,i.outerIndex=n,i}n(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}}(Se),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(Se)),Ot=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}n(t,e),t.prototype.notifyNext=function(e,t){this.destination.next(t)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()}}(Se),function(){function e(e,t){void 0===t&&(t=he),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new Nt(e,this.project,this.concurrent))},e}()),Nt=function(e){function t(t,r,n){void 0===n&&(n=he);var i=e.call(this,t)||this;return i.project=r,i.concurrent=n,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return n(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new wt(this),r=this.destination;r.add(t);var n=U(e,t);n!==t&&r.add(n)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,0<e.length?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(Mt),Pt=(Object.prototype.toString,new Te(S)),It=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Ft(e,this.predicate,this.thisArg))},e}(),Ft=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.predicate=r,i.thisArg=n,i.count=0,i}return n(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(Se),Ct=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new xt(e))},e}(),xt=function(e){function t(t){var r=e.call(this,t)||this;return r.hasFirst=!1,r.observables=[],r.subscriptions=[],r}return n(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var r=0;r<t&&!this.hasFirst;r++){var n=F(this,e[r],void 0,r);this.subscriptions&&this.subscriptions.push(n),this.add(n)}this.observables=null}},t.prototype.notifyNext=function(e,t,r){if(!this.hasFirst){this.hasFirst=!0;for(var n=0;n<this.subscriptions.length;n++)if(n!==r){var i=this.subscriptions[n];i.unsubscribe(),this.remove(i)}this.subscriptions=null}this.destination.next(t)},t}(yt),Lt=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Ut(e,this.resultSelector))},e}(),Ut=function(e){function t(t,r,n){void 0===n&&(n=Object.create(null));var i=e.call(this,t)||this;return i.resultSelector=r,i.iterators=[],i.active=0,i.resultSelector=\"function\"==typeof r?r:void 0,i}return n(t,e),t.prototype._next=function(e){var t=this.iterators;be(e)?t.push(new Bt(e)):\"function\"==typeof e[vt]?t.push(new kt(e[vt]())):t.push(new jt(this.destination,this,e))},t.prototype._complete=function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(var r,n=0;n<t;n++)if((r=e[n]).stillUnsubscribed){this.destination.add(r.subscribe())}else this.active--}else this.destination.complete()},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var e=this.iterators,t=e.length,r=this.destination,n=0;n<t;n++)if(\"function\"==typeof(s=e[n]).hasValue&&!s.hasValue())return;var i=!1,o=[];for(n=0;n<t;n++){var s,u=(s=e[n]).next();if(s.hasCompleted()&&(i=!0),u.done)return void r.complete();o.push(u.value)}this.resultSelector?this._tryresultSelector(o):r.next(o),i&&r.complete()},t.prototype._tryresultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Se),kt=function(){function e(e){this.iterator=e,this.nextResult=e.next()}return e.prototype.hasValue=function(){return!0},e.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},e.prototype.hasCompleted=function(){var e=this.nextResult;return!(!e||!e.done)},e}(),Bt=function(){function e(e){this.array=e,this.index=0,this.length=0,this.length=e.length}return e.prototype[vt]=function(){return this},e.prototype.next=function(){var e=this.index++,t=this.array;return e<this.length?{value:t[e],done:!1}:{value:null,done:!0}},e.prototype.hasValue=function(){return this.array.length>this.index},e.prototype.hasCompleted=function(){return this.array.length===this.index},e}(),jt=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.parent=r,i.observable=n,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return n(t,e),t.prototype[vt]=function(){return this},t.prototype.next=function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}},t.prototype.hasValue=function(){return 0<this.buffer.length},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(e){this.buffer.push(e),this.parent.checkIterators()},t.prototype.subscribe=function(){return U(this.observable,new wt(this))},t}(Mt);r.d(t,\"Observable\",function(){return Te}),r.d(t,\"ConnectableObservable\",function(){return Fe}),r.d(t,\"GroupedObservable\",function(){return ke}),r.d(t,\"observable\",function(){return Re}),r.d(t,\"Subject\",function(){return Oe}),r.d(t,\"BehaviorSubject\",function(){return je}),r.d(t,\"ReplaySubject\",function(){return Je}),r.d(t,\"AsyncSubject\",function(){return Ze}),r.d(t,\"asap\",function(){return st}),r.d(t,\"asapScheduler\",function(){return st}),r.d(t,\"async\",function(){return at}),r.d(t,\"asyncScheduler\",function(){return ut}),r.d(t,\"queue\",function(){return Ve}),r.d(t,\"queueScheduler\",function(){return Xe}),r.d(t,\"animationFrame\",function(){return lt}),r.d(t,\"animationFrameScheduler\",function(){return lt}),r.d(t,\"VirtualTimeScheduler\",function(){return ht}),r.d(t,\"VirtualAction\",function(){return ft}),r.d(t,\"Scheduler\",function(){return qe}),r.d(t,\"Subscription\",function(){return me}),r.d(t,\"Subscriber\",function(){return Se}),r.d(t,\"Notification\",function(){return Qe}),r.d(t,\"NotificationKind\",function(){return fe}),r.d(t,\"pipe\",function(){return l}),r.d(t,\"noop\",function(){return S}),r.d(t,\"identity\",function(){return c}),r.d(t,\"isObservable\",function(){return g}),r.d(t,\"ArgumentOutOfRangeError\",function(){return dt}),r.d(t,\"EmptyError\",function(){return pt}),r.d(t,\"ObjectUnsubscribedError\",function(){return Ae}),r.d(t,\"UnsubscriptionError\",function(){return ye}),r.d(t,\"TimeoutError\",function(){return Et}),r.d(t,\"bindCallback\",function(){return T}),r.d(t,\"bindNodeCallback\",function(){return M}),r.d(t,\"combineLatest\",function(){return C}),r.d(t,\"concat\",function(){return B}),r.d(t,\"defer\",function(){return j}),r.d(t,\"empty\",function(){return d}),r.d(t,\"forkJoin\",function(){return Y}),r.d(t,\"from\",function(){return L}),r.d(t,\"fromEvent\",function(){return q}),r.d(t,\"fromEventPattern\",function(){return z}),r.d(t,\"generate\",function(){return X}),r.d(t,\"iif\",function(){return G}),r.d(t,\"interval\",function(){return Q}),r.d(t,\"merge\",function(){return K}),r.d(t,\"never\",function(){return J}),r.d(t,\"of\",function(){return b}),r.d(t,\"onErrorResumeNext\",function(){return $}),r.d(t,\"pairs\",function(){return Z}),r.d(t,\"partition\",function(){return ne}),r.d(t,\"race\",function(){return ie}),r.d(t,\"range\",function(){return oe}),r.d(t,\"throwError\",function(){return y}),r.d(t,\"timer\",function(){return ue}),r.d(t,\"using\",function(){return ce}),r.d(t,\"zip\",function(){return le}),r.d(t,\"scheduled\",function(){return x}),r.d(t,\"EMPTY\",function(){return Ge}),r.d(t,\"NEVER\",function(){return Pt}),r.d(t,\"config\",function(){return Ee})},function(e,t,r){\"use strict\";function n(e){if(e.data&&e.data.detail&&e.data.type){const t=e.data.detail;if(!e.data.workerId)if(e.data.workerId=1,\"ConnectWorkerEvent\"===e.data.type)t.whoAmI&&(G[t.whoAmI]=this);else{const r=G[t.to]||G[t.address];r?r.postMessage(e.data,e.ports):postMessage(e.data,\"*\",e.ports)}}}function i(){ne.MessagePort=te,ne.MessageChannel=re}r.r(t);var o={};r.r(o),r.d(o,\"assert\",function(){return u}),r.d(o,\"isDefined\",function(){return a}),r.d(o,\"assertDefined\",function(){return c}),r.d(o,\"isString\",function(){return l}),r.d(o,\"assertString\",function(){return h}),r.d(o,\"assertNonEmptyString\",function(){return f}),r.d(o,\"isArray\",function(){return d}),r.d(o,\"isNonEmptyArray\",function(){return p}),r.d(o,\"assertArray\",function(){return E}),r.d(o,\"asserNotEmptytArray\",function(){return _}),r.d(o,\"isObject\",function(){return b}),r.d(o,\"assertObject\",function(){return y}),r.d(o,\"assertNonEmptyObject\",function(){return m}),r.d(o,\"isOneOf\",function(){return v}),r.d(o,\"assertOneOf\",function(){return S}),r.d(o,\"isFunction\",function(){return g}),r.d(o,\"isFunctionConstructor\",function(){return R}),r.d(o,\"assertFunction\",function(){return T}),r.d(o,\"assertClass\",function(){return A}),r.d(o,\"isNumber\",function(){return w}),r.d(o,\"assertNumber\",function(){return M});var s={};r.r(s),r.d(s,\"NOT_VALID_PROTOCOL\",function(){return O}),r.d(s,\"NOT_VALID_ADDRESS\",function(){return N}),r.d(s,\"NOT_VALID_HOST\",function(){return P}),r.d(s,\"NOT_VALID_PATH\",function(){return I}),r.d(s,\"NOT_VALID_PORT\",function(){return F}),r.d(s,\"ASYNC_MODEL_TYPES\",function(){return C}),r.d(s,\"SERVICE_NAME_NOT_PROVIDED\",function(){return x}),r.d(s,\"DEFINITION_MISSING_METHODS\",function(){return L}),r.d(s,\"INVALID_METHODS\",function(){return U}),r.d(s,\"getServiceNameInvalid\",function(){return k}),r.d(s,\"getIncorrectMethodValueError\",function(){return B}),r.d(s,\"getAsynModelNotProvidedError\",function(){return j}),r.d(s,\"getInvalidAsyncModelError\",function(){return Y});const u=(e,t)=>{if(!e)throw new Error(t)},a=e=>void 0!==e,c=(e,t=\"Expect to be defined\")=>{u(a(e),t)},l=e=>\"string\"==typeof e||e instanceof String,h=(e,t=\"Expected to be a string\")=>{u(a(e)&&l(e),t)},f=(e,t=\"Expected to be non empty string\")=>{h(e,t),u(0<e.length,t)},d=e=>Array.isArray(e),p=e=>d(e)&&0<e.length,E=(e,t=\"Expected to be an array\")=>{u(d(e),t)},_=(e,t=\"Expected to be an array\")=>{u(p(e),t)},b=e=>\"[object Object]\"===Object.prototype.toString.call(e),y=(e,t=\"Expected to be an object\")=>{u(b(e),t)},m=(e,t=\"Expected to be non empty object\")=>{y(e,t),u(0<Object.keys(e).length,t)},v=(e,t)=>d(e)?e.includes(t):!!b(e)&&Object.values(e).includes(t),S=(e,t,r=\"Expected to be one of the collection elements\")=>{u(v(e,t),r)},g=e=>\"function\"==typeof e&&!/^class\\s/.test(Function.prototype.toString.call(e)),R=e=>\"function\"==typeof e&&/^class\\s/.test(Function.prototype.toString.call(e)),T=(e,t=\"Expected to be a function\")=>{u(g(e),t)},A=(e,t=\"Expected to be a class\")=>{u(R(e),t)},w=e=>\"number\"==typeof e&&!isNaN(e),M=(e,t=\"Expected to be a number\")=>{u(w(e),t)},O=\"Not a valid protocol\",N=\"Address must be of type object\",P=\"Not a valid host\",I=\"Not a valid path\",F=\"Not a valid port\",C={REQUEST_RESPONSE:\"requestResponse\",REQUEST_STREAM:\"requestStream\"},x=\"MS0020 - Invalid format, definition must contain valid serviceName\",L=\"MS0021 - Invalid format, definition must contain valid methods\",U=\"MS0022 - Invalid format, definition must contain valid methods\",k=e=>`MS0023 - Invalid format, serviceName must be not empty string but received type ${typeof e}`,B=e=>`Method value for ${e} definition should be non empty object`,j=e=>`Async model is not provided in service definition for ${e}`,Y=e=>`Invalid async model in service definition for ${e}`,D=(e,t=!0)=>{if(t&&void 0===e)return!0;m(e,N);const{host:r,path:n,protocol:i}=e;let{port:o}=e;return o=l(o)?+o:o,h(r,P),h(n,I),M(o,F),h(i,O),u(v([\"pm\",\"ws\",\"wss\",\"tcp\"],i),O),!0},q=e=>{D(e,!1);const{host:t,path:r,port:n,protocol:i}=e;return`${i}://${t}:${n}/${r}`},z=e=>{const t={};return e=X({key:\"protocol\",optionalValue:\"pm\",delimiter:\"://\",str:e,newAddress:t}),e=X({key:\"host\",optionalValue:\"defaultHost\",delimiter:\":\",str:e,newAddress:t}),e=X({key:\"port\",optionalValue:8080,delimiter:\"/\",str:e,newAddress:t}),t.path=e,t},X=({key:e,optionalValue:t,delimiter:r,newAddress:n,str:i})=>{let[o,s]=i.split(r);return s||(s=o,o=t),n[e]=o,s},V=()=>{try{return!navigator}catch(e){return!1}},G={},H={},Q=[],W={},K=(e,t,r,n,i=\"log\")=>{if(W[e]||(W[e]=(()=>{let e=\"#\";for(let t=0;6>t;t++)e+=\"0123456789ABCDEF\"[Math.floor(16*Math.random())];return e})()),n){const n=`color:${W[e]}`;r&&console[i](`%c******** address: ${e}********`,n),console[i](t),r&&Object.keys(r).forEach(e=>{Array.isArray(r[e])?Object.values(r[e]).forEach(t=>{console[i](`${e}: ${JSON.stringify(t.qualifier||t,null,2)}`)}):console[i](`${e}: ${JSON.stringify(r[e],null,2)}`)})}},J=({serviceName:e,methodName:t})=>`${e}/${t}`,$=e=>{m(e);const{serviceName:t,methods:r}=e;c(t,x),f(t,k(t)),c(r,L),m(r,U),Object.keys(r).forEach(e=>{f(e);const n=J({serviceName:t,methodName:e});Z(n,r[e])})},Z=(e,t)=>{m(t,B(e));const{asyncModel:r}=t;c(r,j(e)),S(C,r,Y(e))};var ee=r(18);class te{constructor(e){this.onmessage=null,this.onmessageerror=null,this.otherPort=null,this.onmessageListeners=[],this.queue=[],this.otherSideStart=!1,this.whoami=e}dispatchEvent(e){return this.onmessage&&this.onmessage(e),this.onmessageListeners.forEach(t=>t(e)),!0}postMessage(e,t){const r={ports:t,data:e};this.otherPort&&(this.otherSideStart?this.otherPort.dispatchEvent(r):this.queue.push(r))}addEventListener(e,t){\"message\"!==e||\"function\"!=typeof t||-1!==this.onmessageListeners.indexOf(t)||this.onmessageListeners.push(t)}removeEventListener(e,t){if(\"message\"===e){const e=this.onmessageListeners.indexOf(t);-1===e||this.onmessageListeners.splice(e,1)}}start(){setTimeout(()=>this.otherPort&&this.otherPort.startSending.apply(this.otherPort,[]),0)}close(){setTimeout(()=>this.otherPort&&this.otherPort.stopSending.apply(this.otherPort,[]),0)}startSending(){this.otherSideStart=!0,this.queue.forEach(e=>this.otherPort&&this.otherPort.dispatchEvent(e))}stopSending(){this.otherSideStart=!1,this.queue.length=0}}class re{constructor(){this.port1=new te(\"client\"),this.port2=new te(\"server\"),this.port1.otherPort=this.port2,this.port2.otherPort=this.port1}}const ne=\"undefined\"!=typeof window&&window.Math===Math?window:\"undefined\"!=typeof self&&self.Math===Math?self:Function(\"return this\")();ne.MessagePort&&ne.MessageChannel||i(),r.d(t,\"workers\",function(){return ie}),r.d(t,\"mockMessageChannel\",function(){return oe}),r.d(t,\"check\",function(){return o}),r.d(t,\"getFullAddress\",function(){return q}),r.d(t,\"validateAddress\",function(){return D}),r.d(t,\"constants\",function(){return s}),r.d(t,\"getAddress\",function(){return z}),r.d(t,\"saveToLogs\",function(){return K}),r.d(t,\"isNodejs\",function(){return V}),r.d(t,\"validateServiceDefinition\",function(){return $}),r.d(t,\"getQualifier\",function(){return J});const ie=V()?{}:{addWorker:e=>{e.addEventListener(\"message\",n.bind(e))},removeWorker:e=>{e.removeEventListener(\"message\",n.bind(e))},initialize:()=>{V()||(\"undefined\"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?console.warn(\"Don't use this on webworkers, only on the main thread\"):addEventListener(\"message\",e=>{if(e&&e.data&&!e.data.workerId){\"ConnectIframe\"===e.data.type&&(e=>{Q.some(t=>(e.source===t.contentWindow&&(H[e.data.detail.whoAmI||e.data.detail.origin]=t),e.source===t.contentWindow))})(e);const t=e.data.detail;if(t){e.data.workerId=1;const r=G[t.to]||G[t.address];r&&r.postMessage(e.data,e.ports);const n=H[t.to]||H[t.address];n&&n.contentWindow.postMessage(e.data,\"*\",e.ports)}}}))},addIframe:e=>{Q.push(e)}},oe=()=>{Object(ee.a)(),i()}}]);","extractedComments":[]}