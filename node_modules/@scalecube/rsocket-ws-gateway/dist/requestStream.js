"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.requestStream = void 0;
var rsocket_flowable_1 = require("rsocket-flowable");
var flowableHandler = function (serviceCall, data, subscriber) {
    var sub;
    subscriber.onSubscribe({
        cancel: function () {
            sub && sub.unsubscribe();
        },
        request: function () {
            sub = serviceCall.requestStream(data).subscribe(function (response) {
                subscriber.onNext({ data: response });
            }, function (error) { return subscriber.onError(error); }, function () { return subscriber.onComplete(); });
        },
    });
};
exports.requestStream = function (_a, serviceCall, handler) {
    var data = _a.data;
    if (handler === void 0) { handler = flowableHandler; }
    return new rsocket_flowable_1.Flowable(handler.bind(null, serviceCall, data));
};
